ARM GAS  /tmp/ccHmVI9k.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 2
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"btphy.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.rodata.str1.4,"aMS",%progbits,1
  16              		.align	2
  17              	.LC0:
  18 0000 4449457C 		.ascii	"DIE|too many timers\012\000"
  18      746F6F20 
  18      6D616E79 
  18      2074696D 
  18      6572730A 
  19 0015 000000   		.align	2
  20              	.LC1:
  21 0018 4449457C 		.ascii	"DIE|timers overflow\012\000"
  21      74696D65 
  21      7273206F 
  21      76657266 
  21      6C6F770A 
  22              		.section	.text.btphy_timer_add,"ax",%progbits
  23              		.align	1
  24              		.p2align 2,,3
  25              		.global	btphy_timer_add
  26              		.arch armv7-m
  27              		.syntax unified
  28              		.thumb
  29              		.thumb_func
  30              		.fpu softvfp
  32              	btphy_timer_add:
  33              	.LVL0:
  34              	.LFB29:
  35              		.file 1 "src/btphy/btphy.c"
   1:src/btphy/btphy.c **** /* Bluetooth physical layer
   2:src/btphy/btphy.c ****  *
   3:src/btphy/btphy.c ****  * Copyright 2020 Etienne Helluy-Lafont, Univ. Lille, CNRS.
   4:src/btphy/btphy.c ****  *
   5:src/btphy/btphy.c ****  * This file is part of Project Ubertooth.
   6:src/btphy/btphy.c ****  *
   7:src/btphy/btphy.c ****  * This program is free software; you can redistribute it and/or modify
   8:src/btphy/btphy.c ****  * it under the terms of the GNU General Public License as published by
   9:src/btphy/btphy.c ****  * the Free Software Foundation; either version 2, or (at your option)
  10:src/btphy/btphy.c ****  * any later version.
  11:src/btphy/btphy.c ****  *
  12:src/btphy/btphy.c ****  * This program is distributed in the hope that it will be useful,
  13:src/btphy/btphy.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  14:src/btphy/btphy.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  15:src/btphy/btphy.c ****  * GNU General Public License for more details.
ARM GAS  /tmp/ccHmVI9k.s 			page 2


  16:src/btphy/btphy.c ****  *
  17:src/btphy/btphy.c ****  * You should have received a copy of the GNU General Public License
  18:src/btphy/btphy.c ****  * along with this program; see the file COPYING.  If not, write to
  19:src/btphy/btphy.c ****  * the Free Software Foundation, Inc., 51 Franklin Street,
  20:src/btphy/btphy.c ****  * Boston, MA 02110-1301, USA.
  21:src/btphy/btphy.c ****  */
  22:src/btphy/btphy.c **** #include <string.h>
  23:src/btphy/btphy.c **** #include <ubtbr/cfg.h>
  24:src/btphy/btphy.c **** #include <ubtbr/bb.h>
  25:src/btphy/btphy.c **** #include <ubtbr/btbb.h>
  26:src/btphy/btphy.c **** #include <ubtbr/debug.h>
  27:src/btphy/btphy.c **** #include <ubtbr/mem_pool.h>
  28:src/btphy/btphy.c **** #include <ubtbr/hop.h>
  29:src/btphy/btphy.c **** #include <ubtbr/rf.h>
  30:src/btphy/btphy.c **** #include <ubtbr/tdma_sched.h>
  31:src/btphy/btphy.c **** #include <ubtbr/tx_task.h>
  32:src/btphy/btphy.c **** #include <ubtbr/rx_task.h>
  33:src/btphy/btphy.c **** #include <ubtbr/btphy.h>
  34:src/btphy/btphy.c **** #include <ubtbr/system.h>
  35:src/btphy/btphy.c **** 
  36:src/btphy/btphy.c **** #define DEFAULT_BDADDR 0x112233445566
  37:src/btphy/btphy.c **** 
  38:src/btphy/btphy.c **** typedef void (*btphy_timer_fn_t)(void *arg);
  39:src/btphy/btphy.c **** 
  40:src/btphy/btphy.c **** #define BTPHY_TIMER_COUNT 10
  41:src/btphy/btphy.c **** typedef struct {
  42:src/btphy/btphy.c **** 	uint32_t instant;
  43:src/btphy/btphy.c **** 	btphy_timer_fn_t cb;
  44:src/btphy/btphy.c **** 	void *cb_arg;
  45:src/btphy/btphy.c **** 	uint8_t anyway;	// do it anyway if instant as already passed
  46:src/btphy/btphy.c **** } btphy_timer_t;
  47:src/btphy/btphy.c **** 
  48:src/btphy/btphy.c **** struct {
  49:src/btphy/btphy.c **** 	unsigned count;
  50:src/btphy/btphy.c **** 	btphy_timer_t timers[BTPHY_TIMER_COUNT];
  51:src/btphy/btphy.c **** } btphy_timers;
  52:src/btphy/btphy.c **** 
  53:src/btphy/btphy.c **** btphy_t btphy = {0};
  54:src/btphy/btphy.c **** 
  55:src/btphy/btphy.c **** static void btphy_timers_reset(void)
  56:src/btphy/btphy.c **** {
  57:src/btphy/btphy.c **** 	unsigned i;
  58:src/btphy/btphy.c **** 
  59:src/btphy/btphy.c **** 	btphy_timers.count = 0;
  60:src/btphy/btphy.c **** 	for(i=0;i<BTPHY_TIMER_COUNT;i++)
  61:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
  62:src/btphy/btphy.c **** }
  63:src/btphy/btphy.c **** 
  64:src/btphy/btphy.c **** static void btphy_timers_execute(void)
  65:src/btphy/btphy.c **** {
  66:src/btphy/btphy.c **** 	unsigned i;	// FIXME: unnecessary
  67:src/btphy/btphy.c **** 	unsigned j;
  68:src/btphy/btphy.c **** 	uint32_t clkn = btphy_cur_clkn();
  69:src/btphy/btphy.c **** 	btphy_timer_t *t;
  70:src/btphy/btphy.c **** 
  71:src/btphy/btphy.c **** 	for (i=0,j=0,t=btphy_timers.timers
  72:src/btphy/btphy.c **** 		; j<btphy_timers.count && i<BTPHY_TIMER_COUNT
ARM GAS  /tmp/ccHmVI9k.s 			page 3


  73:src/btphy/btphy.c **** 		; i++,t++)
  74:src/btphy/btphy.c **** 	{
  75:src/btphy/btphy.c **** 		if (t->cb)
  76:src/btphy/btphy.c **** 		{
  77:src/btphy/btphy.c **** 			if (t->instant == clkn)
  78:src/btphy/btphy.c **** 			{
  79:src/btphy/btphy.c **** 				t->cb(t->cb_arg);
  80:src/btphy/btphy.c **** 				t->cb = NULL;
  81:src/btphy/btphy.c **** 				btphy_timers.count--;
  82:src/btphy/btphy.c **** 			}
  83:src/btphy/btphy.c **** 			else if (t->instant < clkn)
  84:src/btphy/btphy.c **** 			{
  85:src/btphy/btphy.c **** 				if (t->anyway)
  86:src/btphy/btphy.c **** 				{
  87:src/btphy/btphy.c **** 					cprintf("(X)");
  88:src/btphy/btphy.c **** 					t->cb(t->cb_arg);
  89:src/btphy/btphy.c **** 				}
  90:src/btphy/btphy.c **** 				else{
  91:src/btphy/btphy.c **** 					cprintf("(missed timer)");
  92:src/btphy/btphy.c **** 				}
  93:src/btphy/btphy.c **** 				t->cb = NULL;
  94:src/btphy/btphy.c **** 				btphy_timers.count--;
  95:src/btphy/btphy.c **** 			}
  96:src/btphy/btphy.c **** 			j++;
  97:src/btphy/btphy.c **** 		}
  98:src/btphy/btphy.c **** 	}
  99:src/btphy/btphy.c **** }
 100:src/btphy/btphy.c **** 
 101:src/btphy/btphy.c **** void btphy_timer_add(uint32_t instant, btphy_timer_fn_t cb, void *cb_arg, uint8_t anyway)
 102:src/btphy/btphy.c **** {
  36              		.loc 1 102 1 view -0
  37              		.cfi_startproc
  38              		@ args = 0, pretend = 0, frame = 0
  39              		@ frame_needed = 0, uses_anonymous_args = 0
  40              		.loc 1 102 1 is_stmt 0 view .LVU1
  41 0000 70B5     		push	{r4, r5, r6, lr}
  42              		.cfi_def_cfa_offset 16
  43              		.cfi_offset 4, -16
  44              		.cfi_offset 5, -12
  45              		.cfi_offset 6, -8
  46              		.cfi_offset 14, -4
 103:src/btphy/btphy.c **** 	unsigned i;
  47              		.loc 1 103 2 is_stmt 1 view .LVU2
 104:src/btphy/btphy.c **** 	btphy_timer_t *t;
  48              		.loc 1 104 2 view .LVU3
 105:src/btphy/btphy.c **** 
 106:src/btphy/btphy.c **** 	if (btphy_timers.count == BTPHY_TIMER_COUNT)
  49              		.loc 1 106 2 view .LVU4
  50              		.loc 1 106 18 is_stmt 0 view .LVU5
  51 0002 204C     		ldr	r4, .L18
  52 0004 2568     		ldr	r5, [r4]
  53              		.loc 1 106 5 view .LVU6
  54 0006 0A2D     		cmp	r5, #10
  55 0008 39D0     		beq	.L16
  56              	.LVL1:
 107:src/btphy/btphy.c **** 	{
 108:src/btphy/btphy.c **** 		DIE("too many timers");
ARM GAS  /tmp/ccHmVI9k.s 			page 4


 109:src/btphy/btphy.c **** 	}
 110:src/btphy/btphy.c **** 	for(i=0, t=btphy_timers.timers; i<BTPHY_TIMER_COUNT; i++,t++)
 111:src/btphy/btphy.c **** 	{
 112:src/btphy/btphy.c **** 		if (t->cb == NULL)
  57              		.loc 1 112 3 is_stmt 1 view .LVU7
  58              		.loc 1 112 6 is_stmt 0 view .LVU8
  59 000a A668     		ldr	r6, [r4, #8]
  60 000c B6B1     		cbz	r6, .L5
 110:src/btphy/btphy.c **** 	{
  61              		.loc 1 110 55 is_stmt 1 view .LVU9
  62              	.LVL2:
 110:src/btphy/btphy.c **** 	{
  63              		.loc 1 110 34 view .LVU10
  64              		.loc 1 112 3 view .LVU11
  65              		.loc 1 112 6 is_stmt 0 view .LVU12
  66 000e A669     		ldr	r6, [r4, #24]
  67 0010 E6B1     		cbz	r6, .L6
 110:src/btphy/btphy.c **** 	{
  68              		.loc 1 110 55 is_stmt 1 view .LVU13
  69              	.LVL3:
 110:src/btphy/btphy.c **** 	{
  70              		.loc 1 110 34 view .LVU14
  71              		.loc 1 112 3 view .LVU15
  72              		.loc 1 112 6 is_stmt 0 view .LVU16
  73 0012 A66A     		ldr	r6, [r4, #40]
  74 0014 EEB1     		cbz	r6, .L7
 110:src/btphy/btphy.c **** 	{
  75              		.loc 1 110 55 is_stmt 1 view .LVU17
  76              	.LVL4:
 110:src/btphy/btphy.c **** 	{
  77              		.loc 1 110 34 view .LVU18
  78              		.loc 1 112 3 view .LVU19
  79              		.loc 1 112 6 is_stmt 0 view .LVU20
  80 0016 A66B     		ldr	r6, [r4, #56]
  81 0018 F6B1     		cbz	r6, .L8
 110:src/btphy/btphy.c **** 	{
  82              		.loc 1 110 55 is_stmt 1 view .LVU21
  83              	.LVL5:
 110:src/btphy/btphy.c **** 	{
  84              		.loc 1 110 34 view .LVU22
  85              		.loc 1 112 3 view .LVU23
  86              		.loc 1 112 6 is_stmt 0 view .LVU24
  87 001a A66C     		ldr	r6, [r4, #72]
  88 001c FEB1     		cbz	r6, .L9
 110:src/btphy/btphy.c **** 	{
  89              		.loc 1 110 55 is_stmt 1 view .LVU25
  90              	.LVL6:
 110:src/btphy/btphy.c **** 	{
  91              		.loc 1 110 34 view .LVU26
  92              		.loc 1 112 3 view .LVU27
  93              		.loc 1 112 6 is_stmt 0 view .LVU28
  94 001e A66D     		ldr	r6, [r4, #88]
  95 0020 06B3     		cbz	r6, .L10
 110:src/btphy/btphy.c **** 	{
  96              		.loc 1 110 55 is_stmt 1 view .LVU29
  97              	.LVL7:
 110:src/btphy/btphy.c **** 	{
ARM GAS  /tmp/ccHmVI9k.s 			page 5


  98              		.loc 1 110 34 view .LVU30
  99              		.loc 1 112 3 view .LVU31
 100              		.loc 1 112 6 is_stmt 0 view .LVU32
 101 0022 A66E     		ldr	r6, [r4, #104]
 102 0024 0EB3     		cbz	r6, .L11
 110:src/btphy/btphy.c **** 	{
 103              		.loc 1 110 55 is_stmt 1 view .LVU33
 104              	.LVL8:
 110:src/btphy/btphy.c **** 	{
 105              		.loc 1 110 34 view .LVU34
 106              		.loc 1 112 3 view .LVU35
 107              		.loc 1 112 6 is_stmt 0 view .LVU36
 108 0026 A66F     		ldr	r6, [r4, #120]
 109 0028 16B3     		cbz	r6, .L12
 110:src/btphy/btphy.c **** 	{
 110              		.loc 1 110 55 is_stmt 1 view .LVU37
 111              	.LVL9:
 110:src/btphy/btphy.c **** 	{
 112              		.loc 1 110 34 view .LVU38
 113              		.loc 1 112 3 view .LVU39
 114              		.loc 1 112 6 is_stmt 0 view .LVU40
 115 002a D4F88860 		ldr	r6, [r4, #136]
 116 002e 16B3     		cbz	r6, .L13
 110:src/btphy/btphy.c **** 	{
 117              		.loc 1 110 55 is_stmt 1 view .LVU41
 118              	.LVL10:
 110:src/btphy/btphy.c **** 	{
 119              		.loc 1 110 34 view .LVU42
 120              		.loc 1 112 3 view .LVU43
 121              		.loc 1 112 6 is_stmt 0 view .LVU44
 122 0030 D4F89860 		ldr	r6, [r4, #152]
 123 0034 0EB3     		cbz	r6, .L17
 110:src/btphy/btphy.c **** 	{
 124              		.loc 1 110 55 is_stmt 1 discriminator 2 view .LVU45
 125              	.LVL11:
 110:src/btphy/btphy.c **** 	{
 126              		.loc 1 110 34 discriminator 2 view .LVU46
 113:src/btphy/btphy.c **** 		{
 114:src/btphy/btphy.c **** 			t->instant = instant;
 115:src/btphy/btphy.c **** 			t->cb = cb;
 116:src/btphy/btphy.c **** 			t->cb_arg = cb_arg;
 117:src/btphy/btphy.c **** 			t->anyway = anyway;
 118:src/btphy/btphy.c **** 			btphy_timers.count++;
 119:src/btphy/btphy.c **** 			return;
 120:src/btphy/btphy.c **** 		}
 121:src/btphy/btphy.c **** 	}
 122:src/btphy/btphy.c **** 	DIE("timers overflow");
 127              		.loc 1 122 2 discriminator 2 view .LVU47
 128 0036 1448     		ldr	r0, .L18+4
 129              	.LVL12:
 130              		.loc 1 122 2 is_stmt 0 discriminator 2 view .LVU48
 131 0038 FFF7FEFF 		bl	die
 132              	.LVL13:
 133              	.L5:
 110:src/btphy/btphy.c **** 	{
 134              		.loc 1 110 12 view .LVU49
 135 003c 261D     		adds	r6, r4, #4
ARM GAS  /tmp/ccHmVI9k.s 			page 6


 136              	.LVL14:
 137              	.L3:
 114:src/btphy/btphy.c **** 			t->cb = cb;
 138              		.loc 1 114 4 is_stmt 1 view .LVU50
 118:src/btphy/btphy.c **** 			return;
 139              		.loc 1 118 22 is_stmt 0 view .LVU51
 140 003e 0135     		adds	r5, r5, #1
 117:src/btphy/btphy.c **** 			btphy_timers.count++;
 141              		.loc 1 117 14 view .LVU52
 142 0040 3373     		strb	r3, [r6, #12]
 115:src/btphy/btphy.c **** 			t->cb_arg = cb_arg;
 143              		.loc 1 115 10 view .LVU53
 144 0042 C6E90001 		strd	r0, r1, [r6]
 116:src/btphy/btphy.c **** 			t->anyway = anyway;
 145              		.loc 1 116 4 is_stmt 1 view .LVU54
 116:src/btphy/btphy.c **** 			t->anyway = anyway;
 146              		.loc 1 116 14 is_stmt 0 view .LVU55
 147 0046 B260     		str	r2, [r6, #8]
 117:src/btphy/btphy.c **** 			btphy_timers.count++;
 148              		.loc 1 117 4 is_stmt 1 view .LVU56
 118:src/btphy/btphy.c **** 			return;
 149              		.loc 1 118 4 view .LVU57
 119:src/btphy/btphy.c **** 		}
 150              		.loc 1 119 4 view .LVU58
 118:src/btphy/btphy.c **** 			return;
 151              		.loc 1 118 22 is_stmt 0 view .LVU59
 152 0048 2560     		str	r5, [r4]
 123:src/btphy/btphy.c **** }
 153              		.loc 1 123 1 view .LVU60
 154 004a 70BD     		pop	{r4, r5, r6, pc}
 155              	.LVL15:
 156              	.L6:
 110:src/btphy/btphy.c **** 	{
 157              		.loc 1 110 60 view .LVU61
 158 004c 04F11406 		add	r6, r4, #20
 159 0050 F5E7     		b	.L3
 160              	.LVL16:
 161              	.L7:
 110:src/btphy/btphy.c **** 	{
 162              		.loc 1 110 60 view .LVU62
 163 0052 04F12406 		add	r6, r4, #36
 164 0056 F2E7     		b	.L3
 165              	.LVL17:
 166              	.L8:
 110:src/btphy/btphy.c **** 	{
 167              		.loc 1 110 60 view .LVU63
 168 0058 04F13406 		add	r6, r4, #52
 169 005c EFE7     		b	.L3
 170              	.LVL18:
 171              	.L9:
 110:src/btphy/btphy.c **** 	{
 172              		.loc 1 110 60 view .LVU64
 173 005e 04F14406 		add	r6, r4, #68
 174 0062 ECE7     		b	.L3
 175              	.LVL19:
 176              	.L10:
 110:src/btphy/btphy.c **** 	{
ARM GAS  /tmp/ccHmVI9k.s 			page 7


 177              		.loc 1 110 60 view .LVU65
 178 0064 04F15406 		add	r6, r4, #84
 179 0068 E9E7     		b	.L3
 180              	.LVL20:
 181              	.L11:
 110:src/btphy/btphy.c **** 	{
 182              		.loc 1 110 60 view .LVU66
 183 006a 04F16406 		add	r6, r4, #100
 184 006e E6E7     		b	.L3
 185              	.LVL21:
 186              	.L12:
 110:src/btphy/btphy.c **** 	{
 187              		.loc 1 110 60 view .LVU67
 188 0070 04F17406 		add	r6, r4, #116
 189 0074 E3E7     		b	.L3
 190              	.LVL22:
 191              	.L13:
 110:src/btphy/btphy.c **** 	{
 192              		.loc 1 110 60 view .LVU68
 193 0076 054E     		ldr	r6, .L18+8
 194              	.LVL23:
 110:src/btphy/btphy.c **** 	{
 195              		.loc 1 110 60 view .LVU69
 196 0078 E1E7     		b	.L3
 197              	.LVL24:
 198              	.L17:
 110:src/btphy/btphy.c **** 	{
 199              		.loc 1 110 60 view .LVU70
 200 007a 054E     		ldr	r6, .L18+12
 201              	.LVL25:
 110:src/btphy/btphy.c **** 	{
 202              		.loc 1 110 60 view .LVU71
 203 007c DFE7     		b	.L3
 204              	.LVL26:
 205              	.L16:
 108:src/btphy/btphy.c **** 	}
 206              		.loc 1 108 3 is_stmt 1 view .LVU72
 207 007e 0548     		ldr	r0, .L18+16
 208              	.LVL27:
 108:src/btphy/btphy.c **** 	}
 209              		.loc 1 108 3 is_stmt 0 view .LVU73
 210 0080 FFF7FEFF 		bl	die
 211              	.LVL28:
 212              	.L19:
 108:src/btphy/btphy.c **** 	}
 213              		.loc 1 108 3 view .LVU74
 214              		.align	2
 215              	.L18:
 216 0084 00000000 		.word	btphy_timers
 217 0088 18000000 		.word	.LC1
 218 008c 84000000 		.word	btphy_timers+132
 219 0090 94000000 		.word	btphy_timers+148
 220 0094 00000000 		.word	.LC0
 221              		.cfi_endproc
 222              	.LFE29:
 224              		.section	.rodata.str1.4
 225 002d 000000   		.align	2
ARM GAS  /tmp/ccHmVI9k.s 			page 8


 226              	.LC2:
 227 0030 28582900 		.ascii	"(X)\000"
 228              		.align	2
 229              	.LC3:
 230 0034 286D6973 		.ascii	"(missed timer)\000"
 230      73656420 
 230      74696D65 
 230      722900
 231              		.section	.text.TIMER0_IRQHandler,"ax",%progbits
 232              		.align	1
 233              		.p2align 2,,3
 234              		.global	TIMER0_IRQHandler
 235              		.syntax unified
 236              		.thumb
 237              		.thumb_func
 238              		.fpu softvfp
 240              	TIMER0_IRQHandler:
 241              	.LFB31:
 124:src/btphy/btphy.c **** 
 125:src/btphy/btphy.c **** static void btphy_handler(void)
 126:src/btphy/btphy.c **** {
 127:src/btphy/btphy.c **** 	btphy.master_clkn++;
 128:src/btphy/btphy.c **** 	btphy.slave_clkn ++;
 129:src/btphy/btphy.c **** 
 130:src/btphy/btphy.c **** 	if (btphy.clkn_delayed)
 131:src/btphy/btphy.c **** 	{
 132:src/btphy/btphy.c **** 		/* reset T0MR value */
 133:src/btphy/btphy.c **** 		T0MR0 = (CLKN_OFFSET_RESET_VAL)-1;
 134:src/btphy/btphy.c **** 		btphy.clkn_delayed = 0;
 135:src/btphy/btphy.c **** 	}
 136:src/btphy/btphy.c **** 
 137:src/btphy/btphy.c **** 	/* execute timers */
 138:src/btphy/btphy.c **** 	btphy_timers_execute();
 139:src/btphy/btphy.c **** 
 140:src/btphy/btphy.c **** 	/* Execute scheduler */
 141:src/btphy/btphy.c **** 	tdma_sched_execute();
 142:src/btphy/btphy.c **** 
 143:src/btphy/btphy.c **** 	/* Advance scheduler */
 144:src/btphy/btphy.c **** 	tdma_sched_advance();
 145:src/btphy/btphy.c **** }
 146:src/btphy/btphy.c **** 
 147:src/btphy/btphy.c **** void TIMER0_IRQHandler()
 148:src/btphy/btphy.c **** {
 242              		.loc 1 148 1 is_stmt 1 view -0
 243              		.cfi_startproc
 244              		@ args = 0, pretend = 0, frame = 0
 245              		@ frame_needed = 0, uses_anonymous_args = 0
 246 0000 2DE9F84F 		push	{r3, r4, r5, r6, r7, r8, r9, r10, fp, lr}
 247              		.cfi_def_cfa_offset 40
 248              		.cfi_offset 3, -40
 249              		.cfi_offset 4, -36
 250              		.cfi_offset 5, -32
 251              		.cfi_offset 6, -28
 252              		.cfi_offset 7, -24
 253              		.cfi_offset 8, -20
 254              		.cfi_offset 9, -16
 255              		.cfi_offset 10, -12
ARM GAS  /tmp/ccHmVI9k.s 			page 9


 256              		.cfi_offset 11, -8
 257              		.cfi_offset 14, -4
 149:src/btphy/btphy.c **** 	/* Timer0: tdma frame */
 150:src/btphy/btphy.c **** 	if (T0IR & TIR_MR0_Interrupt)
 258              		.loc 1 150 2 view .LVU76
 259              		.loc 1 150 6 is_stmt 0 view .LVU77
 260 0004 4FF04022 		mov	r2, #1073758208
 261 0008 1368     		ldr	r3, [r2]
 262              		.loc 1 150 5 view .LVU78
 263 000a DB07     		lsls	r3, r3, #31
 264 000c 01D4     		bmi	.L45
 265              	.L20:
 151:src/btphy/btphy.c **** 	{
 152:src/btphy/btphy.c **** 		/* Clear interrupt */
 153:src/btphy/btphy.c **** 		T0IR = TIR_MR0_Interrupt;
 154:src/btphy/btphy.c **** 		btphy_handler();
 155:src/btphy/btphy.c **** 
 156:src/btphy/btphy.c **** 		/* Clear pending interrupt */
 157:src/btphy/btphy.c **** 		if (T0IR)
 158:src/btphy/btphy.c **** 		{
 159:src/btphy/btphy.c **** 			console_putc('O');
 160:src/btphy/btphy.c **** 			T0IR = TIR_MR0_Interrupt;
 161:src/btphy/btphy.c **** 		}
 162:src/btphy/btphy.c **** 	}
 163:src/btphy/btphy.c **** }
 266              		.loc 1 163 1 view .LVU79
 267 000e BDE8F88F 		pop	{r3, r4, r5, r6, r7, r8, r9, r10, fp, pc}
 268              	.L45:
 153:src/btphy/btphy.c **** 		btphy_handler();
 269              		.loc 1 153 3 is_stmt 1 view .LVU80
 153:src/btphy/btphy.c **** 		btphy_handler();
 270              		.loc 1 153 8 is_stmt 0 view .LVU81
 271 0012 0121     		movs	r1, #1
 272              	.LBB46:
 273              	.LBB47:
 127:src/btphy/btphy.c **** 	btphy.slave_clkn ++;
 274              		.loc 1 127 19 view .LVU82
 275 0014 314B     		ldr	r3, .L46
 276              	.LBE47:
 277              	.LBE46:
 153:src/btphy/btphy.c **** 		btphy_handler();
 278              		.loc 1 153 8 view .LVU83
 279 0016 1160     		str	r1, [r2]
 154:src/btphy/btphy.c **** 
 280              		.loc 1 154 3 is_stmt 1 view .LVU84
 281              	.LBB59:
 282              	.LBI46:
 125:src/btphy/btphy.c **** {
 283              		.loc 1 125 13 view .LVU85
 284              	.LBB56:
 127:src/btphy/btphy.c **** 	btphy.slave_clkn ++;
 285              		.loc 1 127 2 view .LVU86
 130:src/btphy/btphy.c **** 	{
 286              		.loc 1 130 5 is_stmt 0 view .LVU87
 287 0018 1869     		ldr	r0, [r3, #16]
 128:src/btphy/btphy.c **** 
 288              		.loc 1 128 19 view .LVU88
ARM GAS  /tmp/ccHmVI9k.s 			page 10


 289 001a D3E90112 		ldrd	r1, r2, [r3, #4]
 127:src/btphy/btphy.c **** 	btphy.slave_clkn ++;
 290              		.loc 1 127 19 view .LVU89
 291 001e 0131     		adds	r1, r1, #1
 128:src/btphy/btphy.c **** 
 292              		.loc 1 128 19 view .LVU90
 293 0020 0132     		adds	r2, r2, #1
 294 0022 C3E90112 		strd	r1, r2, [r3, #4]
 130:src/btphy/btphy.c **** 	{
 295              		.loc 1 130 2 is_stmt 1 view .LVU91
 130:src/btphy/btphy.c **** 	{
 296              		.loc 1 130 5 is_stmt 0 view .LVU92
 297 0026 28B1     		cbz	r0, .L23
 133:src/btphy/btphy.c **** 		btphy.clkn_delayed = 0;
 298              		.loc 1 133 3 is_stmt 1 view .LVU93
 133:src/btphy/btphy.c **** 		btphy.clkn_delayed = 0;
 299              		.loc 1 133 9 is_stmt 0 view .LVU94
 300 0028 40F63441 		movw	r1, #3124
 134:src/btphy/btphy.c **** 	}
 301              		.loc 1 134 22 view .LVU95
 302 002c 0020     		movs	r0, #0
 133:src/btphy/btphy.c **** 		btphy.clkn_delayed = 0;
 303              		.loc 1 133 9 view .LVU96
 304 002e 2C4A     		ldr	r2, .L46+4
 134:src/btphy/btphy.c **** 	}
 305              		.loc 1 134 22 view .LVU97
 306 0030 1861     		str	r0, [r3, #16]
 133:src/btphy/btphy.c **** 		btphy.clkn_delayed = 0;
 307              		.loc 1 133 9 view .LVU98
 308 0032 1160     		str	r1, [r2]
 134:src/btphy/btphy.c **** 	}
 309              		.loc 1 134 3 is_stmt 1 view .LVU99
 310              	.L23:
 138:src/btphy/btphy.c **** 
 311              		.loc 1 138 2 view .LVU100
 312              	.LBB48:
 313              	.LBI48:
  64:src/btphy/btphy.c **** {
 314              		.loc 1 64 13 view .LVU101
 315              	.LBB49:
  66:src/btphy/btphy.c **** 	unsigned j;
 316              		.loc 1 66 2 view .LVU102
  67:src/btphy/btphy.c **** 	uint32_t clkn = btphy_cur_clkn();
 317              		.loc 1 67 2 view .LVU103
  68:src/btphy/btphy.c **** 	btphy_timer_t *t;
 318              		.loc 1 68 2 view .LVU104
 319              	.LBB50:
 320              	.LBI50:
 321              		.file 2 "include/ubtbr/btphy.h"
   1:include/ubtbr/btphy.h **** #ifndef __BTPHY_H
   2:include/ubtbr/btphy.h **** #define __BTPHY_H
   3:include/ubtbr/btphy.h **** #include <stdint.h>
   4:include/ubtbr/btphy.h **** #include <ubertooth_interface.h>
   5:include/ubtbr/btphy.h **** #include <ubtbr/cfg.h>
   6:include/ubtbr/btphy.h **** #include <ubtbr/queue.h>
   7:include/ubtbr/btphy.h **** 
   8:include/ubtbr/btphy.h **** #define CLKN_RATE 3200
ARM GAS  /tmp/ccHmVI9k.s 			page 11


   9:include/ubtbr/btphy.h **** #define PERIPH_CLK_RATE	50000000			// 50Mhz
  10:include/ubtbr/btphy.h **** #define PERIPH_CLK_NS (1000000000/PERIPH_CLK_RATE)	// 20ns
  11:include/ubtbr/btphy.h **** #define CLK100NS_SECOND (1000000000/100)
  12:include/ubtbr/btphy.h **** /* clkn_offset prescale value (from peripheral clock -> 100ns) */
  13:include/ubtbr/btphy.h **** #define CLKN_OFFSET_PRESCALE_VAL 	(100/PERIPH_CLK_NS)
  14:include/ubtbr/btphy.h **** /* clk_offset match register value */
  15:include/ubtbr/btphy.h **** #define CLKN_OFFSET_RESET_VAL ((PERIPH_CLK_RATE/CLKN_OFFSET_PRESCALE_VAL)/CLKN_RATE)
  16:include/ubtbr/btphy.h **** #define MASTER_CLKN	T1TC
  17:include/ubtbr/btphy.h **** #define CLKN_OFFSET	T0TC
  18:include/ubtbr/btphy.h **** 
  19:include/ubtbr/btphy.h **** typedef enum btphy_mode_e {
  20:include/ubtbr/btphy.h **** 	BT_MODE_INQUIRY,
  21:include/ubtbr/btphy.h **** 	BT_MODE_PAGING,
  22:include/ubtbr/btphy.h **** 	BT_MODE_INQUIRY_SCAN,
  23:include/ubtbr/btphy.h **** 	BT_MODE_PAGE_SCAN,
  24:include/ubtbr/btphy.h **** 	BT_MODE_MASTER,
  25:include/ubtbr/btphy.h **** 	BT_MODE_SLAVE,
  26:include/ubtbr/btphy.h **** } btphy_mode_t ; 
  27:include/ubtbr/btphy.h **** 
  28:include/ubtbr/btphy.h **** typedef struct btphy_s {
  29:include/ubtbr/btphy.h **** 	btphy_mode_t mode;
  30:include/ubtbr/btphy.h **** 	uint32_t master_clkn; 
  31:include/ubtbr/btphy.h **** 	uint32_t slave_clkn; 
  32:include/ubtbr/btphy.h **** 	int slave_clkn_delay;
  33:include/ubtbr/btphy.h **** 	int clkn_delayed;
  34:include/ubtbr/btphy.h **** 	uint32_t chan_lap;
  35:include/ubtbr/btphy.h **** 	uint8_t chan_uap;
  36:include/ubtbr/btphy.h **** 	uint64_t chan_sw;
  37:include/ubtbr/btphy.h **** 	uint8_t chan_trailer;
  38:include/ubtbr/btphy.h **** 	uint8_t chan_sw_lo[4];
  39:include/ubtbr/btphy.h **** 	uint8_t chan_sw_hi[4];
  40:include/ubtbr/btphy.h **** 	uint32_t my_lap;
  41:include/ubtbr/btphy.h **** 	uint8_t  my_uap;
  42:include/ubtbr/btphy.h **** 	uint16_t my_nap;
  43:include/ubtbr/btphy.h **** 	uint64_t my_sw;
  44:include/ubtbr/btphy.h **** } btphy_t;
  45:include/ubtbr/btphy.h **** 
  46:include/ubtbr/btphy.h **** typedef void (*btphy_timer_fn_t)(void *arg);
  47:include/ubtbr/btphy.h **** 
  48:include/ubtbr/btphy.h **** extern btphy_t btphy;
  49:include/ubtbr/btphy.h **** 
  50:include/ubtbr/btphy.h **** #define CUR_MASTER_SLOT_IDX()	(btphy.master_clkn&3)
  51:include/ubtbr/btphy.h **** #define CUR_SLAVE_SLOT_IDX()	(btphy.slave_clkn&3)
  52:include/ubtbr/btphy.h **** 
  53:include/ubtbr/btphy.h **** static inline uint32_t btphy_cur_clkn(void)
 322              		.loc 2 53 24 view .LVU105
 323              	.LBB51:
  54:include/ubtbr/btphy.h **** {
  55:include/ubtbr/btphy.h **** 	switch(btphy.mode)
 324              		.loc 2 55 2 view .LVU106
 325              		.loc 2 55 14 is_stmt 0 view .LVU107
 326 0034 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 327              		.loc 2 55 2 view .LVU108
 328 0036 032A     		cmp	r2, #3
 329 0038 38D8     		bhi	.L24
 330 003a 012A     		cmp	r2, #1
 331 003c 38D8     		bhi	.L25
ARM GAS  /tmp/ccHmVI9k.s 			page 12


 332              	.L26:
  56:include/ubtbr/btphy.h **** 	{
  57:include/ubtbr/btphy.h **** 	case BT_MODE_INQUIRY_SCAN:
  58:include/ubtbr/btphy.h **** 	case BT_MODE_PAGE_SCAN:
  59:include/ubtbr/btphy.h **** 	case BT_MODE_SLAVE:
  60:include/ubtbr/btphy.h **** 		return btphy.slave_clkn;
  61:include/ubtbr/btphy.h **** 	default:
  62:include/ubtbr/btphy.h **** 		return btphy.master_clkn;
 333              		.loc 2 62 3 is_stmt 1 view .LVU109
 334              		.loc 2 62 15 is_stmt 0 view .LVU110
 335 003e 5E68     		ldr	r6, [r3, #4]
 336              	.L27:
 337              	.LVL29:
 338              		.loc 2 62 15 view .LVU111
 339              	.LBE51:
 340              	.LBE50:
  69:src/btphy/btphy.c **** 
 341              		.loc 1 69 2 is_stmt 1 view .LVU112
  71:src/btphy/btphy.c **** 		; j<btphy_timers.count && i<BTPHY_TIMER_COUNT
 342              		.loc 1 71 2 view .LVU113
  72:src/btphy/btphy.c **** 		; i++,t++)
 343              		.loc 1 72 5 view .LVU114
  72:src/btphy/btphy.c **** 		; i++,t++)
 344              		.loc 1 72 19 is_stmt 0 view .LVU115
 345 0040 DFF8A0B0 		ldr	fp, .L46+8
 346 0044 DBF80030 		ldr	r3, [fp]
  71:src/btphy/btphy.c **** 		; j<btphy_timers.count && i<BTPHY_TIMER_COUNT
 347              		.loc 1 71 2 view .LVU116
 348 0048 A3B3     		cbz	r3, .L36
  71:src/btphy/btphy.c **** 		; j<btphy_timers.count && i<BTPHY_TIMER_COUNT
 349              		.loc 1 71 12 view .LVU117
 350 004a 0025     		movs	r5, #0
 351 004c 5C46     		mov	r4, fp
  93:src/btphy/btphy.c **** 				btphy_timers.count--;
 352              		.loc 1 93 11 view .LVU118
 353 004e A846     		mov	r8, r5
  91:src/btphy/btphy.c **** 				}
 354              		.loc 1 91 6 view .LVU119
 355 0050 DFF894A0 		ldr	r10, .L46+12
  87:src/btphy/btphy.c **** 					t->cb(t->cb_arg);
 356              		.loc 1 87 6 view .LVU120
 357 0054 DFF89490 		ldr	r9, .L46+16
 358 0058 0BF1A007 		add	r7, fp, #160
 359 005c 16E0     		b	.L37
 360              	.LVL30:
 361              	.L32:
  83:src/btphy/btphy.c **** 			{
 362              		.loc 1 83 9 is_stmt 1 view .LVU121
  83:src/btphy/btphy.c **** 			{
 363              		.loc 1 83 12 is_stmt 0 view .LVU122
 364 005e 0FD2     		bcs	.L33
  85:src/btphy/btphy.c **** 				{
 365              		.loc 1 85 5 is_stmt 1 view .LVU123
  85:src/btphy/btphy.c **** 				{
 366              		.loc 1 85 8 is_stmt 0 view .LVU124
 367 0060 237C     		ldrb	r3, [r4, #16]	@ zero_extendqisi2
 368 0062 002B     		cmp	r3, #0
ARM GAS  /tmp/ccHmVI9k.s 			page 13


 369 0064 36D0     		beq	.L34
  87:src/btphy/btphy.c **** 					t->cb(t->cb_arg);
 370              		.loc 1 87 6 is_stmt 1 view .LVU125
 371 0066 4846     		mov	r0, r9
 372 0068 FFF7FEFF 		bl	cprintf
 373              	.LVL31:
  88:src/btphy/btphy.c **** 				}
 374              		.loc 1 88 6 view .LVU126
 375 006c D4E90230 		ldrd	r3, r0, [r4, #8]
 376 0070 9847     		blx	r3
 377              	.LVL32:
 378              	.L35:
  93:src/btphy/btphy.c **** 				btphy_timers.count--;
 379              		.loc 1 93 5 view .LVU127
  94:src/btphy/btphy.c **** 			}
 380              		.loc 1 94 23 is_stmt 0 view .LVU128
 381 0072 DBF80030 		ldr	r3, [fp]
  93:src/btphy/btphy.c **** 				btphy_timers.count--;
 382              		.loc 1 93 11 view .LVU129
 383 0076 C4F80880 		str	r8, [r4, #8]
  94:src/btphy/btphy.c **** 			}
 384              		.loc 1 94 5 is_stmt 1 view .LVU130
  94:src/btphy/btphy.c **** 			}
 385              		.loc 1 94 23 is_stmt 0 view .LVU131
 386 007a 013B     		subs	r3, r3, #1
 387 007c CBF80030 		str	r3, [fp]
 388              	.L33:
  96:src/btphy/btphy.c **** 		}
 389              		.loc 1 96 4 is_stmt 1 view .LVU132
  96:src/btphy/btphy.c **** 		}
 390              		.loc 1 96 5 is_stmt 0 view .LVU133
 391 0080 0135     		adds	r5, r5, #1
 392              	.LVL33:
 393              	.L31:
  73:src/btphy/btphy.c **** 	{
 394              		.loc 1 73 5 is_stmt 1 view .LVU134
  72:src/btphy/btphy.c **** 		; i++,t++)
 395              		.loc 1 72 5 view .LVU135
  71:src/btphy/btphy.c **** 		; j<btphy_timers.count && i<BTPHY_TIMER_COUNT
 396              		.loc 1 71 2 is_stmt 0 view .LVU136
 397 0082 9D42     		cmp	r5, r3
 398 0084 16D2     		bcs	.L36
  71:src/btphy/btphy.c **** 		; j<btphy_timers.count && i<BTPHY_TIMER_COUNT
 399              		.loc 1 71 2 view .LVU137
 400 0086 1034     		adds	r4, r4, #16
 401              	.LVL34:
  72:src/btphy/btphy.c **** 		; i++,t++)
 402              		.loc 1 72 26 view .LVU138
 403 0088 BC42     		cmp	r4, r7
 404 008a 13D0     		beq	.L36
 405              	.LVL35:
 406              	.L37:
  75:src/btphy/btphy.c **** 		{
 407              		.loc 1 75 3 is_stmt 1 view .LVU139
  75:src/btphy/btphy.c **** 		{
 408              		.loc 1 75 8 is_stmt 0 view .LVU140
 409 008c A168     		ldr	r1, [r4, #8]
ARM GAS  /tmp/ccHmVI9k.s 			page 14


  75:src/btphy/btphy.c **** 		{
 410              		.loc 1 75 6 view .LVU141
 411 008e 0029     		cmp	r1, #0
 412 0090 F7D0     		beq	.L31
  77:src/btphy/btphy.c **** 			{
 413              		.loc 1 77 4 is_stmt 1 view .LVU142
  77:src/btphy/btphy.c **** 			{
 414              		.loc 1 77 9 is_stmt 0 view .LVU143
 415 0092 6268     		ldr	r2, [r4, #4]
  77:src/btphy/btphy.c **** 			{
 416              		.loc 1 77 7 view .LVU144
 417 0094 B242     		cmp	r2, r6
 418 0096 E2D1     		bne	.L32
  79:src/btphy/btphy.c **** 				t->cb = NULL;
 419              		.loc 1 79 5 is_stmt 1 view .LVU145
 420 0098 E068     		ldr	r0, [r4, #12]
 421 009a 8847     		blx	r1
 422              	.LVL36:
  80:src/btphy/btphy.c **** 				btphy_timers.count--;
 423              		.loc 1 80 5 view .LVU146
  81:src/btphy/btphy.c **** 			}
 424              		.loc 1 81 23 is_stmt 0 view .LVU147
 425 009c DBF80030 		ldr	r3, [fp]
  80:src/btphy/btphy.c **** 				btphy_timers.count--;
 426              		.loc 1 80 11 view .LVU148
 427 00a0 C4F80880 		str	r8, [r4, #8]
  81:src/btphy/btphy.c **** 			}
 428              		.loc 1 81 5 is_stmt 1 view .LVU149
  81:src/btphy/btphy.c **** 			}
 429              		.loc 1 81 23 is_stmt 0 view .LVU150
 430 00a4 013B     		subs	r3, r3, #1
 431 00a6 CBF80030 		str	r3, [fp]
 432 00aa E9E7     		b	.L33
 433              	.LVL37:
 434              	.L24:
 435              	.LBB53:
 436              	.LBB52:
  55:include/ubtbr/btphy.h **** 	{
 437              		.loc 2 55 2 view .LVU151
 438 00ac 052A     		cmp	r2, #5
 439 00ae C6D1     		bne	.L26
 440              	.L25:
  60:include/ubtbr/btphy.h **** 	default:
 441              		.loc 2 60 3 is_stmt 1 view .LVU152
  60:include/ubtbr/btphy.h **** 	default:
 442              		.loc 2 60 15 is_stmt 0 view .LVU153
 443 00b0 9E68     		ldr	r6, [r3, #8]
 444 00b2 C5E7     		b	.L27
 445              	.LVL38:
 446              	.L36:
  60:include/ubtbr/btphy.h **** 	default:
 447              		.loc 2 60 15 view .LVU154
 448              	.LBE52:
 449              	.LBE53:
 450              	.LBE49:
 451              	.LBE48:
 141:src/btphy/btphy.c **** 
ARM GAS  /tmp/ccHmVI9k.s 			page 15


 452              		.loc 1 141 2 is_stmt 1 view .LVU155
 453              	.LBE56:
 454              	.LBE59:
 157:src/btphy/btphy.c **** 		{
 455              		.loc 1 157 7 is_stmt 0 view .LVU156
 456 00b4 4FF04024 		mov	r4, #1073758208
 457              	.LBB60:
 458              	.LBB57:
 141:src/btphy/btphy.c **** 
 459              		.loc 1 141 2 view .LVU157
 460 00b8 FFF7FEFF 		bl	tdma_sched_execute
 461              	.LVL39:
 144:src/btphy/btphy.c **** }
 462              		.loc 1 144 2 is_stmt 1 view .LVU158
 463 00bc FFF7FEFF 		bl	tdma_sched_advance
 464              	.LVL40:
 465              	.LBE57:
 466              	.LBE60:
 157:src/btphy/btphy.c **** 		{
 467              		.loc 1 157 3 view .LVU159
 157:src/btphy/btphy.c **** 		{
 468              		.loc 1 157 7 is_stmt 0 view .LVU160
 469 00c0 2368     		ldr	r3, [r4]
 157:src/btphy/btphy.c **** 		{
 470              		.loc 1 157 6 view .LVU161
 471 00c2 002B     		cmp	r3, #0
 472 00c4 A3D0     		beq	.L20
 159:src/btphy/btphy.c **** 			T0IR = TIR_MR0_Interrupt;
 473              		.loc 1 159 4 is_stmt 1 view .LVU162
 474 00c6 4F20     		movs	r0, #79
 475 00c8 FFF7FEFF 		bl	console_putc
 476              	.LVL41:
 160:src/btphy/btphy.c **** 		}
 477              		.loc 1 160 4 view .LVU163
 160:src/btphy/btphy.c **** 		}
 478              		.loc 1 160 9 is_stmt 0 view .LVU164
 479 00cc 0123     		movs	r3, #1
 480 00ce 2360     		str	r3, [r4]
 481              		.loc 1 163 1 view .LVU165
 482 00d0 BDE8F88F 		pop	{r3, r4, r5, r6, r7, r8, r9, r10, fp, pc}
 483              	.LVL42:
 484              	.L34:
 485              	.LBB61:
 486              	.LBB58:
 487              	.LBB55:
 488              	.LBB54:
  91:src/btphy/btphy.c **** 				}
 489              		.loc 1 91 6 is_stmt 1 view .LVU166
 490 00d4 5046     		mov	r0, r10
 491 00d6 FFF7FEFF 		bl	cprintf
 492              	.LVL43:
 493 00da CAE7     		b	.L35
 494              	.L47:
 495              		.align	2
 496              	.L46:
 497 00dc 00000000 		.word	.LANCHOR0
 498 00e0 18400040 		.word	1073758232
ARM GAS  /tmp/ccHmVI9k.s 			page 16


 499 00e4 00000000 		.word	btphy_timers
 500 00e8 34000000 		.word	.LC3
 501 00ec 30000000 		.word	.LC2
 502              	.LBE54:
 503              	.LBE55:
 504              	.LBE58:
 505              	.LBE61:
 506              		.cfi_endproc
 507              	.LFE31:
 509              		.section	.text.btphy_adj_clkn_delay,"ax",%progbits
 510              		.align	1
 511              		.p2align 2,,3
 512              		.global	btphy_adj_clkn_delay
 513              		.syntax unified
 514              		.thumb
 515              		.thumb_func
 516              		.fpu softvfp
 518              	btphy_adj_clkn_delay:
 519              	.LVL44:
 520              	.LFB32:
 164:src/btphy/btphy.c **** 
 165:src/btphy/btphy.c **** void btphy_adj_clkn_delay(int delay)
 166:src/btphy/btphy.c **** {
 521              		.loc 1 166 1 view -0
 522              		.cfi_startproc
 523              		@ args = 0, pretend = 0, frame = 0
 524              		@ frame_needed = 0, uses_anonymous_args = 0
 525              		@ link register save eliminated.
 526              		.loc 1 166 1 is_stmt 0 view .LVU168
 527 0000 30B4     		push	{r4, r5}
 528              		.cfi_def_cfa_offset 8
 529              		.cfi_offset 4, -8
 530              		.cfi_offset 5, -4
 167:src/btphy/btphy.c **** 	T0MR0 = (CLKN_OFFSET_RESET_VAL+delay)-1;
 531              		.loc 1 167 2 is_stmt 1 view .LVU169
 168:src/btphy/btphy.c **** 	btphy.slave_clkn_delay += delay;
 169:src/btphy/btphy.c **** 	btphy.clkn_delayed = 1;
 532              		.loc 1 169 21 is_stmt 0 view .LVU170
 533 0002 0121     		movs	r1, #1
 168:src/btphy/btphy.c **** 	btphy.slave_clkn_delay += delay;
 534              		.loc 1 168 25 view .LVU171
 535 0004 054B     		ldr	r3, .L49
 167:src/btphy/btphy.c **** 	T0MR0 = (CLKN_OFFSET_RESET_VAL+delay)-1;
 536              		.loc 1 167 8 view .LVU172
 537 0006 064C     		ldr	r4, .L49+4
 168:src/btphy/btphy.c **** 	btphy.slave_clkn_delay += delay;
 538              		.loc 1 168 25 view .LVU173
 539 0008 DA68     		ldr	r2, [r3, #12]
 167:src/btphy/btphy.c **** 	T0MR0 = (CLKN_OFFSET_RESET_VAL+delay)-1;
 540              		.loc 1 167 39 view .LVU174
 541 000a 00F63445 		addw	r5, r0, #3124
 168:src/btphy/btphy.c **** 	btphy.slave_clkn_delay += delay;
 542              		.loc 1 168 25 view .LVU175
 543 000e 1044     		add	r0, r0, r2
 544              	.LVL45:
 167:src/btphy/btphy.c **** 	T0MR0 = (CLKN_OFFSET_RESET_VAL+delay)-1;
 545              		.loc 1 167 8 view .LVU176
ARM GAS  /tmp/ccHmVI9k.s 			page 17


 546 0010 2560     		str	r5, [r4]
 168:src/btphy/btphy.c **** 	btphy.slave_clkn_delay += delay;
 547              		.loc 1 168 2 is_stmt 1 view .LVU177
 548              		.loc 1 169 21 is_stmt 0 view .LVU178
 549 0012 C3E90301 		strd	r0, r1, [r3, #12]
 170:src/btphy/btphy.c **** }
 550              		.loc 1 170 1 view .LVU179
 551 0016 30BC     		pop	{r4, r5}
 552              		.cfi_restore 5
 553              		.cfi_restore 4
 554              		.cfi_def_cfa_offset 0
 555              	.LVL46:
 556              		.loc 1 170 1 view .LVU180
 557 0018 7047     		bx	lr
 558              	.L50:
 559 001a 00BF     		.align	2
 560              	.L49:
 561 001c 00000000 		.word	.LANCHOR0
 562 0020 18400040 		.word	1073758232
 563              		.cfi_endproc
 564              	.LFE32:
 566              		.section	.text.btphy_cancel_clkn_delay,"ax",%progbits
 567              		.align	1
 568              		.p2align 2,,3
 569              		.global	btphy_cancel_clkn_delay
 570              		.syntax unified
 571              		.thumb
 572              		.thumb_func
 573              		.fpu softvfp
 575              	btphy_cancel_clkn_delay:
 576              	.LFB33:
 171:src/btphy/btphy.c **** 
 172:src/btphy/btphy.c **** void btphy_cancel_clkn_delay(void)
 173:src/btphy/btphy.c **** {
 577              		.loc 1 173 1 is_stmt 1 view -0
 578              		.cfi_startproc
 579              		@ args = 0, pretend = 0, frame = 0
 580              		@ frame_needed = 0, uses_anonymous_args = 0
 581              		@ link register save eliminated.
 582 0000 30B4     		push	{r4, r5}
 583              		.cfi_def_cfa_offset 8
 584              		.cfi_offset 4, -8
 585              		.cfi_offset 5, -4
 174:src/btphy/btphy.c **** 	unsigned delay = btphy.slave_clkn_delay % CLKN_OFFSET_RESET_VAL;
 586              		.loc 1 174 2 view .LVU182
 587              	.LBB62:
 588              	.LBB63:
 169:src/btphy/btphy.c **** }
 589              		.loc 1 169 21 is_stmt 0 view .LVU183
 590 0002 0123     		movs	r3, #1
 591              	.LBE63:
 592              	.LBE62:
 593              		.loc 1 174 42 view .LVU184
 594 0004 40F63545 		movw	r5, #3125
 595              		.loc 1 174 24 view .LVU185
 596 0008 0B49     		ldr	r1, .L52
 597              		.loc 1 174 42 view .LVU186
ARM GAS  /tmp/ccHmVI9k.s 			page 18


 598 000a 0C4C     		ldr	r4, .L52+4
 599              		.loc 1 174 24 view .LVU187
 600 000c CA68     		ldr	r2, [r1, #12]
 601              	.LBB68:
 602              	.LBB64:
 169:src/btphy/btphy.c **** }
 603              		.loc 1 169 21 view .LVU188
 604 000e 0B61     		str	r3, [r1, #16]
 605              	.LBE64:
 606              	.LBE68:
 607              		.loc 1 174 42 view .LVU189
 608 0010 84FB0234 		smull	r3, r4, r4, r2
 609 0014 D017     		asrs	r0, r2, #31
 610 0016 C0EB2423 		rsb	r3, r0, r4, asr #8
 611 001a 05FB1323 		mls	r3, r5, r3, r2
 612              	.LVL47:
 175:src/btphy/btphy.c **** 	unsigned clk_delay = btphy.slave_clkn_delay / CLKN_OFFSET_RESET_VAL;
 613              		.loc 1 175 2 is_stmt 1 view .LVU190
 176:src/btphy/btphy.c **** 
 177:src/btphy/btphy.c **** 	btphy.master_clkn += clk_delay;
 614              		.loc 1 177 2 view .LVU191
 615              		.loc 1 177 20 is_stmt 0 view .LVU192
 616 001e 4D68     		ldr	r5, [r1, #4]
 175:src/btphy/btphy.c **** 	unsigned clk_delay = btphy.slave_clkn_delay / CLKN_OFFSET_RESET_VAL;
 617              		.loc 1 175 46 view .LVU193
 618 0020 C0EB2420 		rsb	r0, r0, r4, asr #8
 619              	.LBB69:
 620              	.LBB65:
 167:src/btphy/btphy.c **** 	btphy.slave_clkn_delay += delay;
 621              		.loc 1 167 8 view .LVU194
 622 0024 064C     		ldr	r4, .L52+8
 623              	.LBE65:
 624              	.LBE69:
 625              		.loc 1 177 20 view .LVU195
 626 0026 2844     		add	r0, r0, r5
 627              	.LBB70:
 628              	.LBB66:
 168:src/btphy/btphy.c **** 	btphy.clkn_delayed = 1;
 629              		.loc 1 168 25 view .LVU196
 630 0028 1A44     		add	r2, r2, r3
 631              	.LVL48:
 167:src/btphy/btphy.c **** 	btphy.slave_clkn_delay += delay;
 632              		.loc 1 167 39 view .LVU197
 633 002a 03F63443 		addw	r3, r3, #3124
 634              	.LVL49:
 167:src/btphy/btphy.c **** 	btphy.slave_clkn_delay += delay;
 635              		.loc 1 167 39 view .LVU198
 636              	.LBE66:
 637              	.LBE70:
 638              		.loc 1 177 20 view .LVU199
 639 002e 4860     		str	r0, [r1, #4]
 178:src/btphy/btphy.c **** 	btphy_adj_clkn_delay(delay);
 640              		.loc 1 178 2 is_stmt 1 view .LVU200
 641              	.LVL50:
 642              	.LBB71:
 643              	.LBI62:
 165:src/btphy/btphy.c **** {
ARM GAS  /tmp/ccHmVI9k.s 			page 19


 644              		.loc 1 165 6 view .LVU201
 645              	.LBB67:
 167:src/btphy/btphy.c **** 	btphy.slave_clkn_delay += delay;
 646              		.loc 1 167 2 view .LVU202
 168:src/btphy/btphy.c **** 	btphy.clkn_delayed = 1;
 647              		.loc 1 168 25 is_stmt 0 view .LVU203
 648 0030 CA60     		str	r2, [r1, #12]
 649              	.LVL51:
 167:src/btphy/btphy.c **** 	btphy.slave_clkn_delay += delay;
 650              		.loc 1 167 8 view .LVU204
 651 0032 2360     		str	r3, [r4]
 168:src/btphy/btphy.c **** 	btphy.clkn_delayed = 1;
 652              		.loc 1 168 2 is_stmt 1 view .LVU205
 169:src/btphy/btphy.c **** }
 653              		.loc 1 169 2 view .LVU206
 654              	.LVL52:
 169:src/btphy/btphy.c **** }
 655              		.loc 1 169 2 is_stmt 0 view .LVU207
 656              	.LBE67:
 657              	.LBE71:
 179:src/btphy/btphy.c **** }
 658              		.loc 1 179 1 view .LVU208
 659 0034 30BC     		pop	{r4, r5}
 660              		.cfi_restore 5
 661              		.cfi_restore 4
 662              		.cfi_def_cfa_offset 0
 663 0036 7047     		bx	lr
 664              	.L53:
 665              		.align	2
 666              	.L52:
 667 0038 00000000 		.word	.LANCHOR0
 668 003c 89B5F814 		.word	351843721
 669 0040 18400040 		.word	1073758232
 670              		.cfi_endproc
 671              	.LFE33:
 673              		.section	.text.clkn_start,"ax",%progbits
 674              		.align	1
 675              		.p2align 2,,3
 676              		.global	clkn_start
 677              		.syntax unified
 678              		.thumb
 679              		.thumb_func
 680              		.fpu softvfp
 682              	clkn_start:
 683              	.LFB34:
 180:src/btphy/btphy.c **** 
 181:src/btphy/btphy.c **** void clkn_start(void)
 182:src/btphy/btphy.c **** {
 684              		.loc 1 182 1 is_stmt 1 view -0
 685              		.cfi_startproc
 686              		@ args = 0, pretend = 0, frame = 0
 687              		@ frame_needed = 0, uses_anonymous_args = 0
 688 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 689              		.cfi_def_cfa_offset 24
 690              		.cfi_offset 4, -24
 691              		.cfi_offset 5, -20
 692              		.cfi_offset 6, -16
ARM GAS  /tmp/ccHmVI9k.s 			page 20


 693              		.cfi_offset 7, -12
 694              		.cfi_offset 8, -8
 695              		.cfi_offset 14, -4
 183:src/btphy/btphy.c **** 	unsigned prescale;
 696              		.loc 1 183 2 view .LVU210
 184:src/btphy/btphy.c **** 
 185:src/btphy/btphy.c **** 	/* Disable tdma interrupt */
 186:src/btphy/btphy.c **** 	ICER0 = ICER0_ICE_TIMER0;
 697              		.loc 1 186 2 view .LVU211
 698              		.loc 1 186 8 is_stmt 0 view .LVU212
 699 0004 0222     		movs	r2, #2
 187:src/btphy/btphy.c **** 	ICER0 = ICER0_ICE_TIMER1;
 700              		.loc 1 187 8 view .LVU213
 701 0006 0425     		movs	r5, #4
 188:src/btphy/btphy.c **** 	
 189:src/btphy/btphy.c **** 	// stop timers
 190:src/btphy/btphy.c **** 	T0TCR = 0;
 702              		.loc 1 190 8 view .LVU214
 703 0008 0023     		movs	r3, #0
 191:src/btphy/btphy.c **** 	T1TCR = 0;
 192:src/btphy/btphy.c **** 	btphy.master_clkn = 0;
 193:src/btphy/btphy.c **** 
 194:src/btphy/btphy.c **** 	/* Timer 0: 100ns adjustable clkn interrupt */
 195:src/btphy/btphy.c **** 	T0PR = CLKN_OFFSET_PRESCALE_VAL-1;
 196:src/btphy/btphy.c **** 	/* Match register 0: CLKN_RATE */
 197:src/btphy/btphy.c **** 	T0MR0 = CLKN_OFFSET_RESET_VAL-1;
 704              		.loc 1 197 8 view .LVU215
 705 000a 40F63448 		movw	r8, #3124
 198:src/btphy/btphy.c **** 	/* Match control register: Reset TC, trigger interrupt. */
 199:src/btphy/btphy.c **** 	T0MCR = TMCR_MR0R | TMCR_MR0I;
 706              		.loc 1 199 8 view .LVU216
 707 000e 4FF0030E 		mov	lr, #3
 200:src/btphy/btphy.c **** 
 201:src/btphy/btphy.c **** 	/* Timer 1: clkn value */
 202:src/btphy/btphy.c **** 	/* Prescale from peripheral clock -> clkn clock */
 203:src/btphy/btphy.c **** 	T1PR = (PERIPH_CLK_RATE/CLKN_RATE)-1;
 708              		.loc 1 203 7 view .LVU217
 709 0012 43F6085C 		movw	ip, #15624
 204:src/btphy/btphy.c **** 	/* Match register 0: nothing */
 205:src/btphy/btphy.c **** 	T1MR0 = 0xffffffff-1;
 710              		.loc 1 205 8 view .LVU218
 711 0016 6FF00107 		mvn	r7, #1
 206:src/btphy/btphy.c **** 	/* Match control register: Reset TC, no interrupt . */
 207:src/btphy/btphy.c **** 	T1MCR = TMCR_MR0R;
 208:src/btphy/btphy.c **** 
 209:src/btphy/btphy.c **** 	/* Enable timer0 interrupt */
 210:src/btphy/btphy.c **** 	ISER0 = ISER0_ISE_TIMER0;
 211:src/btphy/btphy.c **** 
 212:src/btphy/btphy.c **** 	/* Start the timers */
 213:src/btphy/btphy.c **** 	T1TCR = 1;
 712              		.loc 1 213 8 view .LVU219
 713 001a 0120     		movs	r0, #1
 186:src/btphy/btphy.c **** 	ICER0 = ICER0_ICE_TIMER1;
 714              		.loc 1 186 8 view .LVU220
 715 001c 0F4E     		ldr	r6, .L55
 190:src/btphy/btphy.c **** 	T1TCR = 0;
 716              		.loc 1 190 8 view .LVU221
ARM GAS  /tmp/ccHmVI9k.s 			page 21


 717 001e 1049     		ldr	r1, .L55+4
 186:src/btphy/btphy.c **** 	ICER0 = ICER0_ICE_TIMER1;
 718              		.loc 1 186 8 view .LVU222
 719 0020 3260     		str	r2, [r6]
 187:src/btphy/btphy.c **** 	
 720              		.loc 1 187 2 is_stmt 1 view .LVU223
 191:src/btphy/btphy.c **** 	btphy.master_clkn = 0;
 721              		.loc 1 191 8 is_stmt 0 view .LVU224
 722 0022 104C     		ldr	r4, .L55+8
 187:src/btphy/btphy.c **** 	
 723              		.loc 1 187 8 view .LVU225
 724 0024 3560     		str	r5, [r6]
 190:src/btphy/btphy.c **** 	T1TCR = 0;
 725              		.loc 1 190 2 is_stmt 1 view .LVU226
 195:src/btphy/btphy.c **** 	/* Match register 0: CLKN_RATE */
 726              		.loc 1 195 7 is_stmt 0 view .LVU227
 727 0026 104E     		ldr	r6, .L55+12
 190:src/btphy/btphy.c **** 	T1TCR = 0;
 728              		.loc 1 190 8 view .LVU228
 729 0028 0B60     		str	r3, [r1]
 191:src/btphy/btphy.c **** 	btphy.master_clkn = 0;
 730              		.loc 1 191 2 is_stmt 1 view .LVU229
 191:src/btphy/btphy.c **** 	btphy.master_clkn = 0;
 731              		.loc 1 191 8 is_stmt 0 view .LVU230
 732 002a 2360     		str	r3, [r4]
 192:src/btphy/btphy.c **** 
 733              		.loc 1 192 2 is_stmt 1 view .LVU231
 195:src/btphy/btphy.c **** 	/* Match register 0: CLKN_RATE */
 734              		.loc 1 195 7 is_stmt 0 view .LVU232
 735 002c 3560     		str	r5, [r6]
 197:src/btphy/btphy.c **** 	/* Match control register: Reset TC, trigger interrupt. */
 736              		.loc 1 197 8 view .LVU233
 737 002e 0F4D     		ldr	r5, .L55+16
 205:src/btphy/btphy.c **** 	/* Match control register: Reset TC, no interrupt . */
 738              		.loc 1 205 8 view .LVU234
 739 0030 06F58046 		add	r6, r6, #16384
 197:src/btphy/btphy.c **** 	/* Match control register: Reset TC, trigger interrupt. */
 740              		.loc 1 197 8 view .LVU235
 741 0034 C5F80080 		str	r8, [r5]
 199:src/btphy/btphy.c **** 
 742              		.loc 1 199 8 view .LVU236
 743 0038 45F804EC 		str	lr, [r5, #-4]
 203:src/btphy/btphy.c **** 	/* Match register 0: nothing */
 744              		.loc 1 203 7 view .LVU237
 745 003c 05F57F55 		add	r5, r5, #16320
 205:src/btphy/btphy.c **** 	/* Match control register: Reset TC, no interrupt . */
 746              		.loc 1 205 8 view .LVU238
 747 0040 0C36     		adds	r6, r6, #12
 203:src/btphy/btphy.c **** 	/* Match register 0: nothing */
 748              		.loc 1 203 7 view .LVU239
 749 0042 C5F834C0 		str	ip, [r5, #52]
 750 0046 3435     		adds	r5, r5, #52
 205:src/btphy/btphy.c **** 	/* Match control register: Reset TC, no interrupt . */
 751              		.loc 1 205 8 view .LVU240
 752 0048 3760     		str	r7, [r6]
 207:src/btphy/btphy.c **** 
 753              		.loc 1 207 8 view .LVU241
ARM GAS  /tmp/ccHmVI9k.s 			page 22


 754 004a AA60     		str	r2, [r5, #8]
 210:src/btphy/btphy.c **** 
 755              		.loc 1 210 8 view .LVU242
 756 004c 084E     		ldr	r6, .L55+20
 192:src/btphy/btphy.c **** 
 757              		.loc 1 192 20 view .LVU243
 758 004e 094D     		ldr	r5, .L55+24
 210:src/btphy/btphy.c **** 
 759              		.loc 1 210 8 view .LVU244
 760 0050 3260     		str	r2, [r6]
 192:src/btphy/btphy.c **** 
 761              		.loc 1 192 20 view .LVU245
 762 0052 6B60     		str	r3, [r5, #4]
 195:src/btphy/btphy.c **** 	/* Match register 0: CLKN_RATE */
 763              		.loc 1 195 2 is_stmt 1 view .LVU246
 197:src/btphy/btphy.c **** 	/* Match control register: Reset TC, trigger interrupt. */
 764              		.loc 1 197 2 view .LVU247
 199:src/btphy/btphy.c **** 
 765              		.loc 1 199 2 view .LVU248
 203:src/btphy/btphy.c **** 	/* Match register 0: nothing */
 766              		.loc 1 203 2 view .LVU249
 205:src/btphy/btphy.c **** 	/* Match control register: Reset TC, no interrupt . */
 767              		.loc 1 205 2 view .LVU250
 207:src/btphy/btphy.c **** 
 768              		.loc 1 207 2 view .LVU251
 210:src/btphy/btphy.c **** 
 769              		.loc 1 210 2 view .LVU252
 770              		.loc 1 213 2 view .LVU253
 771              		.loc 1 213 8 is_stmt 0 view .LVU254
 772 0054 2060     		str	r0, [r4]
 214:src/btphy/btphy.c **** 	T0TCR = 1;
 773              		.loc 1 214 2 is_stmt 1 view .LVU255
 774              		.loc 1 214 8 is_stmt 0 view .LVU256
 775 0056 0860     		str	r0, [r1]
 215:src/btphy/btphy.c **** }
 776              		.loc 1 215 1 view .LVU257
 777 0058 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 778              	.L56:
 779              		.align	2
 780              	.L55:
 781 005c 80E100E0 		.word	-536813184
 782 0060 04400040 		.word	1073758212
 783 0064 04800040 		.word	1073774596
 784 0068 0C400040 		.word	1073758220
 785 006c 18400040 		.word	1073758232
 786 0070 00E100E0 		.word	-536813312
 787 0074 00000000 		.word	.LANCHOR0
 788              		.cfi_endproc
 789              	.LFE34:
 791              		.section	.rodata.str1.4
 792 0043 00       		.align	2
 793              	.LC4:
 794 0044 4449457C 		.ascii	"DIE|Invalid rx mode %d\012\012\000"
 794      496E7661 
 794      6C696420 
 794      7278206D 
 794      6F646520 
ARM GAS  /tmp/ccHmVI9k.s 			page 23


 795              		.section	.text.btphy_whiten_seed,"ax",%progbits
 796              		.align	1
 797              		.p2align 2,,3
 798              		.global	btphy_whiten_seed
 799              		.syntax unified
 800              		.thumb
 801              		.thumb_func
 802              		.fpu softvfp
 804              	btphy_whiten_seed:
 805              	.LVL53:
 806              	.LFB35:
 216:src/btphy/btphy.c **** 
 217:src/btphy/btphy.c **** /* TODO: move this ?*/
 218:src/btphy/btphy.c **** uint8_t btphy_whiten_seed(uint32_t clk)
 219:src/btphy/btphy.c **** {
 807              		.loc 1 219 1 is_stmt 1 view -0
 808              		.cfi_startproc
 809              		@ args = 0, pretend = 0, frame = 0
 810              		@ frame_needed = 0, uses_anonymous_args = 0
 811              		.loc 1 219 1 is_stmt 0 view .LVU259
 812 0000 08B5     		push	{r3, lr}
 813              		.cfi_def_cfa_offset 8
 814              		.cfi_offset 3, -8
 815              		.cfi_offset 14, -4
 220:src/btphy/btphy.c **** 	/* Initialize whiten seed */
 221:src/btphy/btphy.c **** 	switch(btphy.mode)
 816              		.loc 1 221 2 is_stmt 1 view .LVU260
 817              		.loc 1 221 14 is_stmt 0 view .LVU261
 818 0002 0A4B     		ldr	r3, .L65
 819 0004 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 820              		.loc 1 221 2 view .LVU262
 821 0006 0329     		cmp	r1, #3
 822 0008 04D8     		bhi	.L63
 222:src/btphy/btphy.c **** 	{
 223:src/btphy/btphy.c **** 	case BT_MODE_INQUIRY:
 224:src/btphy/btphy.c **** 	case BT_MODE_PAGING:
 225:src/btphy/btphy.c **** 	case BT_MODE_INQUIRY_SCAN:
 226:src/btphy/btphy.c **** 	case BT_MODE_PAGE_SCAN:
 227:src/btphy/btphy.c **** 	/* BT 5.1|Vol 2, Part B, 7.2 :
 228:src/btphy/btphy.c **** 	 * Instead of the master clock, the X-input used in the inquiry or page response (depending on cur
 229:src/btphy/btphy.c **** 	 * routine shall be used The 5-bit value shall be extended with two MSBs of value 1 */
 230:src/btphy/btphy.c **** 		return hop_state.x|0x60;
 823              		.loc 1 230 3 is_stmt 1 view .LVU263
 824              		.loc 1 230 19 is_stmt 0 view .LVU264
 825 000a 094B     		ldr	r3, .L65+4
 826              		.loc 1 230 21 view .LVU265
 827 000c 9879     		ldrb	r0, [r3, #6]	@ zero_extendqisi2
 828              	.LVL54:
 829              		.loc 1 230 21 view .LVU266
 830 000e 40F06000 		orr	r0, r0, #96
 231:src/btphy/btphy.c **** 	case BT_MODE_MASTER:
 232:src/btphy/btphy.c **** 	case BT_MODE_SLAVE:
 233:src/btphy/btphy.c **** 		return (clk>>1)|0x40;
 234:src/btphy/btphy.c **** 	default:
 235:src/btphy/btphy.c **** 		DIE("Invalid rx mode %d\n", btphy.mode);
 236:src/btphy/btphy.c **** 	}
 237:src/btphy/btphy.c **** }
ARM GAS  /tmp/ccHmVI9k.s 			page 24


 831              		.loc 1 237 1 view .LVU267
 832 0012 08BD     		pop	{r3, pc}
 833              	.LVL55:
 834              	.L63:
 221:src/btphy/btphy.c **** 	{
 835              		.loc 1 221 2 view .LVU268
 836 0014 0B1F     		subs	r3, r1, #4
 837 0016 012B     		cmp	r3, #1
 838 0018 04D8     		bhi	.L64
 233:src/btphy/btphy.c **** 	default:
 839              		.loc 1 233 3 is_stmt 1 view .LVU269
 233:src/btphy/btphy.c **** 	default:
 840              		.loc 1 233 18 is_stmt 0 view .LVU270
 841 001a C0F34700 		ubfx	r0, r0, #1, #8
 842              	.LVL56:
 233:src/btphy/btphy.c **** 	default:
 843              		.loc 1 233 18 view .LVU271
 844 001e 40F04000 		orr	r0, r0, #64
 845              		.loc 1 237 1 view .LVU272
 846 0022 08BD     		pop	{r3, pc}
 847              	.LVL57:
 848              	.L64:
 235:src/btphy/btphy.c **** 	}
 849              		.loc 1 235 3 is_stmt 1 view .LVU273
 850 0024 0348     		ldr	r0, .L65+8
 851              	.LVL58:
 235:src/btphy/btphy.c **** 	}
 852              		.loc 1 235 3 is_stmt 0 view .LVU274
 853 0026 FFF7FEFF 		bl	die
 854              	.LVL59:
 855              	.L66:
 856 002a 00BF     		.align	2
 857              	.L65:
 858 002c 00000000 		.word	.LANCHOR0
 859 0030 00000000 		.word	hop_state
 860 0034 44000000 		.word	.LC4
 861              		.cfi_endproc
 862              	.LFE35:
 864              		.section	.text.btphy_set_mode,"ax",%progbits
 865              		.align	1
 866              		.p2align 2,,3
 867              		.global	btphy_set_mode
 868              		.syntax unified
 869              		.thumb
 870              		.thumb_func
 871              		.fpu softvfp
 873              	btphy_set_mode:
 874              	.LVL60:
 875              	.LFB36:
 238:src/btphy/btphy.c **** 
 239:src/btphy/btphy.c **** 
 240:src/btphy/btphy.c **** void btphy_set_mode(btphy_mode_t mode, uint32_t lap, uint8_t uap)
 241:src/btphy/btphy.c **** {
 876              		.loc 1 241 1 is_stmt 1 view -0
 877              		.cfi_startproc
 878              		@ args = 0, pretend = 0, frame = 0
 879              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /tmp/ccHmVI9k.s 			page 25


 880              		.loc 1 241 1 is_stmt 0 view .LVU276
 881 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 882              		.cfi_def_cfa_offset 32
 883              		.cfi_offset 3, -32
 884              		.cfi_offset 4, -28
 885              		.cfi_offset 5, -24
 886              		.cfi_offset 6, -20
 887              		.cfi_offset 7, -16
 888              		.cfi_offset 8, -12
 889              		.cfi_offset 9, -8
 890              		.cfi_offset 14, -4
 242:src/btphy/btphy.c **** 	uint64_t sw = btbb_gen_syncword(lap);
 891              		.loc 1 242 2 is_stmt 1 view .LVU277
 241:src/btphy/btphy.c **** 	uint64_t sw = btbb_gen_syncword(lap);
 892              		.loc 1 241 1 is_stmt 0 view .LVU278
 893 0004 8146     		mov	r9, r0
 894              		.loc 1 242 16 view .LVU279
 895 0006 0846     		mov	r0, r1
 896              	.LVL61:
 241:src/btphy/btphy.c **** 	uint64_t sw = btbb_gen_syncword(lap);
 897              		.loc 1 241 1 view .LVU280
 898 0008 9046     		mov	r8, r2
 899 000a 0F46     		mov	r7, r1
 900              		.loc 1 242 16 view .LVU281
 901 000c FFF7FEFF 		bl	btbb_gen_syncword
 902              	.LVL62:
 903              		.loc 1 242 16 view .LVU282
 904 0010 0446     		mov	r4, r0
 243:src/btphy/btphy.c **** 
 244:src/btphy/btphy.c **** 	btphy.chan_lap = lap;
 245:src/btphy/btphy.c **** 	btphy.chan_uap = uap;
 246:src/btphy/btphy.c **** 	btphy.chan_sw = sw;
 247:src/btphy/btphy.c **** 
 248:src/btphy/btphy.c **** 	btphy.chan_sw_lo[0] = 0xff&(sw>>0);
 249:src/btphy/btphy.c **** 	btphy.chan_sw_lo[1] = 0xff&(sw>>8);
 250:src/btphy/btphy.c **** 	btphy.chan_sw_lo[2] = 0xff&(sw>>16);
 251:src/btphy/btphy.c **** 	btphy.chan_sw_lo[3] = 0xff&(sw>>24);
 252:src/btphy/btphy.c **** 
 253:src/btphy/btphy.c **** 	btphy.chan_sw_hi[0] = 0xff&(sw>>32);
 254:src/btphy/btphy.c **** 	btphy.chan_sw_hi[1] = 0xff&(sw>>40);
 255:src/btphy/btphy.c **** 	btphy.chan_sw_hi[2] = 0xff&(sw>>48);
 256:src/btphy/btphy.c **** 	btphy.chan_sw_hi[3] = 0xff&(sw>>56);
 257:src/btphy/btphy.c **** 
 258:src/btphy/btphy.c **** 	btphy.chan_trailer = (btphy.chan_sw >> 63) ? 0x0a : 0x05;
 905              		.loc 1 258 21 view .LVU283
 906 0012 0028     		cmp	r0, #0
 242:src/btphy/btphy.c **** 
 907              		.loc 1 242 16 view .LVU284
 908 0014 0D46     		mov	r5, r1
 909              	.LVL63:
 244:src/btphy/btphy.c **** 	btphy.chan_uap = uap;
 910              		.loc 1 244 2 is_stmt 1 view .LVU285
 911              		.loc 1 258 21 is_stmt 0 view .LVU286
 912 0016 71F10003 		sbcs	r3, r1, #0
 913 001a B4BF     		ite	lt
 914 001c 4FF00A0C 		movlt	ip, #10
 915 0020 4FF0050C 		movge	ip, #5
ARM GAS  /tmp/ccHmVI9k.s 			page 26


 916              	.LBB72:
 917              	.LBB73:
 918              	.LBB74:
 919              	.LBB75:
 920              	.LBB76:
 921              	.LBB77:
 922              		.file 3 "include/ubtbr/bb.h"
   1:include/ubtbr/bb.h **** #ifndef __BB_H
   2:include/ubtbr/bb.h **** #define __BB_H
   3:include/ubtbr/bb.h **** #include <stdint.h>
   4:include/ubtbr/bb.h **** #include <ubertooth_interface.h>
   5:include/ubtbr/bb.h **** #include <ubtbr/cfg.h>
   6:include/ubtbr/bb.h **** #include <ubtbr/debug.h>
   7:include/ubtbr/bb.h **** 
   8:include/ubtbr/bb.h **** /* BLUETOOTH CORE SPECIFICATION Version 5.1 | Vol 2, Part B | Table 6.2 */
   9:include/ubtbr/bb.h **** enum bbhdr_type_e {
  10:include/ubtbr/bb.h **** 	BB_TYPE_NULL	= 0,
  11:include/ubtbr/bb.h **** 	BB_TYPE_POLL	= 1,
  12:include/ubtbr/bb.h **** 	BB_TYPE_FHS	= 2,
  13:include/ubtbr/bb.h **** 	BB_TYPE_DM1	= 3,
  14:include/ubtbr/bb.h **** 	BB_TYPE_DH1	= 4,
  15:include/ubtbr/bb.h **** 	BB_TYPE_HV1	= 5,
  16:include/ubtbr/bb.h **** 	BB_TYPE_HV2	= 6,
  17:include/ubtbr/bb.h **** 	BB_TYPE_HV3	= 7,
  18:include/ubtbr/bb.h **** 	BB_TYPE_DV	= 8,
  19:include/ubtbr/bb.h **** 	BB_TYPE_AUX1	= 9,
  20:include/ubtbr/bb.h **** 	BB_TYPE_DM3	= 10,
  21:include/ubtbr/bb.h **** 	BB_TYPE_DH3	= 11,
  22:include/ubtbr/bb.h **** 	BB_TYPE_EV4	= 12,
  23:include/ubtbr/bb.h **** 	BB_TYPE_EV5	= 13,
  24:include/ubtbr/bb.h **** 	BB_TYPE_DM5	= 14,
  25:include/ubtbr/bb.h **** 	BB_TYPE_DH5	= 15,
  26:include/ubtbr/bb.h **** };
  27:include/ubtbr/bb.h **** 
  28:include/ubtbr/bb.h **** typedef struct fhs_info_s {
  29:include/ubtbr/bb.h **** 	uint64_t bdaddr;
  30:include/ubtbr/bb.h **** 	uint32_t clk27_2;
  31:include/ubtbr/bb.h **** 	uint8_t lt_addr;
  32:include/ubtbr/bb.h **** } fhs_info_t;
  33:include/ubtbr/bb.h **** 
  34:include/ubtbr/bb.h **** /* All sizes are excluding the 4bit preamble, which
  35:include/ubtbr/bb.h ****  * is prepended to the packet by the cc2400 */
  36:include/ubtbr/bb.h **** #define BB_ACCESS_CODE_SIZE 		68
  37:include/ubtbr/bb.h **** #define BB_SHORT_ACCESS_CODE_SIZE 	64
  38:include/ubtbr/bb.h **** #define BB_FEC13_SIZE(n)		((n)*3)
  39:include/ubtbr/bb.h **** #define BB_FEC23_SIZE(n)		((n)*3/2)
  40:include/ubtbr/bb.h **** #define BB_HEADER_SIZE			BB_FEC13_SIZE(18)
  41:include/ubtbr/bb.h **** #define BB_FHS_PKT_SIZE 		(BB_ACCESS_CODE_SIZE+BB_HEADER_SIZE+BB_FEC23_SIZE(160))
  42:include/ubtbr/bb.h **** #define BB_POLL_PKT_SIZE 		(BB_ACCESS_CODE_SIZE+BB_HEADER_SIZE)
  43:include/ubtbr/bb.h **** 
  44:include/ubtbr/bb.h **** #define GIAC 0x9e8b33
  45:include/ubtbr/bb.h **** 
  46:include/ubtbr/bb.h **** /* Declare those helpers here, to be able to inline some functions */
  47:include/ubtbr/bb.h **** // Grab 6 bits from a buffer
  48:include/ubtbr/bb.h **** #define EXTRACT6_0(p)   ((((((uint8_t*)(p))[0])>>0)&0x3F))
  49:include/ubtbr/bb.h **** #define EXTRACT6_2(p)   ((((((uint8_t*)(p))[0])>>2)&0x3F))
  50:include/ubtbr/bb.h **** #define EXTRACT6_4(p)   ((((((uint8_t*)(p))[0])>>4))|(((((uint8_t*)(p))[1])&0x3)<<4))
ARM GAS  /tmp/ccHmVI9k.s 			page 27


  51:include/ubtbr/bb.h **** #define EXTRACT6_6(p)   ((((((uint8_t*)(p))[0])>>6))|(((((uint8_t*)(p))[1])&0xf)<<2))
  52:include/ubtbr/bb.h **** 
  53:include/ubtbr/bb.h **** // Grab 15 bits from a buffer
  54:include/ubtbr/bb.h **** #define EXTRACT15_0(p) ( ((((uint8_t*)(p))[0]     )   ) | ((((uint8_t*)(p))[1]&0x7f)<<8) )
  55:include/ubtbr/bb.h **** #define EXTRACT15_1(p) ( ((((uint8_t*)(p))[0]&0xfe)>>1) | ((((uint8_t*)(p))[1]     )<<7) )
  56:include/ubtbr/bb.h **** #define EXTRACT15_2(p) ( ((((uint8_t*)(p))[0]&0xfc)>>2) | ((((uint8_t*)(p))[1]     )<<6) | ((((uint
  57:include/ubtbr/bb.h **** #define EXTRACT15_3(p) ( ((((uint8_t*)(p))[0]&0xf8)>>3) | ((((uint8_t*)(p))[1]     )<<5) | ((((uint
  58:include/ubtbr/bb.h **** #define EXTRACT15_4(p) ( ((((uint8_t*)(p))[0]&0xf0)>>4) | ((((uint8_t*)(p))[1]     )<<4) | ((((uint
  59:include/ubtbr/bb.h **** #define EXTRACT15_5(p) ( ((((uint8_t*)(p))[0]&0xe0)>>5) | ((((uint8_t*)(p))[1]     )<<3) | ((((uint
  60:include/ubtbr/bb.h **** #define EXTRACT15_6(p) ( ((((uint8_t*)(p))[0]&0xc0)>>6) | ((((uint8_t*)(p))[1]     )<<2) | ((((uint
  61:include/ubtbr/bb.h **** #define EXTRACT15_7(p) ( ((((uint8_t*)(p))[0]&0x80)>>7) | ((((uint8_t*)(p))[1]     )<<1) | ((((uint
  62:include/ubtbr/bb.h **** 
  63:include/ubtbr/bb.h **** // Grab 10 bits from a buffer
  64:include/ubtbr/bb.h **** #define EXTRACT10_0(p) ( ((((uint8_t*)(p))[0])   ) | ((((uint8_t*)(p))[1]&0x03)<<8) )
  65:include/ubtbr/bb.h **** #define EXTRACT10_1(p) ( ((((uint8_t*)(p))[0])>>1) | ((((uint8_t*)(p))[1]&0x07)<<7) )
  66:include/ubtbr/bb.h **** #define EXTRACT10_2(p) ( ((((uint8_t*)(p))[0])>>2) | ((((uint8_t*)(p))[1]&0x0f)<<6) )
  67:include/ubtbr/bb.h **** #define EXTRACT10_3(p) ( ((((uint8_t*)(p))[0])>>3) | ((((uint8_t*)(p))[1]&0x1f)<<5) )
  68:include/ubtbr/bb.h **** #define EXTRACT10_4(p) ( ((((uint8_t*)(p))[0])>>4) | ((((uint8_t*)(p))[1]&0x3f)<<4) )
  69:include/ubtbr/bb.h **** #define EXTRACT10_5(p) ( ((((uint8_t*)(p))[0])>>5) | ((((uint8_t*)(p))[1]&0x7f)<<3) )
  70:include/ubtbr/bb.h **** #define EXTRACT10_6(p) ( ((((uint8_t*)(p))[0])>>6) | ((((uint8_t*)(p))[1]     )<<2) )
  71:include/ubtbr/bb.h **** #define EXTRACT10_7(p) ( ((((uint8_t*)(p))[0])>>7) | ((((uint8_t*)(p))[1]     )<<1) | ((((uint8_t*)
  72:include/ubtbr/bb.h **** 
  73:include/ubtbr/bb.h **** // Encode 10 bytes in buffer (warning: buffer must be zeroed)
  74:include/ubtbr/bb.h **** #define ENCODE15_0(p,val)  (((uint8_t*)(p))[0] =((val)   ),((uint8_t*)(p))[1]=((val)>>8))
  75:include/ubtbr/bb.h **** #define ENCODE15_1(p,val)  (((uint8_t*)(p))[0]|=((val)<<1),((uint8_t*)(p))[1]=((val)>>7))
  76:include/ubtbr/bb.h **** #define ENCODE15_2(p,val)  (((uint8_t*)(p))[0]|=((val)<<2),((uint8_t*)(p))[1]=((val)>>6),((uint8_t*
  77:include/ubtbr/bb.h **** #define ENCODE15_3(p,val)  (((uint8_t*)(p))[0]|=((val)<<3),((uint8_t*)(p))[1]=((val)>>5),((uint8_t*
  78:include/ubtbr/bb.h **** #define ENCODE15_4(p,val)  (((uint8_t*)(p))[0]|=((val)<<4),((uint8_t*)(p))[1]=((val)>>4),((uint8_t*
  79:include/ubtbr/bb.h **** #define ENCODE15_5(p,val)  (((uint8_t*)(p))[0]|=((val)<<5),((uint8_t*)(p))[1]=((val)>>3),((uint8_t*
  80:include/ubtbr/bb.h **** #define ENCODE15_6(p,val)  (((uint8_t*)(p))[0]|=((val)<<6),((uint8_t*)(p))[1]=((val)>>2),((uint8_t*
  81:include/ubtbr/bb.h **** #define ENCODE15_7(p,val)  (((uint8_t*)(p))[0]|=((val)<<7),((uint8_t*)(p))[1]=((val)>>1),((uint8_t*
  82:include/ubtbr/bb.h **** 
  83:include/ubtbr/bb.h **** // warning: buffer must be zeroed
  84:include/ubtbr/bb.h **** #define ENCODE10_0(p,val)  (((uint8_t*)(p))[0] =((val)   ),((uint8_t*)(p))[1]=((val)>>8))
  85:include/ubtbr/bb.h **** #define ENCODE10_1(p,val)  (((uint8_t*)(p))[0]|=((val)<<1),((uint8_t*)(p))[1]=((val)>>7))
  86:include/ubtbr/bb.h **** #define ENCODE10_2(p,val)  (((uint8_t*)(p))[0]|=((val)<<2),((uint8_t*)(p))[1]=((val)>>6))
  87:include/ubtbr/bb.h **** #define ENCODE10_3(p,val)  (((uint8_t*)(p))[0]|=((val)<<3),((uint8_t*)(p))[1]=((val)>>5))
  88:include/ubtbr/bb.h **** #define ENCODE10_4(p,val)  (((uint8_t*)(p))[0]|=((val)<<4),((uint8_t*)(p))[1]=((val)>>4))
  89:include/ubtbr/bb.h **** #define ENCODE10_5(p,val)  (((uint8_t*)(p))[0]|=((val)<<5),((uint8_t*)(p))[1]=((val)>>3))
  90:include/ubtbr/bb.h **** #define ENCODE10_6(p,val)  (((uint8_t*)(p))[0]|=((val)<<6),((uint8_t*)(p))[1]=((val)>>2))
  91:include/ubtbr/bb.h **** #define ENCODE10_7(p,val)  (((uint8_t*)(p))[0]|=((val)<<7),((uint8_t*)(p))[1]=((val)>>1),((uint8_t*
  92:include/ubtbr/bb.h **** 
  93:include/ubtbr/bb.h **** #define ENCODE24_0(p,val)  (((uint8_t*)(p))[0] =((val)   ),((uint8_t*)(p))[1]=(val)>>8,((uint8_t*)(
  94:include/ubtbr/bb.h **** #define ENCODE24_2(p,val)  (((uint8_t*)(p))[0]|=((val)<<2),((uint8_t*)(p))[1]=(val)>>6,((uint8_t*)(
  95:include/ubtbr/bb.h **** #define ENCODE24_4(p,val)  (((uint8_t*)(p))[0]|=((val)<<4),((uint8_t*)(p))[1]=(val)>>4,((uint8_t*)(
  96:include/ubtbr/bb.h **** #define ENCODE24_6(p,val)  (((uint8_t*)(p))[0]|=((val)<<6),((uint8_t*)(p))[1]=(val)>>2,((uint8_t*)(
  97:include/ubtbr/bb.h **** 
  98:include/ubtbr/bb.h **** #define BYTE_ALIGN(nbits)	(((nbits)+7)>>3)
  99:include/ubtbr/bb.h **** 
 100:include/ubtbr/bb.h **** static inline uint8_t reverse8(uint8_t data)
 101:include/ubtbr/bb.h **** {
 102:include/ubtbr/bb.h **** 	extern const uint8_t rev8_map[256];
 103:include/ubtbr/bb.h ****         return rev8_map[data];
 923              		.loc 3 103 24 view .LVU287
 924 0024 1C4B     		ldr	r3, .L70
 925              	.LBE77:
 926              	.LBE76:
ARM GAS  /tmp/ccHmVI9k.s 			page 28


 927              	.LBE75:
 928              	.LBE74:
 929              	.LBE73:
 930              	.LBE72:
 250:src/btphy/btphy.c **** 	btphy.chan_sw_lo[3] = 0xff&(sw>>24);
 931              		.loc 1 250 32 view .LVU288
 932 0026 020C     		lsrs	r2, r0, #16
 933              	.LBB112:
 934              	.LBB110:
 935              	.LBB90:
 936              	.LBB91:
 937              	.LBB92:
 938              	.LBB93:
 939              		.loc 3 103 24 view .LVU289
 940 0028 D6B2     		uxtb	r6, r2
 941              	.LBE93:
 942              	.LBE92:
 943              	.LBE91:
 944              	.LBE90:
 945              	.LBB103:
 946              	.LBB86:
 947              	.LBB80:
 948              	.LBB78:
 949 002a E1B2     		uxtb	r1, r4
 950              	.LBE78:
 951              	.LBE80:
 952              	.LBE86:
 953              	.LBE103:
 954              	.LBB104:
 955              	.LBB100:
 104:include/ubtbr/bb.h **** }
 105:include/ubtbr/bb.h **** static inline uint16_t reverse16(uint16_t data)
 106:include/ubtbr/bb.h **** {
 107:include/ubtbr/bb.h ****         return (uint16_t)reverse8(data>>8) | (uint16_t)(reverse8(data&0xff)<<8);
 956              		.loc 3 107 57 view .LVU290
 957 002c 13F806E0 		ldrb	lr, [r3, r6]	@ zero_extendqisi2
 958              	.LBB95:
 959              	.LBB96:
 103:include/ubtbr/bb.h **** }
 960              		.loc 3 103 24 view .LVU291
 961 0030 100A     		lsrs	r0, r2, #8
 962              	.LBE96:
 963              	.LBE95:
 964              	.LBE100:
 965              	.LBE104:
 966              	.LBB105:
 967              	.LBB87:
 968              		.loc 3 107 57 view .LVU292
 969 0032 5E5C     		ldrb	r6, [r3, r1]	@ zero_extendqisi2
 970              	.LBB81:
 971              	.LBB82:
 103:include/ubtbr/bb.h **** }
 972              		.loc 3 103 24 view .LVU293
 973 0034 C4F30721 		ubfx	r1, r4, #8, #8
 974              	.LBE82:
 975              	.LBE81:
 976              	.LBE87:
ARM GAS  /tmp/ccHmVI9k.s 			page 29


 977              	.LBE105:
 978              	.LBB106:
 979              	.LBB101:
 980              		.loc 3 107 26 view .LVU294
 981 0038 185C     		ldrb	r0, [r3, r0]	@ zero_extendqisi2
 982              	.LBE101:
 983              	.LBE106:
 984              	.LBB107:
 985              	.LBB88:
 986 003a 595C     		ldrb	r1, [r3, r1]	@ zero_extendqisi2
 987              	.LBE88:
 988              	.LBE107:
 108:include/ubtbr/bb.h **** }
 109:include/ubtbr/bb.h **** static inline uint32_t reverse32(uint32_t data)
 110:include/ubtbr/bb.h **** {
 111:include/ubtbr/bb.h ****         return (uint32_t)reverse16(data>>16)|((uint32_t)reverse16(data&0xffff)<<16);
 989              		.loc 3 111 16 view .LVU295
 990 003c 40EA0E2E 		orr	lr, r0, lr, lsl #8
 991              		.loc 3 111 47 view .LVU296
 992 0040 41EA0620 		orr	r0, r1, r6, lsl #8
 993              	.LBE110:
 994              	.LBE112:
 244:src/btphy/btphy.c **** 	btphy.chan_uap = uap;
 995              		.loc 1 244 17 view .LVU297
 996 0044 154E     		ldr	r6, .L70+4
 249:src/btphy/btphy.c **** 	btphy.chan_sw_lo[2] = 0xff&(sw>>16);
 997              		.loc 1 249 32 view .LVU298
 998 0046 230A     		lsrs	r3, r4, #8
 259:src/btphy/btphy.c **** 	btphy_rf_cfg_sync(reverse32(btphy.chan_sw & 0xffffffff));
 999              		.loc 1 259 2 view .LVU299
 1000 0048 4EEA0040 		orr	r0, lr, r0, lsl #16
 254:src/btphy/btphy.c **** 	btphy.chan_sw_hi[2] = 0xff&(sw>>48);
 1001              		.loc 1 254 32 view .LVU300
 1002 004c 290A     		lsrs	r1, r5, #8
 251:src/btphy/btphy.c **** 
 1003              		.loc 1 251 32 view .LVU301
 1004 004e 4FEA146E 		lsr	lr, r4, #24
 250:src/btphy/btphy.c **** 	btphy.chan_sw_lo[3] = 0xff&(sw>>24);
 1005              		.loc 1 250 22 view .LVU302
 1006 0052 86F82B20 		strb	r2, [r6, #43]
 249:src/btphy/btphy.c **** 	btphy.chan_sw_lo[2] = 0xff&(sw>>16);
 1007              		.loc 1 249 22 view .LVU303
 1008 0056 86F82A30 		strb	r3, [r6, #42]
 255:src/btphy/btphy.c **** 	btphy.chan_sw_hi[3] = 0xff&(sw>>56);
 1009              		.loc 1 255 32 view .LVU304
 1010 005a 2A0C     		lsrs	r2, r5, #16
 256:src/btphy/btphy.c **** 
 1011              		.loc 1 256 28 view .LVU305
 1012 005c 2B0E     		lsrs	r3, r5, #24
 251:src/btphy/btphy.c **** 
 1013              		.loc 1 251 22 view .LVU306
 1014 005e 86F82CE0 		strb	lr, [r6, #44]
 254:src/btphy/btphy.c **** 	btphy.chan_sw_hi[2] = 0xff&(sw>>48);
 1015              		.loc 1 254 22 view .LVU307
 1016 0062 86F82E10 		strb	r1, [r6, #46]
 255:src/btphy/btphy.c **** 	btphy.chan_sw_hi[3] = 0xff&(sw>>56);
 1017              		.loc 1 255 22 view .LVU308
ARM GAS  /tmp/ccHmVI9k.s 			page 30


 1018 0066 86F82F20 		strb	r2, [r6, #47]
 256:src/btphy/btphy.c **** 
 1019              		.loc 1 256 22 view .LVU309
 1020 006a 86F83030 		strb	r3, [r6, #48]
 258:src/btphy/btphy.c **** 	btphy_rf_cfg_sync(reverse32(btphy.chan_sw & 0xffffffff));
 1021              		.loc 1 258 21 view .LVU310
 1022 006e 86F828C0 		strb	ip, [r6, #40]
 246:src/btphy/btphy.c **** 
 1023              		.loc 1 246 16 view .LVU311
 1024 0072 C6E90845 		strd	r4, [r6, #32]
 244:src/btphy/btphy.c **** 	btphy.chan_uap = uap;
 1025              		.loc 1 244 17 view .LVU312
 1026 0076 7761     		str	r7, [r6, #20]
 245:src/btphy/btphy.c **** 	btphy.chan_sw = sw;
 1027              		.loc 1 245 2 is_stmt 1 view .LVU313
 245:src/btphy/btphy.c **** 	btphy.chan_sw = sw;
 1028              		.loc 1 245 17 is_stmt 0 view .LVU314
 1029 0078 86F81880 		strb	r8, [r6, #24]
 246:src/btphy/btphy.c **** 
 1030              		.loc 1 246 2 is_stmt 1 view .LVU315
 248:src/btphy/btphy.c **** 	btphy.chan_sw_lo[1] = 0xff&(sw>>8);
 1031              		.loc 1 248 2 view .LVU316
 248:src/btphy/btphy.c **** 	btphy.chan_sw_lo[1] = 0xff&(sw>>8);
 1032              		.loc 1 248 22 is_stmt 0 view .LVU317
 1033 007c 86F82940 		strb	r4, [r6, #41]
 249:src/btphy/btphy.c **** 	btphy.chan_sw_lo[2] = 0xff&(sw>>16);
 1034              		.loc 1 249 2 is_stmt 1 view .LVU318
 250:src/btphy/btphy.c **** 	btphy.chan_sw_lo[3] = 0xff&(sw>>24);
 1035              		.loc 1 250 2 view .LVU319
 251:src/btphy/btphy.c **** 
 1036              		.loc 1 251 2 view .LVU320
 253:src/btphy/btphy.c **** 	btphy.chan_sw_hi[1] = 0xff&(sw>>40);
 1037              		.loc 1 253 2 view .LVU321
 254:src/btphy/btphy.c **** 	btphy.chan_sw_hi[2] = 0xff&(sw>>48);
 1038              		.loc 1 254 2 view .LVU322
 255:src/btphy/btphy.c **** 	btphy.chan_sw_hi[3] = 0xff&(sw>>56);
 1039              		.loc 1 255 2 view .LVU323
 256:src/btphy/btphy.c **** 
 1040              		.loc 1 256 2 view .LVU324
 258:src/btphy/btphy.c **** 	btphy_rf_cfg_sync(reverse32(btphy.chan_sw & 0xffffffff));
 1041              		.loc 1 258 2 view .LVU325
 1042              		.loc 1 259 2 view .LVU326
 1043              	.LVL64:
 1044              	.LBB113:
 1045              	.LBI72:
 109:include/ubtbr/bb.h **** {
 1046              		.loc 3 109 24 view .LVU327
 1047              	.LBB111:
 1048              		.loc 3 111 9 view .LVU328
 1049              	.LBB108:
 1050              	.LBI90:
 105:include/ubtbr/bb.h **** {
 1051              		.loc 3 105 24 view .LVU329
 1052              	.LBB102:
 107:include/ubtbr/bb.h **** }
 1053              		.loc 3 107 9 view .LVU330
 1054              	.LBB98:
ARM GAS  /tmp/ccHmVI9k.s 			page 31


 1055              	.LBI95:
 100:include/ubtbr/bb.h **** {
 1056              		.loc 3 100 23 view .LVU331
 1057              	.LBB97:
 102:include/ubtbr/bb.h ****         return rev8_map[data];
 1058              		.loc 3 102 2 view .LVU332
 103:include/ubtbr/bb.h **** }
 1059              		.loc 3 103 9 view .LVU333
 103:include/ubtbr/bb.h **** }
 1060              		.loc 3 103 9 is_stmt 0 view .LVU334
 1061              	.LBE97:
 1062              	.LBE98:
 1063              	.LBB99:
 1064              	.LBI92:
 100:include/ubtbr/bb.h **** {
 1065              		.loc 3 100 23 is_stmt 1 view .LVU335
 1066              	.LBB94:
 102:include/ubtbr/bb.h ****         return rev8_map[data];
 1067              		.loc 3 102 2 view .LVU336
 103:include/ubtbr/bb.h **** }
 1068              		.loc 3 103 9 view .LVU337
 103:include/ubtbr/bb.h **** }
 1069              		.loc 3 103 9 is_stmt 0 view .LVU338
 1070              	.LBE94:
 1071              	.LBE99:
 1072              	.LBE102:
 1073              	.LBE108:
 1074              	.LBB109:
 1075              	.LBI74:
 105:include/ubtbr/bb.h **** {
 1076              		.loc 3 105 24 is_stmt 1 view .LVU339
 1077              	.LBB89:
 107:include/ubtbr/bb.h **** }
 1078              		.loc 3 107 9 view .LVU340
 1079              	.LBB84:
 1080              	.LBI81:
 100:include/ubtbr/bb.h **** {
 1081              		.loc 3 100 23 view .LVU341
 1082              	.LBB83:
 102:include/ubtbr/bb.h ****         return rev8_map[data];
 1083              		.loc 3 102 2 view .LVU342
 103:include/ubtbr/bb.h **** }
 1084              		.loc 3 103 9 view .LVU343
 103:include/ubtbr/bb.h **** }
 1085              		.loc 3 103 9 is_stmt 0 view .LVU344
 1086              	.LBE83:
 1087              	.LBE84:
 1088              	.LBB85:
 1089              	.LBI76:
 100:include/ubtbr/bb.h **** {
 1090              		.loc 3 100 23 is_stmt 1 view .LVU345
 1091              	.LBB79:
 102:include/ubtbr/bb.h ****         return rev8_map[data];
 1092              		.loc 3 102 2 view .LVU346
 103:include/ubtbr/bb.h **** }
 1093              		.loc 3 103 9 view .LVU347
 103:include/ubtbr/bb.h **** }
ARM GAS  /tmp/ccHmVI9k.s 			page 32


 1094              		.loc 3 103 9 is_stmt 0 view .LVU348
 1095              	.LBE79:
 1096              	.LBE85:
 1097              	.LBE89:
 1098              	.LBE109:
 1099              	.LBE111:
 1100              	.LBE113:
 253:src/btphy/btphy.c **** 	btphy.chan_sw_hi[1] = 0xff&(sw>>40);
 1101              		.loc 1 253 22 view .LVU349
 1102 0080 86F82D50 		strb	r5, [r6, #45]
 1103              		.loc 1 259 2 view .LVU350
 1104 0084 FFF7FEFF 		bl	btphy_rf_cfg_sync
 1105              	.LVL65:
 260:src/btphy/btphy.c **** 	/* BT Core Spec v5.2|Vol 2, Part B, table 2.3:
 261:src/btphy/btphy.c **** 	 * A23_0=lap, and A27_24=uap3_0 */
 262:src/btphy/btphy.c **** 	hop_init(lap|(uap<<24));
 1106              		.loc 1 262 2 is_stmt 1 view .LVU351
 1107 0088 47EA0860 		orr	r0, r7, r8, lsl #24
 1108 008c FFF7FEFF 		bl	hop_init
 1109              	.LVL66:
 263:src/btphy/btphy.c **** 	btphy.mode = mode;
 1110              		.loc 1 263 2 view .LVU352
 1111              		.loc 1 263 13 is_stmt 0 view .LVU353
 1112 0090 86F80090 		strb	r9, [r6]
 264:src/btphy/btphy.c **** }
 1113              		.loc 1 264 1 view .LVU354
 1114 0094 BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 1115              	.LVL67:
 1116              	.L71:
 1117              		.loc 1 264 1 view .LVU355
 1118              		.align	2
 1119              	.L70:
 1120 0098 00000000 		.word	rev8_map
 1121 009c 00000000 		.word	.LANCHOR0
 1122              		.cfi_endproc
 1123              	.LFE36:
 1125              		.section	.rodata.str1.4
 1126 005d 000000   		.align	2
 1127              	.LC5:
 1128 0060 53657420 		.ascii	"Set bdaddr %llx -> sw %llx\012\000"
 1128      62646164 
 1128      64722025 
 1128      6C6C7820 
 1128      2D3E2073 
 1129              		.section	.text.btphy_set_bdaddr,"ax",%progbits
 1130              		.align	1
 1131              		.p2align 2,,3
 1132              		.global	btphy_set_bdaddr
 1133              		.syntax unified
 1134              		.thumb
 1135              		.thumb_func
 1136              		.fpu softvfp
 1138              	btphy_set_bdaddr:
 1139              	.LVL68:
 1140              	.LFB37:
 265:src/btphy/btphy.c **** 
 266:src/btphy/btphy.c **** void btphy_set_bdaddr(uint64_t bdaddr)
ARM GAS  /tmp/ccHmVI9k.s 			page 33


 267:src/btphy/btphy.c **** {
 1141              		.loc 1 267 1 is_stmt 1 view -0
 1142              		.cfi_startproc
 1143              		@ args = 0, pretend = 0, frame = 0
 1144              		@ frame_needed = 0, uses_anonymous_args = 0
 1145              		.loc 1 267 1 is_stmt 0 view .LVU357
 1146 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 1147              		.cfi_def_cfa_offset 20
 1148              		.cfi_offset 4, -20
 1149              		.cfi_offset 5, -16
 1150              		.cfi_offset 6, -12
 1151              		.cfi_offset 7, -8
 1152              		.cfi_offset 14, -4
 1153 0002 83B0     		sub	sp, sp, #12
 1154              		.cfi_def_cfa_offset 32
 268:src/btphy/btphy.c **** 	btphy.my_lap = 0xffffff & bdaddr;
 1155              		.loc 1 268 2 is_stmt 1 view .LVU358
 267:src/btphy/btphy.c **** 	btphy.my_lap = 0xffffff & bdaddr;
 1156              		.loc 1 267 1 is_stmt 0 view .LVU359
 1157 0004 0546     		mov	r5, r0
 1158              		.loc 1 268 15 view .LVU360
 1159 0006 0B4C     		ldr	r4, .L73
 269:src/btphy/btphy.c **** 	btphy.my_uap = 0xff & (bdaddr>>24);
 1160              		.loc 1 269 31 view .LVU361
 1161 0008 2B0E     		lsrs	r3, r5, #24
 268:src/btphy/btphy.c **** 	btphy.my_lap = 0xffffff & bdaddr;
 1162              		.loc 1 268 26 view .LVU362
 1163 000a 20F07F40 		bic	r0, r0, #-16777216
 1164              	.LVL69:
 267:src/btphy/btphy.c **** 	btphy.my_lap = 0xffffff & bdaddr;
 1165              		.loc 1 267 1 view .LVU363
 1166 000e 0F46     		mov	r7, r1
 1167              		.loc 1 269 15 view .LVU364
 1168 0010 84F83830 		strb	r3, [r4, #56]
 268:src/btphy/btphy.c **** 	btphy.my_lap = 0xffffff & bdaddr;
 1169              		.loc 1 268 15 view .LVU365
 1170 0014 6063     		str	r0, [r4, #52]
 1171              		.loc 1 269 2 is_stmt 1 view .LVU366
 270:src/btphy/btphy.c **** 	btphy.my_nap = 0xffff & (bdaddr>>32);
 1172              		.loc 1 270 2 view .LVU367
 271:src/btphy/btphy.c **** 	btphy.my_sw = btbb_gen_syncword(btphy.my_lap);
 1173              		.loc 1 271 2 view .LVU368
 270:src/btphy/btphy.c **** 	btphy.my_nap = 0xffff & (bdaddr>>32);
 1174              		.loc 1 270 15 is_stmt 0 view .LVU369
 1175 0016 6187     		strh	r1, [r4, #58]	@ movhi
 1176              		.loc 1 271 16 view .LVU370
 1177 0018 FFF7FEFF 		bl	btbb_gen_syncword
 1178              	.LVL70:
 1179 001c 0646     		mov	r6, r0
 272:src/btphy/btphy.c **** 	cprintf("Set bdaddr %llx -> sw %llx\n", bdaddr, btphy.my_sw);
 1180              		.loc 1 272 2 view .LVU371
 1181 001e CDE90001 		strd	r0, r1, [sp]
 1182 0022 2A46     		mov	r2, r5
 1183 0024 3B46     		mov	r3, r7
 1184 0026 0448     		ldr	r0, .L73+4
 271:src/btphy/btphy.c **** 	btphy.my_sw = btbb_gen_syncword(btphy.my_lap);
 1185              		.loc 1 271 14 view .LVU372
ARM GAS  /tmp/ccHmVI9k.s 			page 34


 1186 0028 C4E91061 		strd	r6, r1, [r4, #64]
 1187              		.loc 1 272 2 is_stmt 1 view .LVU373
 1188 002c FFF7FEFF 		bl	cprintf
 1189              	.LVL71:
 273:src/btphy/btphy.c **** }
 1190              		.loc 1 273 1 is_stmt 0 view .LVU374
 1191 0030 03B0     		add	sp, sp, #12
 1192              		.cfi_def_cfa_offset 20
 1193              		@ sp needed
 1194 0032 F0BD     		pop	{r4, r5, r6, r7, pc}
 1195              	.L74:
 1196              		.align	2
 1197              	.L73:
 1198 0034 00000000 		.word	.LANCHOR0
 1199 0038 60000000 		.word	.LC5
 1200              		.cfi_endproc
 1201              	.LFE37:
 1203              		.section	.text.btphy_init,"ax",%progbits
 1204              		.align	1
 1205              		.p2align 2,,3
 1206              		.global	btphy_init
 1207              		.syntax unified
 1208              		.thumb
 1209              		.thumb_func
 1210              		.fpu softvfp
 1212              	btphy_init:
 1213              	.LFB38:
 274:src/btphy/btphy.c **** 
 275:src/btphy/btphy.c **** void btphy_init(void)
 276:src/btphy/btphy.c **** {
 1214              		.loc 1 276 1 is_stmt 1 view -0
 1215              		.cfi_startproc
 1216              		@ args = 0, pretend = 0, frame = 0
 1217              		@ frame_needed = 0, uses_anonymous_args = 0
 1218 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1219              		.cfi_def_cfa_offset 24
 1220              		.cfi_offset 4, -24
 1221              		.cfi_offset 5, -20
 1222              		.cfi_offset 6, -16
 1223              		.cfi_offset 7, -12
 1224              		.cfi_offset 8, -8
 1225              		.cfi_offset 14, -4
 1226 0004 82B0     		sub	sp, sp, #8
 1227              		.cfi_def_cfa_offset 32
 277:src/btphy/btphy.c **** 	tdma_sched_reset();
 1228              		.loc 1 277 2 view .LVU376
 1229 0006 FFF7FEFF 		bl	tdma_sched_reset
 1230              	.LVL72:
 278:src/btphy/btphy.c **** 
 279:src/btphy/btphy.c **** 	/* Start timers */
 280:src/btphy/btphy.c **** 	clkn_start();
 1231              		.loc 1 280 2 view .LVU377
 1232              	.LBB120:
 1233              	.LBI120:
 181:src/btphy/btphy.c **** {
 1234              		.loc 1 181 6 view .LVU378
 1235              	.LBB121:
ARM GAS  /tmp/ccHmVI9k.s 			page 35


 183:src/btphy/btphy.c **** 
 1236              		.loc 1 183 2 view .LVU379
 186:src/btphy/btphy.c **** 	ICER0 = ICER0_ICE_TIMER1;
 1237              		.loc 1 186 2 view .LVU380
 187:src/btphy/btphy.c **** 	
 1238              		.loc 1 187 8 is_stmt 0 view .LVU381
 1239 000a 0425     		movs	r5, #4
 186:src/btphy/btphy.c **** 	ICER0 = ICER0_ICE_TIMER1;
 1240              		.loc 1 186 8 view .LVU382
 1241 000c 0223     		movs	r3, #2
 190:src/btphy/btphy.c **** 	T1TCR = 0;
 1242              		.loc 1 190 8 view .LVU383
 1243 000e 0024     		movs	r4, #0
 199:src/btphy/btphy.c **** 
 1244              		.loc 1 199 8 view .LVU384
 1245 0010 4FF0030E 		mov	lr, #3
 197:src/btphy/btphy.c **** 	/* Match control register: Reset TC, trigger interrupt. */
 1246              		.loc 1 197 8 view .LVU385
 1247 0014 40F63448 		movw	r8, #3124
 203:src/btphy/btphy.c **** 	/* Match register 0: nothing */
 1248              		.loc 1 203 7 view .LVU386
 1249 0018 43F6085C 		movw	ip, #15624
 205:src/btphy/btphy.c **** 	/* Match control register: Reset TC, no interrupt . */
 1250              		.loc 1 205 8 view .LVU387
 1251 001c 6FF00107 		mvn	r7, #1
 213:src/btphy/btphy.c **** 	T0TCR = 1;
 1252              		.loc 1 213 8 view .LVU388
 1253 0020 0121     		movs	r1, #1
 186:src/btphy/btphy.c **** 	ICER0 = ICER0_ICE_TIMER1;
 1254              		.loc 1 186 8 view .LVU389
 1255 0022 294E     		ldr	r6, .L76+8
 190:src/btphy/btphy.c **** 	T1TCR = 0;
 1256              		.loc 1 190 8 view .LVU390
 1257 0024 294A     		ldr	r2, .L76+12
 186:src/btphy/btphy.c **** 	ICER0 = ICER0_ICE_TIMER1;
 1258              		.loc 1 186 8 view .LVU391
 1259 0026 3360     		str	r3, [r6]
 187:src/btphy/btphy.c **** 	
 1260              		.loc 1 187 2 is_stmt 1 view .LVU392
 191:src/btphy/btphy.c **** 	btphy.master_clkn = 0;
 1261              		.loc 1 191 8 is_stmt 0 view .LVU393
 1262 0028 2948     		ldr	r0, .L76+16
 187:src/btphy/btphy.c **** 	
 1263              		.loc 1 187 8 view .LVU394
 1264 002a 3560     		str	r5, [r6]
 190:src/btphy/btphy.c **** 	T1TCR = 0;
 1265              		.loc 1 190 2 is_stmt 1 view .LVU395
 195:src/btphy/btphy.c **** 	/* Match register 0: CLKN_RATE */
 1266              		.loc 1 195 7 is_stmt 0 view .LVU396
 1267 002c 294E     		ldr	r6, .L76+20
 190:src/btphy/btphy.c **** 	T1TCR = 0;
 1268              		.loc 1 190 8 view .LVU397
 1269 002e 1460     		str	r4, [r2]
 191:src/btphy/btphy.c **** 	btphy.master_clkn = 0;
 1270              		.loc 1 191 2 is_stmt 1 view .LVU398
 191:src/btphy/btphy.c **** 	btphy.master_clkn = 0;
 1271              		.loc 1 191 8 is_stmt 0 view .LVU399
ARM GAS  /tmp/ccHmVI9k.s 			page 36


 1272 0030 0460     		str	r4, [r0]
 192:src/btphy/btphy.c **** 
 1273              		.loc 1 192 2 is_stmt 1 view .LVU400
 195:src/btphy/btphy.c **** 	/* Match register 0: CLKN_RATE */
 1274              		.loc 1 195 7 is_stmt 0 view .LVU401
 1275 0032 3560     		str	r5, [r6]
 197:src/btphy/btphy.c **** 	/* Match control register: Reset TC, trigger interrupt. */
 1276              		.loc 1 197 8 view .LVU402
 1277 0034 284D     		ldr	r5, .L76+24
 205:src/btphy/btphy.c **** 	/* Match control register: Reset TC, no interrupt . */
 1278              		.loc 1 205 8 view .LVU403
 1279 0036 06F58046 		add	r6, r6, #16384
 197:src/btphy/btphy.c **** 	/* Match control register: Reset TC, trigger interrupt. */
 1280              		.loc 1 197 8 view .LVU404
 1281 003a C5F80080 		str	r8, [r5]
 199:src/btphy/btphy.c **** 
 1282              		.loc 1 199 8 view .LVU405
 1283 003e 45F804EC 		str	lr, [r5, #-4]
 203:src/btphy/btphy.c **** 	/* Match register 0: nothing */
 1284              		.loc 1 203 7 view .LVU406
 1285 0042 05F57F55 		add	r5, r5, #16320
 205:src/btphy/btphy.c **** 	/* Match control register: Reset TC, no interrupt . */
 1286              		.loc 1 205 8 view .LVU407
 1287 0046 0C36     		adds	r6, r6, #12
 203:src/btphy/btphy.c **** 	/* Match register 0: nothing */
 1288              		.loc 1 203 7 view .LVU408
 1289 0048 C5F834C0 		str	ip, [r5, #52]
 205:src/btphy/btphy.c **** 	/* Match control register: Reset TC, no interrupt . */
 1290              		.loc 1 205 8 view .LVU409
 1291 004c 3760     		str	r7, [r6]
 210:src/btphy/btphy.c **** 
 1292              		.loc 1 210 8 view .LVU410
 1293 004e 234E     		ldr	r6, .L76+28
 207:src/btphy/btphy.c **** 
 1294              		.loc 1 207 8 view .LVU411
 1295 0050 EB63     		str	r3, [r5, #60]
 203:src/btphy/btphy.c **** 	/* Match register 0: nothing */
 1296              		.loc 1 203 7 view .LVU412
 1297 0052 3435     		adds	r5, r5, #52
 192:src/btphy/btphy.c **** 
 1298              		.loc 1 192 20 view .LVU413
 1299 0054 224D     		ldr	r5, .L76+32
 210:src/btphy/btphy.c **** 
 1300              		.loc 1 210 8 view .LVU414
 1301 0056 3360     		str	r3, [r6]
 213:src/btphy/btphy.c **** 	T0TCR = 1;
 1302              		.loc 1 213 8 view .LVU415
 1303 0058 0160     		str	r1, [r0]
 214:src/btphy/btphy.c **** }
 1304              		.loc 1 214 8 view .LVU416
 1305 005a 1160     		str	r1, [r2]
 1306              	.LBE121:
 1307              	.LBE120:
 281:src/btphy/btphy.c **** 
 282:src/btphy/btphy.c **** 	/* Initialize RF */
 283:src/btphy/btphy.c **** 	btphy_rf_init();
 284:src/btphy/btphy.c **** 
ARM GAS  /tmp/ccHmVI9k.s 			page 37


 285:src/btphy/btphy.c **** 	tx_task_reset();
 286:src/btphy/btphy.c **** 	rx_task_reset();
 287:src/btphy/btphy.c **** 
 288:src/btphy/btphy.c **** 	btphy.chan_sw = 0;
 1308              		.loc 1 288 16 view .LVU417
 1309 005c 0026     		movs	r6, #0
 1310              	.LBB123:
 1311              	.LBB122:
 192:src/btphy/btphy.c **** 
 1312              		.loc 1 192 20 view .LVU418
 1313 005e 6C60     		str	r4, [r5, #4]
 195:src/btphy/btphy.c **** 	/* Match register 0: CLKN_RATE */
 1314              		.loc 1 195 2 is_stmt 1 view .LVU419
 197:src/btphy/btphy.c **** 	/* Match control register: Reset TC, trigger interrupt. */
 1315              		.loc 1 197 2 view .LVU420
 199:src/btphy/btphy.c **** 
 1316              		.loc 1 199 2 view .LVU421
 203:src/btphy/btphy.c **** 	/* Match register 0: nothing */
 1317              		.loc 1 203 2 view .LVU422
 205:src/btphy/btphy.c **** 	/* Match control register: Reset TC, no interrupt . */
 1318              		.loc 1 205 2 view .LVU423
 207:src/btphy/btphy.c **** 
 1319              		.loc 1 207 2 view .LVU424
 210:src/btphy/btphy.c **** 
 1320              		.loc 1 210 2 view .LVU425
 213:src/btphy/btphy.c **** 	T0TCR = 1;
 1321              		.loc 1 213 2 view .LVU426
 214:src/btphy/btphy.c **** }
 1322              		.loc 1 214 2 view .LVU427
 1323              	.LBE122:
 1324              	.LBE123:
 283:src/btphy/btphy.c **** 
 1325              		.loc 1 283 2 view .LVU428
 1326              		.loc 1 288 16 is_stmt 0 view .LVU429
 1327 0060 0027     		movs	r7, #0
 283:src/btphy/btphy.c **** 
 1328              		.loc 1 283 2 view .LVU430
 1329 0062 FFF7FEFF 		bl	btphy_rf_init
 1330              	.LVL73:
 285:src/btphy/btphy.c **** 	rx_task_reset();
 1331              		.loc 1 285 2 is_stmt 1 view .LVU431
 1332 0066 FFF7FEFF 		bl	tx_task_reset
 1333              	.LVL74:
 286:src/btphy/btphy.c **** 
 1334              		.loc 1 286 2 view .LVU432
 1335 006a FFF7FEFF 		bl	rx_task_reset
 1336              	.LVL75:
 1337              		.loc 1 288 2 view .LVU433
 1338              	.LBB124:
 1339              	.LBB125:
 270:src/btphy/btphy.c **** 	btphy.my_sw = btbb_gen_syncword(btphy.my_lap);
 1340              		.loc 1 270 15 is_stmt 0 view .LVU434
 1341 006e 41F22212 		movw	r2, #4386
 269:src/btphy/btphy.c **** 	btphy.my_nap = 0xffff & (bdaddr>>32);
 1342              		.loc 1 269 15 view .LVU435
 1343 0072 3321     		movs	r1, #51
 1344              	.LBE125:
ARM GAS  /tmp/ccHmVI9k.s 			page 38


 1345              	.LBE124:
 1346              	.LBB129:
 1347              	.LBB130:
  59:src/btphy/btphy.c **** 	for(i=0;i<BTPHY_TIMER_COUNT;i++)
 1348              		.loc 1 59 21 view .LVU436
 1349 0074 1B4B     		ldr	r3, .L76+36
 1350              	.LBE130:
 1351              	.LBE129:
 1352              	.LBB134:
 1353              	.LBB126:
 268:src/btphy/btphy.c **** 	btphy.my_uap = 0xff & (bdaddr>>24);
 1354              		.loc 1 268 15 view .LVU437
 1355 0076 1C48     		ldr	r0, .L76+40
 1356              	.LBE126:
 1357              	.LBE134:
 1358              	.LBB135:
 1359              	.LBB131:
  61:src/btphy/btphy.c **** }
 1360              		.loc 1 61 29 view .LVU438
 1361 0078 9C60     		str	r4, [r3, #8]
 1362 007a 9C61     		str	r4, [r3, #24]
 1363 007c 9C62     		str	r4, [r3, #40]
 1364 007e 9C63     		str	r4, [r3, #56]
 1365 0080 9C64     		str	r4, [r3, #72]
 1366 0082 9C65     		str	r4, [r3, #88]
 1367 0084 9C66     		str	r4, [r3, #104]
 1368 0086 9C67     		str	r4, [r3, #120]
 1369 0088 C3F88840 		str	r4, [r3, #136]
 1370 008c C3F89840 		str	r4, [r3, #152]
 1371              	.LBE131:
 1372              	.LBE135:
 1373              	.LBB136:
 1374              	.LBB127:
 270:src/btphy/btphy.c **** 	btphy.my_sw = btbb_gen_syncword(btphy.my_lap);
 1375              		.loc 1 270 15 view .LVU439
 1376 0090 6A87     		strh	r2, [r5, #58]	@ movhi
 1377              	.LBE127:
 1378              	.LBE136:
 1379              	.LBB137:
 1380              	.LBB132:
  59:src/btphy/btphy.c **** 	for(i=0;i<BTPHY_TIMER_COUNT;i++)
 1381              		.loc 1 59 21 view .LVU440
 1382 0092 1C60     		str	r4, [r3]
 1383              	.LBE132:
 1384              	.LBE137:
 1385              		.loc 1 288 16 view .LVU441
 1386 0094 C5E90867 		strd	r6, [r5, #32]
 289:src/btphy/btphy.c **** 	btphy_timers_reset();
 1387              		.loc 1 289 2 is_stmt 1 view .LVU442
 1388              	.LBB138:
 1389              	.LBI129:
  55:src/btphy/btphy.c **** {
 1390              		.loc 1 55 13 view .LVU443
 1391              	.LBB133:
  57:src/btphy/btphy.c **** 
 1392              		.loc 1 57 2 view .LVU444
  59:src/btphy/btphy.c **** 	for(i=0;i<BTPHY_TIMER_COUNT;i++)
ARM GAS  /tmp/ccHmVI9k.s 			page 39


 1393              		.loc 1 59 2 view .LVU445
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1394              		.loc 1 60 2 view .LVU446
 1395              	.LVL76:
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1396              		.loc 1 60 10 view .LVU447
  61:src/btphy/btphy.c **** }
 1397              		.loc 1 61 3 view .LVU448
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1398              		.loc 1 60 30 view .LVU449
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1399              		.loc 1 60 10 view .LVU450
  61:src/btphy/btphy.c **** }
 1400              		.loc 1 61 3 view .LVU451
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1401              		.loc 1 60 30 view .LVU452
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1402              		.loc 1 60 10 view .LVU453
  61:src/btphy/btphy.c **** }
 1403              		.loc 1 61 3 view .LVU454
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1404              		.loc 1 60 30 view .LVU455
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1405              		.loc 1 60 10 view .LVU456
  61:src/btphy/btphy.c **** }
 1406              		.loc 1 61 3 view .LVU457
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1407              		.loc 1 60 30 view .LVU458
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1408              		.loc 1 60 10 view .LVU459
  61:src/btphy/btphy.c **** }
 1409              		.loc 1 61 3 view .LVU460
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1410              		.loc 1 60 30 view .LVU461
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1411              		.loc 1 60 10 view .LVU462
  61:src/btphy/btphy.c **** }
 1412              		.loc 1 61 3 view .LVU463
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1413              		.loc 1 60 30 view .LVU464
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1414              		.loc 1 60 10 view .LVU465
  61:src/btphy/btphy.c **** }
 1415              		.loc 1 61 3 view .LVU466
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1416              		.loc 1 60 30 view .LVU467
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1417              		.loc 1 60 10 view .LVU468
  61:src/btphy/btphy.c **** }
 1418              		.loc 1 61 3 view .LVU469
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1419              		.loc 1 60 30 view .LVU470
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1420              		.loc 1 60 10 view .LVU471
  61:src/btphy/btphy.c **** }
 1421              		.loc 1 61 3 view .LVU472
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
ARM GAS  /tmp/ccHmVI9k.s 			page 40


 1422              		.loc 1 60 30 view .LVU473
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1423              		.loc 1 60 10 view .LVU474
  61:src/btphy/btphy.c **** }
 1424              		.loc 1 61 3 view .LVU475
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1425              		.loc 1 60 30 view .LVU476
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1426              		.loc 1 60 10 view .LVU477
  60:src/btphy/btphy.c **** 		btphy_timers.timers[i].cb = NULL;
 1427              		.loc 1 60 10 is_stmt 0 view .LVU478
 1428              	.LBE133:
 1429              	.LBE138:
 290:src/btphy/btphy.c **** 
 291:src/btphy/btphy.c **** 	btphy_set_bdaddr(DEFAULT_BDADDR);
 1430              		.loc 1 291 2 is_stmt 1 view .LVU479
 1431              	.LBB139:
 1432              	.LBI124:
 266:src/btphy/btphy.c **** {
 1433              		.loc 1 266 6 view .LVU480
 1434              	.LBB128:
 268:src/btphy/btphy.c **** 	btphy.my_uap = 0xff & (bdaddr>>24);
 1435              		.loc 1 268 2 view .LVU481
 269:src/btphy/btphy.c **** 	btphy.my_nap = 0xffff & (bdaddr>>32);
 1436              		.loc 1 269 15 is_stmt 0 view .LVU482
 1437 0098 85F83810 		strb	r1, [r5, #56]
 268:src/btphy/btphy.c **** 	btphy.my_uap = 0xff & (bdaddr>>24);
 1438              		.loc 1 268 15 view .LVU483
 1439 009c 6863     		str	r0, [r5, #52]
 269:src/btphy/btphy.c **** 	btphy.my_nap = 0xffff & (bdaddr>>32);
 1440              		.loc 1 269 2 is_stmt 1 view .LVU484
 270:src/btphy/btphy.c **** 	btphy.my_sw = btbb_gen_syncword(btphy.my_lap);
 1441              		.loc 1 270 2 view .LVU485
 271:src/btphy/btphy.c **** 	cprintf("Set bdaddr %llx -> sw %llx\n", bdaddr, btphy.my_sw);
 1442              		.loc 1 271 2 view .LVU486
 271:src/btphy/btphy.c **** 	cprintf("Set bdaddr %llx -> sw %llx\n", bdaddr, btphy.my_sw);
 1443              		.loc 1 271 16 is_stmt 0 view .LVU487
 1444 009e FFF7FEFF 		bl	btbb_gen_syncword
 1445              	.LVL77:
 272:src/btphy/btphy.c **** }
 1446              		.loc 1 272 2 view .LVU488
 1447 00a2 07A3     		adr	r3, .L76
 1448 00a4 D3E90023 		ldrd	r2, [r3]
 271:src/btphy/btphy.c **** 	cprintf("Set bdaddr %llx -> sw %llx\n", bdaddr, btphy.my_sw);
 1449              		.loc 1 271 16 view .LVU489
 1450 00a8 0446     		mov	r4, r0
 272:src/btphy/btphy.c **** }
 1451              		.loc 1 272 2 view .LVU490
 1452 00aa CDE90001 		strd	r0, r1, [sp]
 271:src/btphy/btphy.c **** 	cprintf("Set bdaddr %llx -> sw %llx\n", bdaddr, btphy.my_sw);
 1453              		.loc 1 271 14 view .LVU491
 1454 00ae C5E91041 		strd	r4, r1, [r5, #64]
 272:src/btphy/btphy.c **** }
 1455              		.loc 1 272 2 is_stmt 1 view .LVU492
 1456 00b2 0E48     		ldr	r0, .L76+44
 1457 00b4 FFF7FEFF 		bl	cprintf
 1458              	.LVL78:
ARM GAS  /tmp/ccHmVI9k.s 			page 41


 272:src/btphy/btphy.c **** }
 1459              		.loc 1 272 2 is_stmt 0 view .LVU493
 1460              	.LBE128:
 1461              	.LBE139:
 292:src/btphy/btphy.c **** }
 1462              		.loc 1 292 1 view .LVU494
 1463 00b8 02B0     		add	sp, sp, #8
 1464              		.cfi_def_cfa_offset 24
 1465              		@ sp needed
 1466 00ba BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1467              	.L77:
 1468 00be 00BF     		.align	3
 1469              	.L76:
 1470 00c0 66554433 		.word	860116326
 1471 00c4 22110000 		.word	4386
 1472 00c8 80E100E0 		.word	-536813184
 1473 00cc 04400040 		.word	1073758212
 1474 00d0 04800040 		.word	1073774596
 1475 00d4 0C400040 		.word	1073758220
 1476 00d8 18400040 		.word	1073758232
 1477 00dc 00E100E0 		.word	-536813312
 1478 00e0 00000000 		.word	.LANCHOR0
 1479 00e4 00000000 		.word	btphy_timers
 1480 00e8 66554400 		.word	4478310
 1481 00ec 60000000 		.word	.LC5
 1482              		.cfi_endproc
 1483              	.LFE38:
 1485              		.global	btphy
 1486              		.comm	btphy_timers,164,4
 1487              		.bss
 1488              		.align	3
 1489              		.set	.LANCHOR0,. + 0
 1492              	btphy:
 1493 0000 00000000 		.space	72
 1493      00000000 
 1493      00000000 
 1493      00000000 
 1493      00000000 
 1494              		.text
 1495              	.Letext0:
 1496              		.file 4 "/usr/lib/gcc/arm-none-eabi/9.2.1/include/stddef.h"
 1497              		.file 5 "/usr/include/newlib/sys/_types.h"
 1498              		.file 6 "/usr/include/newlib/sys/reent.h"
 1499              		.file 7 "/usr/include/newlib/sys/lock.h"
 1500              		.file 8 "/usr/lib/gcc/arm-none-eabi/9.2.1/include/stdint.h"
 1501              		.file 9 "../common/ubertooth.h"
 1502              		.file 10 "include/ubtbr/hop.h"
 1503              		.file 11 "include/ubtbr/rf.h"
 1504              		.file 12 "include/ubtbr/btbb.h"
 1505              		.file 13 "include/ubtbr/debug.h"
 1506              		.file 14 "include/ubtbr/tdma_sched.h"
 1507              		.file 15 "include/ubtbr/tx_task.h"
 1508              		.file 16 "include/ubtbr/rx_task.h"
 1509              		.file 17 "include/ubtbr/console.h"
ARM GAS  /tmp/ccHmVI9k.s 			page 42


DEFINED SYMBOLS
                            *ABS*:0000000000000000 btphy.c
     /tmp/ccHmVI9k.s:16     .rodata.str1.4:0000000000000000 $d
     /tmp/ccHmVI9k.s:23     .text.btphy_timer_add:0000000000000000 $t
     /tmp/ccHmVI9k.s:32     .text.btphy_timer_add:0000000000000000 btphy_timer_add
     /tmp/ccHmVI9k.s:216    .text.btphy_timer_add:0000000000000084 $d
                            *COM*:00000000000000a4 btphy_timers
     /tmp/ccHmVI9k.s:232    .text.TIMER0_IRQHandler:0000000000000000 $t
     /tmp/ccHmVI9k.s:240    .text.TIMER0_IRQHandler:0000000000000000 TIMER0_IRQHandler
     /tmp/ccHmVI9k.s:497    .text.TIMER0_IRQHandler:00000000000000dc $d
     /tmp/ccHmVI9k.s:510    .text.btphy_adj_clkn_delay:0000000000000000 $t
     /tmp/ccHmVI9k.s:518    .text.btphy_adj_clkn_delay:0000000000000000 btphy_adj_clkn_delay
     /tmp/ccHmVI9k.s:561    .text.btphy_adj_clkn_delay:000000000000001c $d
     /tmp/ccHmVI9k.s:567    .text.btphy_cancel_clkn_delay:0000000000000000 $t
     /tmp/ccHmVI9k.s:575    .text.btphy_cancel_clkn_delay:0000000000000000 btphy_cancel_clkn_delay
     /tmp/ccHmVI9k.s:667    .text.btphy_cancel_clkn_delay:0000000000000038 $d
     /tmp/ccHmVI9k.s:674    .text.clkn_start:0000000000000000 $t
     /tmp/ccHmVI9k.s:682    .text.clkn_start:0000000000000000 clkn_start
     /tmp/ccHmVI9k.s:781    .text.clkn_start:000000000000005c $d
     /tmp/ccHmVI9k.s:796    .text.btphy_whiten_seed:0000000000000000 $t
     /tmp/ccHmVI9k.s:804    .text.btphy_whiten_seed:0000000000000000 btphy_whiten_seed
     /tmp/ccHmVI9k.s:858    .text.btphy_whiten_seed:000000000000002c $d
     /tmp/ccHmVI9k.s:865    .text.btphy_set_mode:0000000000000000 $t
     /tmp/ccHmVI9k.s:873    .text.btphy_set_mode:0000000000000000 btphy_set_mode
     /tmp/ccHmVI9k.s:1120   .text.btphy_set_mode:0000000000000098 $d
     /tmp/ccHmVI9k.s:1130   .text.btphy_set_bdaddr:0000000000000000 $t
     /tmp/ccHmVI9k.s:1138   .text.btphy_set_bdaddr:0000000000000000 btphy_set_bdaddr
     /tmp/ccHmVI9k.s:1198   .text.btphy_set_bdaddr:0000000000000034 $d
     /tmp/ccHmVI9k.s:1204   .text.btphy_init:0000000000000000 $t
     /tmp/ccHmVI9k.s:1212   .text.btphy_init:0000000000000000 btphy_init
     /tmp/ccHmVI9k.s:1470   .text.btphy_init:00000000000000c0 $d
     /tmp/ccHmVI9k.s:1492   .bss:0000000000000000 btphy
     /tmp/ccHmVI9k.s:1488   .bss:0000000000000000 $d

UNDEFINED SYMBOLS
die
cprintf
tdma_sched_execute
tdma_sched_advance
console_putc
hop_state
btbb_gen_syncword
btphy_rf_cfg_sync
hop_init
rev8_map
tdma_sched_reset
btphy_rf_init
tx_task_reset
rx_task_reset
