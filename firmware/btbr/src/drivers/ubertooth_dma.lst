ARM GAS  /tmp/ccTqO2DN.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 2
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"ubertooth_dma.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.rodata.str1.4,"aMS",%progbits,1
  16              		.align	2
  17              	.LC0:
  18 0000 444D4149 		.ascii	"DMAI %x\012\000"
  18      2025780A 
  18      00
  19              		.section	.text.DMA_IRQHandler,"ax",%progbits
  20              		.align	1
  21              		.p2align 2,,3
  22              		.global	DMA_IRQHandler
  23              		.arch armv7-m
  24              		.syntax unified
  25              		.thumb
  26              		.thumb_func
  27              		.fpu softvfp
  29              	DMA_IRQHandler:
  30              	.LFB1:
  31              		.file 1 "src/drivers/ubertooth_dma.c"
   1:src/drivers/ubertooth_dma.c **** /*
   2:src/drivers/ubertooth_dma.c ****  * Copyright 2015 Hannes Ellinger
   3:src/drivers/ubertooth_dma.c ****  * Copyright 2020 Etienne Helluy-Lafont, Univ. Lille, CNRS.
   4:src/drivers/ubertooth_dma.c ****  *
   5:src/drivers/ubertooth_dma.c ****  * This file is part of Project Ubertooth.
   6:src/drivers/ubertooth_dma.c ****  *
   7:src/drivers/ubertooth_dma.c ****  * This program is free software; you can redistribute it and/or modify
   8:src/drivers/ubertooth_dma.c ****  * it under the terms of the GNU General Public License as published by
   9:src/drivers/ubertooth_dma.c ****  * the Free Software Foundation; either version 2, or (at your option)
  10:src/drivers/ubertooth_dma.c ****  * any later version.
  11:src/drivers/ubertooth_dma.c ****  *
  12:src/drivers/ubertooth_dma.c ****  * This program is distributed in the hope that it will be useful,
  13:src/drivers/ubertooth_dma.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  14:src/drivers/ubertooth_dma.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  15:src/drivers/ubertooth_dma.c ****  * GNU General Public License for more details.
  16:src/drivers/ubertooth_dma.c ****  *
  17:src/drivers/ubertooth_dma.c ****  * You should have received a copy of the GNU General Public License
  18:src/drivers/ubertooth_dma.c ****  * along with this program; see the file COPYING.  If not, write to
  19:src/drivers/ubertooth_dma.c ****  * the Free Software Foundation, Inc., 51 Franklin Street,
  20:src/drivers/ubertooth_dma.c ****  * Boston, MA 02110-1301, USA.
  21:src/drivers/ubertooth_dma.c ****  */
  22:src/drivers/ubertooth_dma.c **** 
  23:src/drivers/ubertooth_dma.c **** #include <ubertooth.h>
  24:src/drivers/ubertooth_dma.c **** #include <ubtbr/cfg.h>
  25:src/drivers/ubertooth_dma.c **** #include <ubtbr/ubertooth_dma.h>
ARM GAS  /tmp/ccTqO2DN.s 			page 2


  26:src/drivers/ubertooth_dma.c **** #include <ubtbr/debug.h>
  27:src/drivers/ubertooth_dma.c **** 
  28:src/drivers/ubertooth_dma.c **** /* DMA linked list items */
  29:src/drivers/ubertooth_dma.c **** typedef struct {
  30:src/drivers/ubertooth_dma.c **** 	uint32_t src;
  31:src/drivers/ubertooth_dma.c **** 	uint32_t dest;
  32:src/drivers/ubertooth_dma.c **** 	uint32_t next_lli;
  33:src/drivers/ubertooth_dma.c **** 	uint32_t control;
  34:src/drivers/ubertooth_dma.c **** } dma_lli;
  35:src/drivers/ubertooth_dma.c **** 
  36:src/drivers/ubertooth_dma.c **** dma_lli dma_rx_lli;
  37:src/drivers/ubertooth_dma.c **** 
  38:src/drivers/ubertooth_dma.c **** volatile uint8_t *dma_user_rx_buf = (void*)0;
  39:src/drivers/ubertooth_dma.c **** volatile uint8_t *dma_user_tx_buf = (void*)0;
  40:src/drivers/ubertooth_dma.c **** dma_tx_cb_t dma_user_tx_cb = (void*)0;
  41:src/drivers/ubertooth_dma.c **** void *dma_user_tx_cb_arg = (void*)0;
  42:src/drivers/ubertooth_dma.c **** 
  43:src/drivers/ubertooth_dma.c **** void DMA_IRQHandler(void)
  44:src/drivers/ubertooth_dma.c **** {
  32              		.loc 1 44 1 view -0
  33              		.cfi_startproc
  34              		@ args = 0, pretend = 0, frame = 0
  35              		@ frame_needed = 0, uses_anonymous_args = 0
  36 0000 08B5     		push	{r3, lr}
  37              		.cfi_def_cfa_offset 8
  38              		.cfi_offset 3, -8
  39              		.cfi_offset 14, -4
  45:src/drivers/ubertooth_dma.c **** 	cprintf ("DMAI %x\n", DMACIntStat);
  40              		.loc 1 45 2 view .LVU1
  41 0002 054B     		ldr	r3, .L3
  42 0004 0548     		ldr	r0, .L3+4
  43 0006 1968     		ldr	r1, [r3]
  44 0008 FFF7FEFF 		bl	cprintf
  45              	.LVL0:
  46:src/drivers/ubertooth_dma.c **** 	DMACIntTCClear = 0xFF;
  46              		.loc 1 46 2 view .LVU2
  47              		.loc 1 46 17 is_stmt 0 view .LVU3
  48 000c FF23     		movs	r3, #255
  49 000e 0449     		ldr	r1, .L3+8
  47:src/drivers/ubertooth_dma.c **** 	DMACIntErrClr = 0xFF;
  50              		.loc 1 47 16 view .LVU4
  51 0010 044A     		ldr	r2, .L3+12
  46:src/drivers/ubertooth_dma.c **** 	DMACIntTCClear = 0xFF;
  52              		.loc 1 46 17 view .LVU5
  53 0012 0B60     		str	r3, [r1]
  54              		.loc 1 47 2 is_stmt 1 view .LVU6
  55              		.loc 1 47 16 is_stmt 0 view .LVU7
  56 0014 1360     		str	r3, [r2]
  48:src/drivers/ubertooth_dma.c **** #if 0
  49:src/drivers/ubertooth_dma.c **** 	if (DMACIntStat & (1 << 1)) {
  50:src/drivers/ubertooth_dma.c **** 		if (DMACIntTCStat & (1 << 1)) {
  51:src/drivers/ubertooth_dma.c **** 			DMACIntTCClear = (1 << 1);
  52:src/drivers/ubertooth_dma.c **** 			cprintf ("Int TC\n");
  53:src/drivers/ubertooth_dma.c **** 			if (dma_user_tx_cb)
  54:src/drivers/ubertooth_dma.c **** 			{
  55:src/drivers/ubertooth_dma.c **** 				/* Execute the callback handler and uninstall */
  56:src/drivers/ubertooth_dma.c **** 				dma_user_tx_cb(dma_user_tx_cb_arg);
ARM GAS  /tmp/ccTqO2DN.s 			page 3


  57:src/drivers/ubertooth_dma.c **** 				dma_user_tx_cb = (void*)0;
  58:src/drivers/ubertooth_dma.c **** 			}
  59:src/drivers/ubertooth_dma.c **** 			else
  60:src/drivers/ubertooth_dma.c **** 			{
  61:src/drivers/ubertooth_dma.c **** 				cprintf("Unk DMA IRQ\n");
  62:src/drivers/ubertooth_dma.c **** 			}
  63:src/drivers/ubertooth_dma.c **** 		}
  64:src/drivers/ubertooth_dma.c **** 		if (DMACIntErrStat & (1 << 1)) {
  65:src/drivers/ubertooth_dma.c **** 			DMACIntErrClr = (1 << 1);
  66:src/drivers/ubertooth_dma.c **** 		}
  67:src/drivers/ubertooth_dma.c **** 	}
  68:src/drivers/ubertooth_dma.c **** #endif
  69:src/drivers/ubertooth_dma.c **** }
  57              		.loc 1 69 1 view .LVU8
  58 0016 08BD     		pop	{r3, pc}
  59              	.L4:
  60              		.align	2
  61              	.L3:
  62 0018 00400050 		.word	1342193664
  63 001c 00000000 		.word	.LC0
  64 0020 08400050 		.word	1342193672
  65 0024 10400050 		.word	1342193680
  66              		.cfi_endproc
  67              	.LFE1:
  69              		.section	.text.dma_poweron,"ax",%progbits
  70              		.align	1
  71              		.p2align 2,,3
  72              		.global	dma_poweron
  73              		.syntax unified
  74              		.thumb
  75              		.thumb_func
  76              		.fpu softvfp
  78              	dma_poweron:
  79              	.LFB2:
  70:src/drivers/ubertooth_dma.c **** 
  71:src/drivers/ubertooth_dma.c **** void dma_poweron(void) {
  80              		.loc 1 71 24 is_stmt 1 view -0
  81              		.cfi_startproc
  82              		@ args = 0, pretend = 0, frame = 0
  83              		@ frame_needed = 0, uses_anonymous_args = 0
  84              		@ link register save eliminated.
  85 0000 F0B4     		push	{r4, r5, r6, r7}
  86              		.cfi_def_cfa_offset 16
  87              		.cfi_offset 4, -16
  88              		.cfi_offset 5, -12
  89              		.cfi_offset 6, -8
  90              		.cfi_offset 7, -4
  72:src/drivers/ubertooth_dma.c **** 	// refer to UM10360 LPC17xx User Manual Ch 31 Sec 31.6.1, PDF page 616
  73:src/drivers/ubertooth_dma.c **** 	PCONP |= PCONP_PCGPDMA;
  91              		.loc 1 73 2 view .LVU10
  74:src/drivers/ubertooth_dma.c **** 
  75:src/drivers/ubertooth_dma.c **** 	// enable DMA interrupts at lowest priority
  76:src/drivers/ubertooth_dma.c **** 	//IPR6 |= IPR6_IP_DMA; // hack, sets it to 31 (lowest)
  77:src/drivers/ubertooth_dma.c **** 	IPR6 |= 31<<19; // pri 
  78:src/drivers/ubertooth_dma.c **** 	ISER0 = ISER0_ISE_DMA;
  92              		.loc 1 78 8 is_stmt 0 view .LVU11
  93 0002 4FF08067 		mov	r7, #67108864
ARM GAS  /tmp/ccTqO2DN.s 			page 4


  79:src/drivers/ubertooth_dma.c **** 
  80:src/drivers/ubertooth_dma.c **** 	/* Disable DMA interrupt */
  81:src/drivers/ubertooth_dma.c **** 	//ICER0 = ICER0_ICE_DMA;
  82:src/drivers/ubertooth_dma.c **** 
  83:src/drivers/ubertooth_dma.c **** 	// disable active channels
  84:src/drivers/ubertooth_dma.c **** 	DMACC0Config = 0;
  94              		.loc 1 84 15 view .LVU12
  95 0006 0023     		movs	r3, #0
  85:src/drivers/ubertooth_dma.c **** 	DMACC1Config = 0;
  86:src/drivers/ubertooth_dma.c **** 	DMACC2Config = 0;
  87:src/drivers/ubertooth_dma.c **** 	DMACC3Config = 0;
  88:src/drivers/ubertooth_dma.c **** 	DMACC4Config = 0;
  89:src/drivers/ubertooth_dma.c **** 	DMACC5Config = 0;
  90:src/drivers/ubertooth_dma.c **** 	DMACC6Config = 0;
  91:src/drivers/ubertooth_dma.c **** 	DMACC7Config = 0;
  92:src/drivers/ubertooth_dma.c **** 	DMACIntTCClear = 0xFF;
  93:src/drivers/ubertooth_dma.c **** 	DMACIntErrClr = 0xFF;
  94:src/drivers/ubertooth_dma.c **** 
  95:src/drivers/ubertooth_dma.c **** 	/* enable DMA globally */
  96:src/drivers/ubertooth_dma.c **** 	DMACConfig = DMACConfig_E;
  96              		.loc 1 96 13 view .LVU13
  97 0008 1448     		ldr	r0, .L9
  92:src/drivers/ubertooth_dma.c **** 	DMACIntErrClr = 0xFF;
  98              		.loc 1 92 17 view .LVU14
  99 000a FF24     		movs	r4, #255
 100              		.loc 1 96 13 view .LVU15
 101 000c 0126     		movs	r6, #1
  97:src/drivers/ubertooth_dma.c **** 	while (!(DMACConfig & DMACConfig_E));
 102              		.loc 1 97 11 view .LVU16
 103 000e 0246     		mov	r2, r0
  73:src/drivers/ubertooth_dma.c **** 
 104              		.loc 1 73 8 view .LVU17
 105 0010 134D     		ldr	r5, .L9+4
 106 0012 2968     		ldr	r1, [r5]
 107 0014 41F00051 		orr	r1, r1, #536870912
 108 0018 2960     		str	r1, [r5]
  77:src/drivers/ubertooth_dma.c **** 	ISER0 = ISER0_ISE_DMA;
 109              		.loc 1 77 2 is_stmt 1 view .LVU18
  77:src/drivers/ubertooth_dma.c **** 	ISER0 = ISER0_ISE_DMA;
 110              		.loc 1 77 7 is_stmt 0 view .LVU19
 111 001a 124D     		ldr	r5, .L9+8
 112 001c 2968     		ldr	r1, [r5]
 113 001e 41F47801 		orr	r1, r1, #16252928
 114 0022 2960     		str	r1, [r5]
  78:src/drivers/ubertooth_dma.c **** 
 115              		.loc 1 78 2 is_stmt 1 view .LVU20
  78:src/drivers/ubertooth_dma.c **** 
 116              		.loc 1 78 8 is_stmt 0 view .LVU21
 117 0024 1049     		ldr	r1, .L9+12
  84:src/drivers/ubertooth_dma.c **** 	DMACC1Config = 0;
 118              		.loc 1 84 15 view .LVU22
 119 0026 114D     		ldr	r5, .L9+16
  78:src/drivers/ubertooth_dma.c **** 
 120              		.loc 1 78 8 view .LVU23
 121 0028 0F60     		str	r7, [r1]
  84:src/drivers/ubertooth_dma.c **** 	DMACC1Config = 0;
 122              		.loc 1 84 2 is_stmt 1 view .LVU24
ARM GAS  /tmp/ccTqO2DN.s 			page 5


  85:src/drivers/ubertooth_dma.c **** 	DMACC2Config = 0;
 123              		.loc 1 85 15 is_stmt 0 view .LVU25
 124 002a 1149     		ldr	r1, .L9+20
  84:src/drivers/ubertooth_dma.c **** 	DMACC1Config = 0;
 125              		.loc 1 84 15 view .LVU26
 126 002c 2B60     		str	r3, [r5]
  85:src/drivers/ubertooth_dma.c **** 	DMACC2Config = 0;
 127              		.loc 1 85 2 is_stmt 1 view .LVU27
  85:src/drivers/ubertooth_dma.c **** 	DMACC2Config = 0;
 128              		.loc 1 85 15 is_stmt 0 view .LVU28
 129 002e 0B60     		str	r3, [r1]
  86:src/drivers/ubertooth_dma.c **** 	DMACC3Config = 0;
 130              		.loc 1 86 2 is_stmt 1 view .LVU29
  86:src/drivers/ubertooth_dma.c **** 	DMACC3Config = 0;
 131              		.loc 1 86 15 is_stmt 0 view .LVU30
 132 0030 2B64     		str	r3, [r5, #64]
  87:src/drivers/ubertooth_dma.c **** 	DMACC4Config = 0;
 133              		.loc 1 87 2 is_stmt 1 view .LVU31
  87:src/drivers/ubertooth_dma.c **** 	DMACC4Config = 0;
 134              		.loc 1 87 15 is_stmt 0 view .LVU32
 135 0032 0B64     		str	r3, [r1, #64]
  88:src/drivers/ubertooth_dma.c **** 	DMACC5Config = 0;
 136              		.loc 1 88 2 is_stmt 1 view .LVU33
  88:src/drivers/ubertooth_dma.c **** 	DMACC5Config = 0;
 137              		.loc 1 88 15 is_stmt 0 view .LVU34
 138 0034 C5F88030 		str	r3, [r5, #128]
  89:src/drivers/ubertooth_dma.c **** 	DMACC6Config = 0;
 139              		.loc 1 89 2 is_stmt 1 view .LVU35
  89:src/drivers/ubertooth_dma.c **** 	DMACC6Config = 0;
 140              		.loc 1 89 15 is_stmt 0 view .LVU36
 141 0038 C1F88030 		str	r3, [r1, #128]
  90:src/drivers/ubertooth_dma.c **** 	DMACC7Config = 0;
 142              		.loc 1 90 2 is_stmt 1 view .LVU37
  90:src/drivers/ubertooth_dma.c **** 	DMACC7Config = 0;
 143              		.loc 1 90 15 is_stmt 0 view .LVU38
 144 003c C5F8C030 		str	r3, [r5, #192]
  91:src/drivers/ubertooth_dma.c **** 	DMACIntTCClear = 0xFF;
 145              		.loc 1 91 2 is_stmt 1 view .LVU39
  91:src/drivers/ubertooth_dma.c **** 	DMACIntTCClear = 0xFF;
 146              		.loc 1 91 15 is_stmt 0 view .LVU40
 147 0040 C1F8C030 		str	r3, [r1, #192]
  92:src/drivers/ubertooth_dma.c **** 	DMACIntErrClr = 0xFF;
 148              		.loc 1 92 2 is_stmt 1 view .LVU41
  93:src/drivers/ubertooth_dma.c **** 
 149              		.loc 1 93 16 is_stmt 0 view .LVU42
 150 0044 0B4B     		ldr	r3, .L9+24
  92:src/drivers/ubertooth_dma.c **** 	DMACIntErrClr = 0xFF;
 151              		.loc 1 92 17 view .LVU43
 152 0046 A1F59471 		sub	r1, r1, #296
 153 004a 0C60     		str	r4, [r1]
  93:src/drivers/ubertooth_dma.c **** 
 154              		.loc 1 93 2 is_stmt 1 view .LVU44
  93:src/drivers/ubertooth_dma.c **** 
 155              		.loc 1 93 16 is_stmt 0 view .LVU45
 156 004c 1C60     		str	r4, [r3]
  96:src/drivers/ubertooth_dma.c **** 	while (!(DMACConfig & DMACConfig_E));
 157              		.loc 1 96 2 is_stmt 1 view .LVU46
ARM GAS  /tmp/ccTqO2DN.s 			page 6


  96:src/drivers/ubertooth_dma.c **** 	while (!(DMACConfig & DMACConfig_E));
 158              		.loc 1 96 13 is_stmt 0 view .LVU47
 159 004e 0660     		str	r6, [r0]
 160              		.loc 1 97 2 is_stmt 1 view .LVU48
 161              	.L6:
 162              		.loc 1 97 38 discriminator 1 view .LVU49
 163              		.loc 1 97 8 discriminator 1 view .LVU50
 164              		.loc 1 97 11 is_stmt 0 discriminator 1 view .LVU51
 165 0050 1368     		ldr	r3, [r2]
 166              		.loc 1 97 8 discriminator 1 view .LVU52
 167 0052 DB07     		lsls	r3, r3, #31
 168 0054 FCD5     		bpl	.L6
  98:src/drivers/ubertooth_dma.c **** }
 169              		.loc 1 98 1 view .LVU53
 170 0056 F0BC     		pop	{r4, r5, r6, r7}
 171              		.cfi_restore 7
 172              		.cfi_restore 6
 173              		.cfi_restore 5
 174              		.cfi_restore 4
 175              		.cfi_def_cfa_offset 0
 176 0058 7047     		bx	lr
 177              	.L10:
 178 005a 00BF     		.align	2
 179              	.L9:
 180 005c 30400050 		.word	1342193712
 181 0060 C4C00F40 		.word	1074774212
 182 0064 18E400E0 		.word	-536812520
 183 0068 00E100E0 		.word	-536813312
 184 006c 10410050 		.word	1342193936
 185 0070 30410050 		.word	1342193968
 186 0074 10400050 		.word	1342193680
 187              		.cfi_endproc
 188              	.LFE2:
 190              		.section	.text.dma_poweroff,"ax",%progbits
 191              		.align	1
 192              		.p2align 2,,3
 193              		.global	dma_poweroff
 194              		.syntax unified
 195              		.thumb
 196              		.thumb_func
 197              		.fpu softvfp
 199              	dma_poweroff:
 200              	.LFB3:
  99:src/drivers/ubertooth_dma.c **** 
 100:src/drivers/ubertooth_dma.c **** void dma_poweroff(void) {
 201              		.loc 1 100 25 is_stmt 1 view -0
 202              		.cfi_startproc
 203              		@ args = 0, pretend = 0, frame = 0
 204              		@ frame_needed = 0, uses_anonymous_args = 0
 205              		@ link register save eliminated.
 101:src/drivers/ubertooth_dma.c **** 	// Disable the DMA controller by writing 0 to the DMA Enable bit in the DMACConfig
 102:src/drivers/ubertooth_dma.c **** 	// register.
 103:src/drivers/ubertooth_dma.c **** 	DMACConfig &= ~DMACConfig_E;
 206              		.loc 1 103 2 view .LVU55
 207              		.loc 1 103 13 is_stmt 0 view .LVU56
 208 0000 094B     		ldr	r3, .L14
 104:src/drivers/ubertooth_dma.c **** 	while (DMACConfig & DMACConfig_E);
ARM GAS  /tmp/ccTqO2DN.s 			page 7


 209              		.loc 1 104 9 view .LVU57
 210 0002 1A46     		mov	r2, r3
 103:src/drivers/ubertooth_dma.c **** 	while (DMACConfig & DMACConfig_E);
 211              		.loc 1 103 13 view .LVU58
 212 0004 1968     		ldr	r1, [r3]
 213 0006 21F00101 		bic	r1, r1, #1
 214 000a 1960     		str	r1, [r3]
 215              		.loc 1 104 2 is_stmt 1 view .LVU59
 216              	.L12:
 217              		.loc 1 104 35 discriminator 1 view .LVU60
 218              		.loc 1 104 8 discriminator 1 view .LVU61
 219              		.loc 1 104 9 is_stmt 0 discriminator 1 view .LVU62
 220 000c 1368     		ldr	r3, [r2]
 221              		.loc 1 104 8 discriminator 1 view .LVU63
 222 000e DB07     		lsls	r3, r3, #31
 223 0010 FCD4     		bmi	.L12
 105:src/drivers/ubertooth_dma.c **** 
 106:src/drivers/ubertooth_dma.c **** 	ICER0 = ICER0_ICE_DMA;
 224              		.loc 1 106 2 is_stmt 1 view .LVU64
 225              		.loc 1 106 8 is_stmt 0 view .LVU65
 226 0012 4FF08061 		mov	r1, #67108864
 227 0016 054B     		ldr	r3, .L14+4
 107:src/drivers/ubertooth_dma.c **** 
 108:src/drivers/ubertooth_dma.c **** 	PCONP &= ~PCONP_PCGPDMA;
 228              		.loc 1 108 8 view .LVU66
 229 0018 054A     		ldr	r2, .L14+8
 106:src/drivers/ubertooth_dma.c **** 
 230              		.loc 1 106 8 view .LVU67
 231 001a 1960     		str	r1, [r3]
 232              		.loc 1 108 2 is_stmt 1 view .LVU68
 233              		.loc 1 108 8 is_stmt 0 view .LVU69
 234 001c 1368     		ldr	r3, [r2]
 235 001e 23F00053 		bic	r3, r3, #536870912
 236 0022 1360     		str	r3, [r2]
 109:src/drivers/ubertooth_dma.c **** }
 237              		.loc 1 109 1 view .LVU70
 238 0024 7047     		bx	lr
 239              	.L15:
 240 0026 00BF     		.align	2
 241              	.L14:
 242 0028 30400050 		.word	1342193712
 243 002c 80E100E0 		.word	-536813184
 244 0030 C4C00F40 		.word	1074774212
 245              		.cfi_endproc
 246              	.LFE3:
 248              		.section	.text.dma_clear_interrupts,"ax",%progbits
 249              		.align	1
 250              		.p2align 2,,3
 251              		.global	dma_clear_interrupts
 252              		.syntax unified
 253              		.thumb
 254              		.thumb_func
 255              		.fpu softvfp
 257              	dma_clear_interrupts:
 258              	.LVL1:
 259              	.LFB4:
 110:src/drivers/ubertooth_dma.c **** 
ARM GAS  /tmp/ccTqO2DN.s 			page 8


 111:src/drivers/ubertooth_dma.c **** void dma_clear_interrupts(unsigned channel) {
 260              		.loc 1 111 45 is_stmt 1 view -0
 261              		.cfi_startproc
 262              		@ args = 0, pretend = 0, frame = 0
 263              		@ frame_needed = 0, uses_anonymous_args = 0
 264              		@ link register save eliminated.
 265              		.loc 1 111 45 is_stmt 0 view .LVU72
 112:src/drivers/ubertooth_dma.c **** 	DMACIntTCClear = 1 << channel;
 266              		.loc 1 112 2 is_stmt 1 view .LVU73
 267              		.loc 1 112 21 is_stmt 0 view .LVU74
 268 0000 0123     		movs	r3, #1
 269              		.loc 1 112 17 view .LVU75
 270 0002 0349     		ldr	r1, .L17
 113:src/drivers/ubertooth_dma.c **** 	DMACIntErrClr  = 1 << channel;
 271              		.loc 1 113 17 view .LVU76
 272 0004 034A     		ldr	r2, .L17+4
 112:src/drivers/ubertooth_dma.c **** 	DMACIntTCClear = 1 << channel;
 273              		.loc 1 112 21 view .LVU77
 274 0006 03FA00F0 		lsl	r0, r3, r0
 275              	.LVL2:
 112:src/drivers/ubertooth_dma.c **** 	DMACIntTCClear = 1 << channel;
 276              		.loc 1 112 17 view .LVU78
 277 000a 0860     		str	r0, [r1]
 278              		.loc 1 113 2 is_stmt 1 view .LVU79
 279              		.loc 1 113 17 is_stmt 0 view .LVU80
 280 000c 1060     		str	r0, [r2]
 114:src/drivers/ubertooth_dma.c **** }
 281              		.loc 1 114 1 view .LVU81
 282 000e 7047     		bx	lr
 283              	.L18:
 284              		.align	2
 285              	.L17:
 286 0010 08400050 		.word	1342193672
 287 0014 10400050 		.word	1342193680
 288              		.cfi_endproc
 289              	.LFE4:
 291              		.section	.rodata.str1.4
 292 0009 000000   		.align	2
 293              	.LC1:
 294 000c 73737020 		.ascii	"ssp ne\012\000"
 294      6E650A00 
 295              		.section	.text.dio_ssp_stop,"ax",%progbits
 296              		.align	1
 297              		.p2align 2,,3
 298              		.global	dio_ssp_stop
 299              		.syntax unified
 300              		.thumb
 301              		.thumb_func
 302              		.fpu softvfp
 304              	dio_ssp_stop:
 305              	.LFB5:
 115:src/drivers/ubertooth_dma.c **** 
 116:src/drivers/ubertooth_dma.c **** void dio_ssp_stop(void)
 117:src/drivers/ubertooth_dma.c **** {
 306              		.loc 1 117 1 is_stmt 1 view -0
 307              		.cfi_startproc
 308              		@ args = 0, pretend = 0, frame = 8
ARM GAS  /tmp/ccTqO2DN.s 			page 9


 309              		@ frame_needed = 0, uses_anonymous_args = 0
 310 0000 70B5     		push	{r4, r5, r6, lr}
 311              		.cfi_def_cfa_offset 16
 312              		.cfi_offset 4, -16
 313              		.cfi_offset 5, -12
 314              		.cfi_offset 6, -8
 315              		.cfi_offset 14, -4
 316 0002 82B0     		sub	sp, sp, #8
 317              		.cfi_def_cfa_offset 24
 118:src/drivers/ubertooth_dma.c **** 	// disable CC2400's output (active low)
 119:src/drivers/ubertooth_dma.c **** 	DIO_SSEL_SET;
 318              		.loc 1 119 2 view .LVU83
 319 0004 4FF08055 		mov	r5, #268435456
 120:src/drivers/ubertooth_dma.c **** 
 121:src/drivers/ubertooth_dma.c **** 	// disable DMA on SSP; disable SSP ; disable DMA channel
 122:src/drivers/ubertooth_dma.c **** 	DIO_SSP_CR1 &= ~SSPCR1_SSE;
 123:src/drivers/ubertooth_dma.c **** 	DIO_SSP_DMACR = 0;
 320              		.loc 1 123 16 is_stmt 0 view .LVU84
 321 0008 0024     		movs	r4, #0
 322              	.LBB7:
 323              	.LBB8:
 112:src/drivers/ubertooth_dma.c **** 	DMACIntErrClr  = 1 << channel;
 324              		.loc 1 112 17 view .LVU85
 325 000a 0222     		movs	r2, #2
 326              	.LBE8:
 327              	.LBE7:
 328              	.LBB10:
 329              	.LBB11:
 330 000c 0120     		movs	r0, #1
 331              	.LBE11:
 332              	.LBE10:
 119:src/drivers/ubertooth_dma.c **** 
 333              		.loc 1 119 2 view .LVU86
 334 000e 114B     		ldr	r3, .L26
 122:src/drivers/ubertooth_dma.c **** 	DIO_SSP_DMACR = 0;
 335              		.loc 1 122 14 view .LVU87
 336 0010 1149     		ldr	r1, .L26+4
 119:src/drivers/ubertooth_dma.c **** 
 337              		.loc 1 119 2 view .LVU88
 338 0012 1D60     		str	r5, [r3]
 122:src/drivers/ubertooth_dma.c **** 	DIO_SSP_DMACR = 0;
 339              		.loc 1 122 2 is_stmt 1 view .LVU89
 122:src/drivers/ubertooth_dma.c **** 	DIO_SSP_DMACR = 0;
 340              		.loc 1 122 14 is_stmt 0 view .LVU90
 341 0014 0B68     		ldr	r3, [r1]
 342              		.loc 1 123 16 view .LVU91
 343 0016 114E     		ldr	r6, .L26+8
 122:src/drivers/ubertooth_dma.c **** 	DIO_SSP_DMACR = 0;
 344              		.loc 1 122 14 view .LVU92
 345 0018 23F00203 		bic	r3, r3, #2
 124:src/drivers/ubertooth_dma.c **** 	DMACC0Config = 0;
 346              		.loc 1 124 15 view .LVU93
 347 001c 104D     		ldr	r5, .L26+12
 122:src/drivers/ubertooth_dma.c **** 	DIO_SSP_DMACR = 0;
 348              		.loc 1 122 14 view .LVU94
 349 001e 0B60     		str	r3, [r1]
 123:src/drivers/ubertooth_dma.c **** 	DMACC0Config = 0;
ARM GAS  /tmp/ccTqO2DN.s 			page 10


 350              		.loc 1 123 2 is_stmt 1 view .LVU95
 351              	.LBB15:
 352              	.LBB12:
 113:src/drivers/ubertooth_dma.c **** }
 353              		.loc 1 113 17 is_stmt 0 view .LVU96
 354 0020 104B     		ldr	r3, .L26+16
 112:src/drivers/ubertooth_dma.c **** 	DMACIntErrClr  = 1 << channel;
 355              		.loc 1 112 17 view .LVU97
 356 0022 1149     		ldr	r1, .L26+20
 357              	.LBE12:
 358              	.LBE15:
 123:src/drivers/ubertooth_dma.c **** 	DMACC0Config = 0;
 359              		.loc 1 123 16 view .LVU98
 360 0024 3460     		str	r4, [r6]
 361              		.loc 1 124 2 is_stmt 1 view .LVU99
 362              		.loc 1 124 15 is_stmt 0 view .LVU100
 363 0026 2C60     		str	r4, [r5]
 125:src/drivers/ubertooth_dma.c **** 
 126:src/drivers/ubertooth_dma.c **** 	dma_clear_interrupts(0);
 364              		.loc 1 126 2 is_stmt 1 view .LVU101
 365              	.LVL3:
 366              	.LBB16:
 367              	.LBI10:
 111:src/drivers/ubertooth_dma.c **** 	DMACIntTCClear = 1 << channel;
 368              		.loc 1 111 6 view .LVU102
 369              	.LBB13:
 112:src/drivers/ubertooth_dma.c **** 	DMACIntErrClr  = 1 << channel;
 370              		.loc 1 112 2 view .LVU103
 371              	.LBE13:
 372              	.LBE16:
 127:src/drivers/ubertooth_dma.c **** 	dma_clear_interrupts(1);
 128:src/drivers/ubertooth_dma.c **** 
 129:src/drivers/ubertooth_dma.c **** 	// flush SSP
 130:src/drivers/ubertooth_dma.c **** 	while (SSP1SR & SSPSR_RNE) {
 373              		.loc 1 130 9 is_stmt 0 view .LVU104
 374 0028 104C     		ldr	r4, .L26+24
 375              	.LBB17:
 376              	.LBB14:
 112:src/drivers/ubertooth_dma.c **** 	DMACIntErrClr  = 1 << channel;
 377              		.loc 1 112 17 view .LVU105
 378 002a 0860     		str	r0, [r1]
 113:src/drivers/ubertooth_dma.c **** }
 379              		.loc 1 113 2 is_stmt 1 view .LVU106
 113:src/drivers/ubertooth_dma.c **** }
 380              		.loc 1 113 17 is_stmt 0 view .LVU107
 381 002c 1860     		str	r0, [r3]
 382              	.LVL4:
 113:src/drivers/ubertooth_dma.c **** }
 383              		.loc 1 113 17 view .LVU108
 384              	.LBE14:
 385              	.LBE17:
 127:src/drivers/ubertooth_dma.c **** 	dma_clear_interrupts(1);
 386              		.loc 1 127 2 is_stmt 1 view .LVU109
 387              	.LBB18:
 388              	.LBI7:
 111:src/drivers/ubertooth_dma.c **** 	DMACIntTCClear = 1 << channel;
 389              		.loc 1 111 6 view .LVU110
ARM GAS  /tmp/ccTqO2DN.s 			page 11


 390              	.LBB9:
 112:src/drivers/ubertooth_dma.c **** 	DMACIntErrClr  = 1 << channel;
 391              		.loc 1 112 2 view .LVU111
 112:src/drivers/ubertooth_dma.c **** 	DMACIntErrClr  = 1 << channel;
 392              		.loc 1 112 17 is_stmt 0 view .LVU112
 393 002e 0A60     		str	r2, [r1]
 113:src/drivers/ubertooth_dma.c **** }
 394              		.loc 1 113 2 is_stmt 1 view .LVU113
 113:src/drivers/ubertooth_dma.c **** }
 395              		.loc 1 113 17 is_stmt 0 view .LVU114
 396 0030 1A60     		str	r2, [r3]
 397              	.LVL5:
 113:src/drivers/ubertooth_dma.c **** }
 398              		.loc 1 113 17 view .LVU115
 399              	.LBE9:
 400              	.LBE18:
 401              		.loc 1 130 8 is_stmt 1 view .LVU116
 402              		.loc 1 130 9 is_stmt 0 view .LVU117
 403 0032 2368     		ldr	r3, [r4]
 404              		.loc 1 130 8 view .LVU118
 405 0034 5A07     		lsls	r2, r3, #29
 406 0036 0BD5     		bpl	.L19
 407              	.LBB19:
 131:src/drivers/ubertooth_dma.c **** 		cprintf("ssp ne\n");
 408              		.loc 1 131 3 view .LVU119
 409 0038 0D4E     		ldr	r6, .L26+28
 132:src/drivers/ubertooth_dma.c **** 		volatile uint8_t tmp = (uint8_t)DIO_SSP_DR;
 410              		.loc 1 132 35 view .LVU120
 411 003a 0E4D     		ldr	r5, .L26+32
 412              	.L21:
 131:src/drivers/ubertooth_dma.c **** 		cprintf("ssp ne\n");
 413              		.loc 1 131 3 is_stmt 1 view .LVU121
 414 003c 3046     		mov	r0, r6
 415 003e FFF7FEFF 		bl	cprintf
 416              	.LVL6:
 417              		.loc 1 132 3 view .LVU122
 418              		.loc 1 132 35 is_stmt 0 view .LVU123
 419 0042 2B68     		ldr	r3, [r5]
 420              		.loc 1 132 26 view .LVU124
 421 0044 DBB2     		uxtb	r3, r3
 422              		.loc 1 132 20 view .LVU125
 423 0046 8DF80730 		strb	r3, [sp, #7]
 424              	.LBE19:
 130:src/drivers/ubertooth_dma.c **** 		cprintf("ssp ne\n");
 425              		.loc 1 130 8 is_stmt 1 view .LVU126
 130:src/drivers/ubertooth_dma.c **** 		cprintf("ssp ne\n");
 426              		.loc 1 130 9 is_stmt 0 view .LVU127
 427 004a 2368     		ldr	r3, [r4]
 130:src/drivers/ubertooth_dma.c **** 		cprintf("ssp ne\n");
 428              		.loc 1 130 8 view .LVU128
 429 004c 5B07     		lsls	r3, r3, #29
 430 004e F5D4     		bmi	.L21
 431              	.L19:
 133:src/drivers/ubertooth_dma.c **** 	}
 134:src/drivers/ubertooth_dma.c **** }
 432              		.loc 1 134 1 view .LVU129
 433 0050 02B0     		add	sp, sp, #8
ARM GAS  /tmp/ccTqO2DN.s 			page 12


 434              		.cfi_def_cfa_offset 16
 435              		@ sp needed
 436 0052 70BD     		pop	{r4, r5, r6, pc}
 437              	.L27:
 438              		.align	2
 439              	.L26:
 440 0054 98C00920 		.word	537510040
 441 0058 04000340 		.word	1073938436
 442 005c 24000340 		.word	1073938468
 443 0060 10410050 		.word	1342193936
 444 0064 10400050 		.word	1342193680
 445 0068 08400050 		.word	1342193672
 446 006c 0C000340 		.word	1073938444
 447 0070 0C000000 		.word	.LC1
 448 0074 08000340 		.word	1073938440
 449              		.cfi_endproc
 450              	.LFE5:
 452              		.section	.text.dio_ssp_start_rx,"ax",%progbits
 453              		.align	1
 454              		.p2align 2,,3
 455              		.global	dio_ssp_start_rx
 456              		.syntax unified
 457              		.thumb
 458              		.thumb_func
 459              		.fpu softvfp
 461              	dio_ssp_start_rx:
 462              	.LFB6:
 135:src/drivers/ubertooth_dma.c **** 
 136:src/drivers/ubertooth_dma.c **** void dio_ssp_start_rx(void)
 137:src/drivers/ubertooth_dma.c **** {
 463              		.loc 1 137 1 is_stmt 1 view -0
 464              		.cfi_startproc
 465              		@ args = 0, pretend = 0, frame = 0
 466              		@ frame_needed = 0, uses_anonymous_args = 0
 467              		@ link register save eliminated.
 468 0000 30B4     		push	{r4, r5}
 469              		.cfi_def_cfa_offset 8
 470              		.cfi_offset 4, -8
 471              		.cfi_offset 5, -4
 138:src/drivers/ubertooth_dma.c **** 	/* make sure the (active low) slave select signal is not active */
 139:src/drivers/ubertooth_dma.c **** 	DIO_SSEL_SET;
 472              		.loc 1 139 2 view .LVU131
 140:src/drivers/ubertooth_dma.c **** 	//SCLK_SET_IN;
 141:src/drivers/ubertooth_dma.c **** 
 142:src/drivers/ubertooth_dma.c **** 	/* Configure RX DMA on DIO_SSP (SSP1 for Ubertooth One) */
 143:src/drivers/ubertooth_dma.c **** 	DIO_SSP_DMACR = SSPDMACR_RXDMAE ;
 473              		.loc 1 143 16 is_stmt 0 view .LVU132
 474 0002 0124     		movs	r4, #1
 139:src/drivers/ubertooth_dma.c **** 	//SCLK_SET_IN;
 475              		.loc 1 139 2 view .LVU133
 476 0004 4FF08051 		mov	r1, #268435456
 144:src/drivers/ubertooth_dma.c **** 	/* Configuration of DMA : Slave, Slave output disable
 145:src/drivers/ubertooth_dma.c **** 		DIO_SSP_CR1 = SSPCR1_MS | SSPCR1_SOD;
 146:src/drivers/ubertooth_dma.c **** 	DIO_SSP_CR1 = SSPCR1_MS | SSPCR1_SOD;
 147:src/drivers/ubertooth_dma.c **** 	 */
 148:src/drivers/ubertooth_dma.c **** 	DIO_SSP_CR1 = SSPCR1_MS | SSPCR1_SOD;
 477              		.loc 1 148 14 view .LVU134
ARM GAS  /tmp/ccTqO2DN.s 			page 13


 478 0008 0C22     		movs	r2, #12
 479 000a 094B     		ldr	r3, .L29
 139:src/drivers/ubertooth_dma.c **** 	//SCLK_SET_IN;
 480              		.loc 1 139 2 view .LVU135
 481 000c 094D     		ldr	r5, .L29+4
 143:src/drivers/ubertooth_dma.c **** 	/* Configuration of DMA : Slave, Slave output disable
 482              		.loc 1 143 16 view .LVU136
 483 000e 0A48     		ldr	r0, .L29+8
 139:src/drivers/ubertooth_dma.c **** 	//SCLK_SET_IN;
 484              		.loc 1 139 2 view .LVU137
 485 0010 2960     		str	r1, [r5]
 143:src/drivers/ubertooth_dma.c **** 	/* Configuration of DMA : Slave, Slave output disable
 486              		.loc 1 143 2 is_stmt 1 view .LVU138
 143:src/drivers/ubertooth_dma.c **** 	/* Configuration of DMA : Slave, Slave output disable
 487              		.loc 1 143 16 is_stmt 0 view .LVU139
 488 0012 0460     		str	r4, [r0]
 489              		.loc 1 148 2 is_stmt 1 view .LVU140
 490              		.loc 1 148 14 is_stmt 0 view .LVU141
 491 0014 1A60     		str	r2, [r3]
 149:src/drivers/ubertooth_dma.c **** 
 150:src/drivers/ubertooth_dma.c **** 	/* Enable ssp */
 151:src/drivers/ubertooth_dma.c **** 	DIO_SSP_CR1 |= SSPCR1_SSE;
 492              		.loc 1 151 2 is_stmt 1 view .LVU142
 493              		.loc 1 151 14 is_stmt 0 view .LVU143
 494 0016 1A68     		ldr	r2, [r3]
 152:src/drivers/ubertooth_dma.c **** 
 153:src/drivers/ubertooth_dma.c **** 	// enable channel
 154:src/drivers/ubertooth_dma.c **** 	DMACC0Config |= 1;
 495              		.loc 1 154 15 view .LVU144
 496 0018 0848     		ldr	r0, .L29+12
 151:src/drivers/ubertooth_dma.c **** 
 497              		.loc 1 151 14 view .LVU145
 498 001a 42F00202 		orr	r2, r2, #2
 499 001e 1A60     		str	r2, [r3]
 500              		.loc 1 154 2 is_stmt 1 view .LVU146
 501              		.loc 1 154 15 is_stmt 0 view .LVU147
 502 0020 0368     		ldr	r3, [r0]
 155:src/drivers/ubertooth_dma.c **** 
 156:src/drivers/ubertooth_dma.c **** 	/* activate slave select pin */
 157:src/drivers/ubertooth_dma.c **** 	DIO_SSEL_CLR;
 503              		.loc 1 157 2 view .LVU148
 504 0022 074A     		ldr	r2, .L29+16
 154:src/drivers/ubertooth_dma.c **** 
 505              		.loc 1 154 15 view .LVU149
 506 0024 2343     		orrs	r3, r3, r4
 507 0026 0360     		str	r3, [r0]
 508              		.loc 1 157 2 is_stmt 1 view .LVU150
 158:src/drivers/ubertooth_dma.c **** }
 509              		.loc 1 158 1 is_stmt 0 view .LVU151
 510 0028 30BC     		pop	{r4, r5}
 511              		.cfi_restore 5
 512              		.cfi_restore 4
 513              		.cfi_def_cfa_offset 0
 157:src/drivers/ubertooth_dma.c **** }
 514              		.loc 1 157 2 view .LVU152
 515 002a 1160     		str	r1, [r2]
 516              		.loc 1 158 1 view .LVU153
ARM GAS  /tmp/ccTqO2DN.s 			page 14


 517 002c 7047     		bx	lr
 518              	.L30:
 519 002e 00BF     		.align	2
 520              	.L29:
 521 0030 04000340 		.word	1073938436
 522 0034 98C00920 		.word	537510040
 523 0038 24000340 		.word	1073938468
 524 003c 10410050 		.word	1342193936
 525 0040 9CC00920 		.word	537510044
 526              		.cfi_endproc
 527              	.LFE6:
 529              		.section	.text.dma_init_rx_single,"ax",%progbits
 530              		.align	1
 531              		.p2align 2,,3
 532              		.global	dma_init_rx_single
 533              		.syntax unified
 534              		.thumb
 535              		.thumb_func
 536              		.fpu softvfp
 538              	dma_init_rx_single:
 539              	.LVL7:
 540              	.LFB7:
 159:src/drivers/ubertooth_dma.c **** 
 160:src/drivers/ubertooth_dma.c **** void dma_init_rx_single(volatile void *buf, unsigned buf_size)
 161:src/drivers/ubertooth_dma.c **** {
 541              		.loc 1 161 1 is_stmt 1 view -0
 542              		.cfi_startproc
 543              		@ args = 0, pretend = 0, frame = 0
 544              		@ frame_needed = 0, uses_anonymous_args = 0
 545              		@ link register save eliminated.
 546              		.loc 1 161 1 is_stmt 0 view .LVU155
 547 0000 70B4     		push	{r4, r5, r6}
 548              		.cfi_def_cfa_offset 12
 549              		.cfi_offset 4, -12
 550              		.cfi_offset 5, -8
 551              		.cfi_offset 6, -4
 162:src/drivers/ubertooth_dma.c **** 	dma_user_rx_buf = buf;
 552              		.loc 1 162 2 is_stmt 1 view .LVU156
 163:src/drivers/ubertooth_dma.c **** 
 164:src/drivers/ubertooth_dma.c **** 	/* configure DMA channel 0: Rx single slot */
 165:src/drivers/ubertooth_dma.c **** 	DMACC0SrcAddr	= (uint32_t)&(DIO_SSP_DR);
 166:src/drivers/ubertooth_dma.c **** 	DMACC0DestAddr	= (uint32_t)buf;
 167:src/drivers/ubertooth_dma.c **** 	DMACC0LLI	= 0;
 553              		.loc 1 167 12 is_stmt 0 view .LVU157
 554 0002 0025     		movs	r5, #0
 168:src/drivers/ubertooth_dma.c **** 	// FIXME
 169:src/drivers/ubertooth_dma.c **** 	//DMACC0Control	= 4 |
 170:src/drivers/ubertooth_dma.c **** 	DMACC0Control	= buf_size |
 171:src/drivers/ubertooth_dma.c **** 			(1 << 12) |        /* source burst size = 1 */
 172:src/drivers/ubertooth_dma.c **** 			(0 << 15) |        /* destination burst size = 1 */
 173:src/drivers/ubertooth_dma.c **** 			(0 << 18) |        /* source width 8 bits */
 174:src/drivers/ubertooth_dma.c **** 			(0 << 21) |        /* destination width 8 bits */
 175:src/drivers/ubertooth_dma.c **** 			DMACCxControl_DI  /* destination increment */
 176:src/drivers/ubertooth_dma.c **** 			;
 177:src/drivers/ubertooth_dma.c **** 
 178:src/drivers/ubertooth_dma.c **** 	DMACC0Config	= DIO_SSP_SRC	/* Src periph (3 for Ubertooth One) */
 555              		.loc 1 178 15 view .LVU158
ARM GAS  /tmp/ccTqO2DN.s 			page 15


 556 0004 41F20602 		movw	r2, #4102
 162:src/drivers/ubertooth_dma.c **** 
 557              		.loc 1 162 18 view .LVU159
 558 0008 084B     		ldr	r3, .L32
 165:src/drivers/ubertooth_dma.c **** 	DMACC0DestAddr	= (uint32_t)buf;
 559              		.loc 1 165 16 view .LVU160
 560 000a 094C     		ldr	r4, .L32+4
 162:src/drivers/ubertooth_dma.c **** 
 561              		.loc 1 162 18 view .LVU161
 562 000c 1860     		str	r0, [r3]
 165:src/drivers/ubertooth_dma.c **** 	DMACC0DestAddr	= (uint32_t)buf;
 563              		.loc 1 165 2 is_stmt 1 view .LVU162
 165:src/drivers/ubertooth_dma.c **** 	DMACC0DestAddr	= (uint32_t)buf;
 564              		.loc 1 165 16 is_stmt 0 view .LVU163
 565 000e 094E     		ldr	r6, .L32+8
 166:src/drivers/ubertooth_dma.c **** 	DMACC0LLI	= 0;
 566              		.loc 1 166 17 view .LVU164
 567 0010 094B     		ldr	r3, .L32+12
 165:src/drivers/ubertooth_dma.c **** 	DMACC0DestAddr	= (uint32_t)buf;
 568              		.loc 1 165 16 view .LVU165
 569 0012 2660     		str	r6, [r4]
 166:src/drivers/ubertooth_dma.c **** 	DMACC0LLI	= 0;
 570              		.loc 1 166 2 is_stmt 1 view .LVU166
 174:src/drivers/ubertooth_dma.c **** 			DMACCxControl_DI  /* destination increment */
 571              		.loc 1 174 14 is_stmt 0 view .LVU167
 572 0014 41F00061 		orr	r1, r1, #134217728
 573              	.LVL8:
 166:src/drivers/ubertooth_dma.c **** 	DMACC0LLI	= 0;
 574              		.loc 1 166 17 view .LVU168
 575 0018 1860     		str	r0, [r3]
 167:src/drivers/ubertooth_dma.c **** 	// FIXME
 576              		.loc 1 167 2 is_stmt 1 view .LVU169
 170:src/drivers/ubertooth_dma.c **** 			(1 << 12) |        /* source burst size = 1 */
 577              		.loc 1 170 16 is_stmt 0 view .LVU170
 578 001a 0848     		ldr	r0, .L32+16
 579              	.LVL9:
 174:src/drivers/ubertooth_dma.c **** 			DMACCxControl_DI  /* destination increment */
 580              		.loc 1 174 14 view .LVU171
 581 001c 41F48051 		orr	r1, r1, #4096
 167:src/drivers/ubertooth_dma.c **** 	// FIXME
 582              		.loc 1 167 12 view .LVU172
 583 0020 A560     		str	r5, [r4, #8]
 584              	.LVL10:
 170:src/drivers/ubertooth_dma.c **** 			(1 << 12) |        /* source burst size = 1 */
 585              		.loc 1 170 2 is_stmt 1 view .LVU173
 170:src/drivers/ubertooth_dma.c **** 			(1 << 12) |        /* source burst size = 1 */
 586              		.loc 1 170 16 is_stmt 0 view .LVU174
 587 0022 0160     		str	r1, [r0]
 588              		.loc 1 178 2 is_stmt 1 view .LVU175
 179:src/drivers/ubertooth_dma.c **** 			| (0x2 << 11)	/* peripheral to memory */
 180:src/drivers/ubertooth_dma.c **** 			;
 181:src/drivers/ubertooth_dma.c **** }
 589              		.loc 1 181 1 is_stmt 0 view .LVU176
 590 0024 70BC     		pop	{r4, r5, r6}
 591              		.cfi_restore 6
 592              		.cfi_restore 5
 593              		.cfi_restore 4
ARM GAS  /tmp/ccTqO2DN.s 			page 16


 594              		.cfi_def_cfa_offset 0
 178:src/drivers/ubertooth_dma.c **** 			| (0x2 << 11)	/* peripheral to memory */
 595              		.loc 1 178 15 view .LVU177
 596 0026 DA60     		str	r2, [r3, #12]
 597              		.loc 1 181 1 view .LVU178
 598 0028 7047     		bx	lr
 599              	.L33:
 600 002a 00BF     		.align	2
 601              	.L32:
 602 002c 00000000 		.word	.LANCHOR0
 603 0030 00410050 		.word	1342193920
 604 0034 08000340 		.word	1073938440
 605 0038 04410050 		.word	1342193924
 606 003c 0C410050 		.word	1342193932
 607              		.cfi_endproc
 608              	.LFE7:
 610              		.section	.text.dma_get_rx_offset,"ax",%progbits
 611              		.align	1
 612              		.p2align 2,,3
 613              		.global	dma_get_rx_offset
 614              		.syntax unified
 615              		.thumb
 616              		.thumb_func
 617              		.fpu softvfp
 619              	dma_get_rx_offset:
 620              	.LFB8:
 182:src/drivers/ubertooth_dma.c **** 
 183:src/drivers/ubertooth_dma.c **** unsigned long dma_get_rx_offset(void)
 184:src/drivers/ubertooth_dma.c **** {
 621              		.loc 1 184 1 is_stmt 1 view -0
 622              		.cfi_startproc
 623              		@ args = 0, pretend = 0, frame = 0
 624              		@ frame_needed = 0, uses_anonymous_args = 0
 625              		@ link register save eliminated.
 185:src/drivers/ubertooth_dma.c **** 	return (unsigned long)DMACC0DestAddr - (unsigned long)dma_user_rx_buf;
 626              		.loc 1 185 2 view .LVU180
 627              		.loc 1 185 9 is_stmt 0 view .LVU181
 628 0000 024A     		ldr	r2, .L35
 629              		.loc 1 185 41 view .LVU182
 630 0002 034B     		ldr	r3, .L35+4
 631              		.loc 1 185 9 view .LVU183
 632 0004 1068     		ldr	r0, [r2]
 633              		.loc 1 185 39 view .LVU184
 634 0006 1B68     		ldr	r3, [r3]
 186:src/drivers/ubertooth_dma.c **** }
 635              		.loc 1 186 1 view .LVU185
 636 0008 C01A     		subs	r0, r0, r3
 637 000a 7047     		bx	lr
 638              	.L36:
 639              		.align	2
 640              	.L35:
 641 000c 04410050 		.word	1342193924
 642 0010 00000000 		.word	.LANCHOR0
 643              		.cfi_endproc
 644              	.LFE8:
 646              		.section	.text.dma_get_error,"ax",%progbits
 647              		.align	1
ARM GAS  /tmp/ccTqO2DN.s 			page 17


 648              		.p2align 2,,3
 649              		.global	dma_get_error
 650              		.syntax unified
 651              		.thumb
 652              		.thumb_func
 653              		.fpu softvfp
 655              	dma_get_error:
 656              	.LFB9:
 187:src/drivers/ubertooth_dma.c **** 
 188:src/drivers/ubertooth_dma.c **** #ifdef USE_TX_DMA
 189:src/drivers/ubertooth_dma.c **** void dio_ssp_start_tx(void)
 190:src/drivers/ubertooth_dma.c **** {
 191:src/drivers/ubertooth_dma.c **** 	DIO_SSEL_SET;
 192:src/drivers/ubertooth_dma.c **** 
 193:src/drivers/ubertooth_dma.c **** 	/* Configure RX DMA on CC2400 SPI (SSP1 for Ubertooth One) */
 194:src/drivers/ubertooth_dma.c **** 	DIO_SSP_DMACR = SSPDMACR_TXDMAE ;
 195:src/drivers/ubertooth_dma.c **** 	/* Configuration of DMA : Slave, Slave output disable
 196:src/drivers/ubertooth_dma.c **** 	 */
 197:src/drivers/ubertooth_dma.c **** 	//DIO_SSP_CR1 = SSPCR1_MS;
 198:src/drivers/ubertooth_dma.c **** 	//DIO_SSP_CR1 = 0;// Master
 199:src/drivers/ubertooth_dma.c **** 	DIO_SSP_CR1 = SSPCR1_MS | SSPCR1_SOD;
 200:src/drivers/ubertooth_dma.c **** 
 201:src/drivers/ubertooth_dma.c **** 	/* Enable CC2400 SPI peripheral */
 202:src/drivers/ubertooth_dma.c **** 	DIO_SSP_CR1 |= SSPCR1_SSE;
 203:src/drivers/ubertooth_dma.c **** 
 204:src/drivers/ubertooth_dma.c **** 	// enable channel 1
 205:src/drivers/ubertooth_dma.c **** 	DMACC1Config |= 1;
 206:src/drivers/ubertooth_dma.c **** 
 207:src/drivers/ubertooth_dma.c **** 	/* activate slave select pin */
 208:src/drivers/ubertooth_dma.c **** 	DIO_SSEL_CLR;
 209:src/drivers/ubertooth_dma.c **** }
 210:src/drivers/ubertooth_dma.c **** 
 211:src/drivers/ubertooth_dma.c **** void dma_init_tx_single(volatile void *buf, unsigned buf_size, dma_tx_cb_t cb, void *cb_arg)
 212:src/drivers/ubertooth_dma.c **** {
 213:src/drivers/ubertooth_dma.c **** 	dma_user_tx_buf = buf;
 214:src/drivers/ubertooth_dma.c **** 	dma_user_tx_cb = cb;
 215:src/drivers/ubertooth_dma.c **** 	dma_user_tx_cb_arg = cb_arg;
 216:src/drivers/ubertooth_dma.c **** 
 217:src/drivers/ubertooth_dma.c **** 	/* configure DMA channel 1: Tx single slot */
 218:src/drivers/ubertooth_dma.c **** 	DMACC1SrcAddr	= (uint32_t)buf;
 219:src/drivers/ubertooth_dma.c **** 	DMACC1DestAddr	= (uint32_t)&(DIO_SSP_DR);
 220:src/drivers/ubertooth_dma.c **** 	DMACC1LLI	= 0;
 221:src/drivers/ubertooth_dma.c **** 	DMACC1Control	= buf_size |
 222:src/drivers/ubertooth_dma.c **** 			(1 << 12) |        /* source burst size = 1 */
 223:src/drivers/ubertooth_dma.c **** 			(0 << 15) |        /* destination burst size = 1 */
 224:src/drivers/ubertooth_dma.c **** 			(0 << 18) |        /* source width 8 bits */
 225:src/drivers/ubertooth_dma.c **** 			(0 << 21) |        /* destination width 8 bits */
 226:src/drivers/ubertooth_dma.c **** 			DMACCxControl_SI | /* Source increment */
 227:src/drivers/ubertooth_dma.c **** 			DMACCxControl_I;   /* terminal count interrupt enable */
 228:src/drivers/ubertooth_dma.c **** 
 229:src/drivers/ubertooth_dma.c **** 	DMACC1Config	= DIO_SSP_DST		/* SSP TX (3for Ubertooth One) */
 230:src/drivers/ubertooth_dma.c **** 			| DMACCxConfig_ITC 	/* Enable Terminal Count interrupts */
 231:src/drivers/ubertooth_dma.c **** 			| DMACCxConfig_IE 	/* Enable Error interrupts */
 232:src/drivers/ubertooth_dma.c **** 			| (0x1 << 11);	/* memory to peripheral */
 233:src/drivers/ubertooth_dma.c **** }
 234:src/drivers/ubertooth_dma.c **** unsigned long dma_get_tx_offset(void)
 235:src/drivers/ubertooth_dma.c **** {
ARM GAS  /tmp/ccTqO2DN.s 			page 18


 236:src/drivers/ubertooth_dma.c **** 	return (unsigned long)DMACC1SrcAddr - (unsigned long)dma_user_tx_buf;
 237:src/drivers/ubertooth_dma.c **** }
 238:src/drivers/ubertooth_dma.c **** #endif
 239:src/drivers/ubertooth_dma.c **** 
 240:src/drivers/ubertooth_dma.c **** int dma_get_error(void)
 241:src/drivers/ubertooth_dma.c **** {
 657              		.loc 1 241 1 is_stmt 1 view -0
 658              		.cfi_startproc
 659              		@ args = 0, pretend = 0, frame = 0
 660              		@ frame_needed = 0, uses_anonymous_args = 0
 661              		@ link register save eliminated.
 242:src/drivers/ubertooth_dma.c **** 	return 0;
 662              		.loc 1 242 2 view .LVU187
 243:src/drivers/ubertooth_dma.c **** }
 663              		.loc 1 243 1 is_stmt 0 view .LVU188
 664 0000 0020     		movs	r0, #0
 665 0002 7047     		bx	lr
 666              		.cfi_endproc
 667              	.LFE9:
 669              		.global	dma_user_tx_cb_arg
 670              		.global	dma_user_tx_cb
 671              		.global	dma_user_tx_buf
 672              		.global	dma_user_rx_buf
 673              		.comm	dma_rx_lli,16,4
 674              		.bss
 675              		.align	2
 676              		.set	.LANCHOR0,. + 0
 679              	dma_user_rx_buf:
 680 0000 00000000 		.space	4
 683              	dma_user_tx_cb_arg:
 684 0004 00000000 		.space	4
 687              	dma_user_tx_cb:
 688 0008 00000000 		.space	4
 691              	dma_user_tx_buf:
 692 000c 00000000 		.space	4
 693              		.text
 694              	.Letext0:
 695              		.file 2 "/usr/lib/gcc/arm-none-eabi/9.2.1/include/stdint.h"
 696              		.file 3 "../common/ubertooth.h"
 697              		.file 4 "include/ubtbr/ubertooth_dma.h"
 698              		.file 5 "include/ubtbr/debug.h"
ARM GAS  /tmp/ccTqO2DN.s 			page 19


DEFINED SYMBOLS
                            *ABS*:0000000000000000 ubertooth_dma.c
     /tmp/ccTqO2DN.s:16     .rodata.str1.4:0000000000000000 $d
     /tmp/ccTqO2DN.s:20     .text.DMA_IRQHandler:0000000000000000 $t
     /tmp/ccTqO2DN.s:29     .text.DMA_IRQHandler:0000000000000000 DMA_IRQHandler
     /tmp/ccTqO2DN.s:62     .text.DMA_IRQHandler:0000000000000018 $d
     /tmp/ccTqO2DN.s:70     .text.dma_poweron:0000000000000000 $t
     /tmp/ccTqO2DN.s:78     .text.dma_poweron:0000000000000000 dma_poweron
     /tmp/ccTqO2DN.s:180    .text.dma_poweron:000000000000005c $d
     /tmp/ccTqO2DN.s:191    .text.dma_poweroff:0000000000000000 $t
     /tmp/ccTqO2DN.s:199    .text.dma_poweroff:0000000000000000 dma_poweroff
     /tmp/ccTqO2DN.s:242    .text.dma_poweroff:0000000000000028 $d
     /tmp/ccTqO2DN.s:249    .text.dma_clear_interrupts:0000000000000000 $t
     /tmp/ccTqO2DN.s:257    .text.dma_clear_interrupts:0000000000000000 dma_clear_interrupts
     /tmp/ccTqO2DN.s:286    .text.dma_clear_interrupts:0000000000000010 $d
     /tmp/ccTqO2DN.s:296    .text.dio_ssp_stop:0000000000000000 $t
     /tmp/ccTqO2DN.s:304    .text.dio_ssp_stop:0000000000000000 dio_ssp_stop
     /tmp/ccTqO2DN.s:440    .text.dio_ssp_stop:0000000000000054 $d
     /tmp/ccTqO2DN.s:453    .text.dio_ssp_start_rx:0000000000000000 $t
     /tmp/ccTqO2DN.s:461    .text.dio_ssp_start_rx:0000000000000000 dio_ssp_start_rx
     /tmp/ccTqO2DN.s:521    .text.dio_ssp_start_rx:0000000000000030 $d
     /tmp/ccTqO2DN.s:530    .text.dma_init_rx_single:0000000000000000 $t
     /tmp/ccTqO2DN.s:538    .text.dma_init_rx_single:0000000000000000 dma_init_rx_single
     /tmp/ccTqO2DN.s:602    .text.dma_init_rx_single:000000000000002c $d
     /tmp/ccTqO2DN.s:611    .text.dma_get_rx_offset:0000000000000000 $t
     /tmp/ccTqO2DN.s:619    .text.dma_get_rx_offset:0000000000000000 dma_get_rx_offset
     /tmp/ccTqO2DN.s:641    .text.dma_get_rx_offset:000000000000000c $d
     /tmp/ccTqO2DN.s:647    .text.dma_get_error:0000000000000000 $t
     /tmp/ccTqO2DN.s:655    .text.dma_get_error:0000000000000000 dma_get_error
     /tmp/ccTqO2DN.s:683    .bss:0000000000000004 dma_user_tx_cb_arg
     /tmp/ccTqO2DN.s:687    .bss:0000000000000008 dma_user_tx_cb
     /tmp/ccTqO2DN.s:691    .bss:000000000000000c dma_user_tx_buf
     /tmp/ccTqO2DN.s:679    .bss:0000000000000000 dma_user_rx_buf
                            *COM*:0000000000000010 dma_rx_lli
     /tmp/ccTqO2DN.s:675    .bss:0000000000000000 $d

UNDEFINED SYMBOLS
cprintf
