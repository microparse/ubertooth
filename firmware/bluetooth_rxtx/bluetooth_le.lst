ARM GAS  /tmp/cc22nK0G.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 4
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"bluetooth_le.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.btle_channel_index,"ax",%progbits
  16              		.align	1
  17              		.global	btle_channel_index
  18              		.arch armv7-m
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu softvfp
  24              	btle_channel_index:
  25              	.LVL0:
  26              	.LFB1:
  27              		.file 1 "bluetooth_le.c"
   1:bluetooth_le.c **** /*
   2:bluetooth_le.c ****  * Copyright 2012 Dominic Spill
   3:bluetooth_le.c ****  *
   4:bluetooth_le.c ****  * This file is part of Project Ubertooth.
   5:bluetooth_le.c ****  *
   6:bluetooth_le.c ****  * This program is free software; you can redistribute it and/or modify
   7:bluetooth_le.c ****  * it under the terms of the GNU General Public License as published by
   8:bluetooth_le.c ****  * the Free Software Foundation; either version 2, or (at your option)
   9:bluetooth_le.c ****  * any later version.
  10:bluetooth_le.c ****  *
  11:bluetooth_le.c ****  * This program is distributed in the hope that it will be useful,
  12:bluetooth_le.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  13:bluetooth_le.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  14:bluetooth_le.c ****  * GNU General Public License for more details.
  15:bluetooth_le.c ****  *
  16:bluetooth_le.c ****  * You should have received a copy of the GNU General Public License
  17:bluetooth_le.c ****  * along with this program; see the file COPYING.  If not, write to
  18:bluetooth_le.c ****  * the Free Software Foundation, Inc., 51 Franklin Street,
  19:bluetooth_le.c ****  * Boston, MA 02110-1301, USA.
  20:bluetooth_le.c ****  */
  21:bluetooth_le.c **** 
  22:bluetooth_le.c **** #include "bluetooth_le.h"
  23:bluetooth_le.c **** 
  24:bluetooth_le.c **** #include <string.h>
  25:bluetooth_le.c **** 
  26:bluetooth_le.c **** extern u8 le_channel_idx;
  27:bluetooth_le.c **** extern u8 le_hop_amount;
  28:bluetooth_le.c **** 
  29:bluetooth_le.c **** u16 btle_next_hop(le_state_t *le)
  30:bluetooth_le.c **** {
  31:bluetooth_le.c **** 	u16 phys = btle_channel_index_to_phys(le->channel_idx);
ARM GAS  /tmp/cc22nK0G.s 			page 2


  32:bluetooth_le.c **** 	le->channel_idx = (le->channel_idx + le->channel_increment) % 37;
  33:bluetooth_le.c **** 	return phys;
  34:bluetooth_le.c **** }
  35:bluetooth_le.c **** 
  36:bluetooth_le.c **** // calculate channel index from physical channel
  37:bluetooth_le.c **** // channel is in range [2402, 2480]
  38:bluetooth_le.c **** uint8_t btle_channel_index(uint16_t channel) {
  28              		.loc 1 38 46 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  33              		.loc 1 38 46 is_stmt 0 view .LVU1
  39:bluetooth_le.c **** 	uint8_t idx;
  34              		.loc 1 39 2 is_stmt 1 view .LVU2
  40:bluetooth_le.c **** 	channel = (channel - 2402) / 2;
  35              		.loc 1 40 2 view .LVU3
  36              		.loc 1 40 21 is_stmt 0 view .LVU4
  37 0000 A0F66213 		subw	r3, r0, #2402
  38              		.loc 1 40 29 view .LVU5
  39 0004 03EBD373 		add	r3, r3, r3, lsr #31
  40 0008 5810     		asrs	r0, r3, #1
  41              	.LVL1:
  42              		.loc 1 40 10 view .LVU6
  43 000a C3F34F03 		ubfx	r3, r3, #1, #16
  44              	.LVL2:
  41:bluetooth_le.c **** 	if (channel == 0)
  45              		.loc 1 41 2 is_stmt 1 view .LVU7
  46              		.loc 1 41 5 is_stmt 0 view .LVU8
  47 000e 53B1     		cbz	r3, .L4
  42:bluetooth_le.c **** 		idx = 37;
  43:bluetooth_le.c **** 	else if (channel < 12)
  48              		.loc 1 43 7 is_stmt 1 view .LVU9
  49              		.loc 1 43 10 is_stmt 0 view .LVU10
  50 0010 0B2B     		cmp	r3, #11
  51 0012 02D8     		bhi	.L3
  44:bluetooth_le.c **** 		idx = channel - 1;
  52              		.loc 1 44 3 is_stmt 1 view .LVU11
  53              		.loc 1 44 7 is_stmt 0 view .LVU12
  54 0014 0138     		subs	r0, r0, #1
  55              	.L7:
  45:bluetooth_le.c **** 	else if (channel == 12)
  46:bluetooth_le.c **** 		idx = 38;
  47:bluetooth_le.c **** 	else if (channel < 39)
  48:bluetooth_le.c **** 		idx = channel - 2;
  56              		.loc 1 48 7 view .LVU13
  57 0016 C0B2     		uxtb	r0, r0
  58              	.LVL3:
  59              		.loc 1 48 7 view .LVU14
  60 0018 7047     		bx	lr
  61              	.LVL4:
  62              	.L3:
  45:bluetooth_le.c **** 	else if (channel == 12)
  63              		.loc 1 45 7 is_stmt 1 view .LVU15
  45:bluetooth_le.c **** 	else if (channel == 12)
  64              		.loc 1 45 10 is_stmt 0 view .LVU16
  65 001a 0C2B     		cmp	r3, #12
ARM GAS  /tmp/cc22nK0G.s 			page 3


  66 001c 05D0     		beq	.L5
  47:bluetooth_le.c **** 		idx = channel - 2;
  67              		.loc 1 47 7 is_stmt 1 view .LVU17
  47:bluetooth_le.c **** 		idx = channel - 2;
  68              		.loc 1 47 10 is_stmt 0 view .LVU18
  69 001e 262B     		cmp	r3, #38
  70 0020 05D8     		bhi	.L6
  71              		.loc 1 48 3 is_stmt 1 view .LVU19
  72              		.loc 1 48 7 is_stmt 0 view .LVU20
  73 0022 0238     		subs	r0, r0, #2
  74 0024 F7E7     		b	.L7
  75              	.L4:
  42:bluetooth_le.c **** 	else if (channel < 12)
  76              		.loc 1 42 7 view .LVU21
  77 0026 2520     		movs	r0, #37
  78 0028 7047     		bx	lr
  79              	.L5:
  46:bluetooth_le.c **** 	else if (channel < 39)
  80              		.loc 1 46 7 view .LVU22
  81 002a 2620     		movs	r0, #38
  82 002c 7047     		bx	lr
  83              	.L6:
  49:bluetooth_le.c **** 	else
  50:bluetooth_le.c **** 		idx = 39;
  84              		.loc 1 50 7 view .LVU23
  85 002e 2720     		movs	r0, #39
  86              	.LVL5:
  51:bluetooth_le.c **** 	return idx;
  87              		.loc 1 51 2 is_stmt 1 view .LVU24
  52:bluetooth_le.c **** }
  88              		.loc 1 52 1 is_stmt 0 view .LVU25
  89 0030 7047     		bx	lr
  90              		.cfi_endproc
  91              	.LFE1:
  93              		.section	.text.btle_channel_index_to_phys,"ax",%progbits
  94              		.align	1
  95              		.global	btle_channel_index_to_phys
  96              		.syntax unified
  97              		.thumb
  98              		.thumb_func
  99              		.fpu softvfp
 101              	btle_channel_index_to_phys:
 102              	.LVL6:
 103              	.LFB2:
  53:bluetooth_le.c **** 
  54:bluetooth_le.c **** u16 btle_channel_index_to_phys(u8 idx) {
 104              		.loc 1 54 40 is_stmt 1 view -0
 105              		.cfi_startproc
 106              		@ args = 0, pretend = 0, frame = 0
 107              		@ frame_needed = 0, uses_anonymous_args = 0
 108              		@ link register save eliminated.
 109              		.loc 1 54 40 is_stmt 0 view .LVU27
  55:bluetooth_le.c **** 	u16 phys;
 110              		.loc 1 55 2 is_stmt 1 view .LVU28
  56:bluetooth_le.c **** 	if (idx < 11)
 111              		.loc 1 56 2 view .LVU29
 112              		.loc 1 56 5 is_stmt 0 view .LVU30
ARM GAS  /tmp/cc22nK0G.s 			page 4


 113 0000 0A28     		cmp	r0, #10
 114 0002 03D8     		bhi	.L9
  57:bluetooth_le.c **** 		phys = 2404 + 2 * idx;
 115              		.loc 1 57 3 is_stmt 1 view .LVU31
 116              		.loc 1 57 15 is_stmt 0 view .LVU32
 117 0004 00F2B240 		addw	r0, r0, #1202
 118              	.LVL7:
 119              	.L14:
  58:bluetooth_le.c **** 	else if (idx < 37)
  59:bluetooth_le.c **** 		phys = 2428 + 2 * (idx - 11);
 120              		.loc 1 59 8 view .LVU33
 121 0008 4000     		lsls	r0, r0, #1
 122              	.LVL8:
 123              		.loc 1 59 8 view .LVU34
 124 000a 7047     		bx	lr
 125              	.LVL9:
 126              	.L9:
  58:bluetooth_le.c **** 	else if (idx < 37)
 127              		.loc 1 58 7 is_stmt 1 view .LVU35
  58:bluetooth_le.c **** 	else if (idx < 37)
 128              		.loc 1 58 10 is_stmt 0 view .LVU36
 129 000c 2428     		cmp	r0, #36
 130 000e 02D8     		bhi	.L11
 131              		.loc 1 59 3 is_stmt 1 view .LVU37
 132              		.loc 1 59 15 is_stmt 0 view .LVU38
 133 0010 00F2B340 		addw	r0, r0, #1203
 134              	.LVL10:
 135              		.loc 1 59 15 view .LVU39
 136 0014 F8E7     		b	.L14
 137              	.LVL11:
 138              	.L11:
 139              	.LBB4:
 140              	.LBI4:
  54:bluetooth_le.c **** 	u16 phys;
 141              		.loc 1 54 5 is_stmt 1 view .LVU40
 142              	.LBB5:
  60:bluetooth_le.c **** 	else if (idx == 37)
 143              		.loc 1 60 7 view .LVU41
 144              		.loc 1 60 10 is_stmt 0 view .LVU42
 145 0016 2528     		cmp	r0, #37
 146 0018 06D0     		beq	.L12
  61:bluetooth_le.c **** 		phys = 2402;
  62:bluetooth_le.c **** 	else if (idx == 38)
 147              		.loc 1 62 7 is_stmt 1 view .LVU43
 148              		.loc 1 62 10 is_stmt 0 view .LVU44
 149 001a 2628     		cmp	r0, #38
  63:bluetooth_le.c **** 		phys = 2426;
  64:bluetooth_le.c **** 	else
  65:bluetooth_le.c **** 		phys = 2480;
 150              		.loc 1 65 8 view .LVU45
 151 001c 40F67A10 		movw	r0, #2426
 152              	.LVL12:
 153              		.loc 1 65 8 view .LVU46
 154 0020 18BF     		it	ne
 155 0022 4FF41B60 		movne	r0, #2480
 156 0026 7047     		bx	lr
 157              	.LVL13:
ARM GAS  /tmp/cc22nK0G.s 			page 5


 158              	.L12:
  61:bluetooth_le.c **** 		phys = 2402;
 159              		.loc 1 61 8 view .LVU47
 160 0028 40F66210 		movw	r0, #2402
 161              	.LVL14:
  61:bluetooth_le.c **** 		phys = 2402;
 162              		.loc 1 61 8 view .LVU48
 163              	.LBE5:
 164              	.LBE4:
  66:bluetooth_le.c **** 	return phys;
 165              		.loc 1 66 2 is_stmt 1 view .LVU49
  67:bluetooth_le.c **** }
 166              		.loc 1 67 1 is_stmt 0 view .LVU50
 167 002c 7047     		bx	lr
 168              		.cfi_endproc
 169              	.LFE2:
 171              		.section	.text.btle_next_hop,"ax",%progbits
 172              		.align	1
 173              		.global	btle_next_hop
 174              		.syntax unified
 175              		.thumb
 176              		.thumb_func
 177              		.fpu softvfp
 179              	btle_next_hop:
 180              	.LVL15:
 181              	.LFB0:
  30:bluetooth_le.c **** 	u16 phys = btle_channel_index_to_phys(le->channel_idx);
 182              		.loc 1 30 1 is_stmt 1 view -0
 183              		.cfi_startproc
 184              		@ args = 0, pretend = 0, frame = 0
 185              		@ frame_needed = 0, uses_anonymous_args = 0
  30:bluetooth_le.c **** 	u16 phys = btle_channel_index_to_phys(le->channel_idx);
 186              		.loc 1 30 1 is_stmt 0 view .LVU52
 187 0000 10B5     		push	{r4, lr}
 188              		.cfi_def_cfa_offset 8
 189              		.cfi_offset 4, -8
 190              		.cfi_offset 14, -4
  31:bluetooth_le.c **** 	le->channel_idx = (le->channel_idx + le->channel_increment) % 37;
 191              		.loc 1 31 2 is_stmt 1 view .LVU53
  31:bluetooth_le.c **** 	le->channel_idx = (le->channel_idx + le->channel_increment) % 37;
 192              		.loc 1 31 13 is_stmt 0 view .LVU54
 193 0002 417D     		ldrb	r1, [r0, #21]	@ zero_extendqisi2
  30:bluetooth_le.c **** 	u16 phys = btle_channel_index_to_phys(le->channel_idx);
 194              		.loc 1 30 1 view .LVU55
 195 0004 0346     		mov	r3, r0
  31:bluetooth_le.c **** 	le->channel_idx = (le->channel_idx + le->channel_increment) % 37;
 196              		.loc 1 31 13 view .LVU56
 197 0006 0846     		mov	r0, r1
 198              	.LVL16:
  31:bluetooth_le.c **** 	le->channel_idx = (le->channel_idx + le->channel_increment) % 37;
 199              		.loc 1 31 13 view .LVU57
 200 0008 FFF7FEFF 		bl	btle_channel_index_to_phys
 201              	.LVL17:
  32:bluetooth_le.c **** 	return phys;
 202              		.loc 1 32 2 is_stmt 1 view .LVU58
  32:bluetooth_le.c **** 	return phys;
 203              		.loc 1 32 62 is_stmt 0 view .LVU59
ARM GAS  /tmp/cc22nK0G.s 			page 6


 204 000c 2524     		movs	r4, #37
  32:bluetooth_le.c **** 	return phys;
 205              		.loc 1 32 41 view .LVU60
 206 000e 9A7D     		ldrb	r2, [r3, #22]	@ zero_extendqisi2
  32:bluetooth_le.c **** 	return phys;
 207              		.loc 1 32 37 view .LVU61
 208 0010 0A44     		add	r2, r2, r1
  32:bluetooth_le.c **** 	return phys;
 209              		.loc 1 32 62 view .LVU62
 210 0012 B2FBF4F1 		udiv	r1, r2, r4
 211 0016 04FB1122 		mls	r2, r4, r1, r2
  32:bluetooth_le.c **** 	return phys;
 212              		.loc 1 32 18 view .LVU63
 213 001a 5A75     		strb	r2, [r3, #21]
  33:bluetooth_le.c **** }
 214              		.loc 1 33 2 is_stmt 1 view .LVU64
  34:bluetooth_le.c **** 
 215              		.loc 1 34 1 is_stmt 0 view .LVU65
 216 001c 10BD     		pop	{r4, pc}
 217              		.cfi_endproc
 218              	.LFE0:
 220              		.section	.text.btle_calc_crc,"ax",%progbits
 221              		.align	1
 222              		.global	btle_calc_crc
 223              		.syntax unified
 224              		.thumb
 225              		.thumb_func
 226              		.fpu softvfp
 228              	btle_calc_crc:
 229              	.LVL18:
 230              	.LFB3:
  68:bluetooth_le.c **** 
  69:bluetooth_le.c **** // calculate CRC
  70:bluetooth_le.c **** //	note 1: crc_init's bits should be in reverse order
  71:bluetooth_le.c **** //	note 2: output bytes are in reverse order compared to wire
  72:bluetooth_le.c **** //
  73:bluetooth_le.c **** //		example output:
  74:bluetooth_le.c **** //			0x6ff46e
  75:bluetooth_le.c **** //
  76:bluetooth_le.c **** //		bytes in packet will be:
  77:bluetooth_le.c **** //		  { 0x6e, 0xf4, 0x6f }
  78:bluetooth_le.c **** //
  79:bluetooth_le.c **** u32 btle_calc_crc(u32 crc_init, u8 *data, int len) {
 231              		.loc 1 79 52 is_stmt 1 view -0
 232              		.cfi_startproc
 233              		@ args = 0, pretend = 0, frame = 0
 234              		@ frame_needed = 0, uses_anonymous_args = 0
 235              		.loc 1 79 52 is_stmt 0 view .LVU67
 236 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 237              		.cfi_def_cfa_offset 20
 238              		.cfi_offset 4, -20
 239              		.cfi_offset 5, -16
 240              		.cfi_offset 6, -12
 241              		.cfi_offset 7, -8
 242              		.cfi_offset 14, -4
  80:bluetooth_le.c **** 	u32 state = crc_init & 0xffffff;
 243              		.loc 1 80 2 is_stmt 1 view .LVU68
ARM GAS  /tmp/cc22nK0G.s 			page 7


  81:bluetooth_le.c **** 	u32 lfsr_mask = 0x5a6000; // 010110100110000000000000
  82:bluetooth_le.c **** 	int i, j;
  83:bluetooth_le.c **** 
  84:bluetooth_le.c **** 	for (i = 0; i < len; ++i) {
 244              		.loc 1 84 9 is_stmt 0 view .LVU69
 245 0002 0023     		movs	r3, #0
 246              	.LBB6:
 247              	.LBB7:
  85:bluetooth_le.c **** 		u8 cur = data[i];
  86:bluetooth_le.c **** 		for (j = 0; j < 8; ++j) {
  87:bluetooth_le.c **** 			int next_bit = (state ^ cur) & 1;
  88:bluetooth_le.c **** 			cur >>= 1;
  89:bluetooth_le.c **** 			state >>= 1;
  90:bluetooth_le.c **** 			if (next_bit) {
  91:bluetooth_le.c **** 				state |= 1 << 23;
  92:bluetooth_le.c **** 				state ^= lfsr_mask;
 248              		.loc 1 92 11 view .LVU70
 249 0004 0A4F     		ldr	r7, .L25
 250              	.LBE7:
 251              	.LBE6:
  80:bluetooth_le.c **** 	u32 lfsr_mask = 0x5a6000; // 010110100110000000000000
 252              		.loc 1 80 6 view .LVU71
 253 0006 20F07F40 		bic	r0, r0, #-16777216
 254              	.LVL19:
  81:bluetooth_le.c **** 	u32 lfsr_mask = 0x5a6000; // 010110100110000000000000
 255              		.loc 1 81 2 is_stmt 1 view .LVU72
  82:bluetooth_le.c **** 
 256              		.loc 1 82 2 view .LVU73
  84:bluetooth_le.c **** 		u8 cur = data[i];
 257              		.loc 1 84 2 view .LVU74
 258              	.L17:
  84:bluetooth_le.c **** 		u8 cur = data[i];
 259              		.loc 1 84 14 discriminator 1 view .LVU75
  84:bluetooth_le.c **** 		u8 cur = data[i];
 260              		.loc 1 84 2 is_stmt 0 discriminator 1 view .LVU76
 261 000a 9342     		cmp	r3, r2
 262 000c 00DB     		blt	.L20
  93:bluetooth_le.c **** 			}
  94:bluetooth_le.c **** 		}
  95:bluetooth_le.c **** 	}
  96:bluetooth_le.c **** 
  97:bluetooth_le.c **** 	return state;
  98:bluetooth_le.c **** }
 263              		.loc 1 98 1 view .LVU77
 264 000e F0BD     		pop	{r4, r5, r6, r7, pc}
 265              	.L20:
 266              	.LBB10:
  85:bluetooth_le.c **** 		for (j = 0; j < 8; ++j) {
 267              		.loc 1 85 3 is_stmt 1 view .LVU78
  85:bluetooth_le.c **** 		for (j = 0; j < 8; ++j) {
 268              		.loc 1 85 6 is_stmt 0 view .LVU79
 269 0010 0824     		movs	r4, #8
 270 0012 CD5C     		ldrb	r5, [r1, r3]	@ zero_extendqisi2
 271              	.LVL20:
  86:bluetooth_le.c **** 			int next_bit = (state ^ cur) & 1;
 272              		.loc 1 86 3 is_stmt 1 view .LVU80
  86:bluetooth_le.c **** 			int next_bit = (state ^ cur) & 1;
ARM GAS  /tmp/cc22nK0G.s 			page 8


 273              		.loc 1 86 15 view .LVU81
 274              	.L19:
 275              	.LBB8:
  87:bluetooth_le.c **** 			cur >>= 1;
 276              		.loc 1 87 4 view .LVU82
  88:bluetooth_le.c **** 			state >>= 1;
 277              		.loc 1 88 4 view .LVU83
  89:bluetooth_le.c **** 			if (next_bit) {
 278              		.loc 1 89 4 view .LVU84
  90:bluetooth_le.c **** 				state |= 1 << 23;
 279              		.loc 1 90 4 view .LVU85
  87:bluetooth_le.c **** 			cur >>= 1;
 280              		.loc 1 87 26 is_stmt 0 view .LVU86
 281 0014 85EA0006 		eor	r6, r5, r0
  90:bluetooth_le.c **** 				state |= 1 << 23;
 282              		.loc 1 90 7 view .LVU87
 283 0018 16F0010F 		tst	r6, #1
 284 001c 4FEA5000 		lsr	r0, r0, #1
 285              	.LVL21:
  92:bluetooth_le.c **** 			}
 286              		.loc 1 92 11 view .LVU88
 287 0020 18BF     		it	ne
 288 0022 7840     		eorne	r0, r0, r7
 289              	.LBE8:
  86:bluetooth_le.c **** 			int next_bit = (state ^ cur) & 1;
 290              		.loc 1 86 3 view .LVU89
 291 0024 013C     		subs	r4, r4, #1
 292              	.LVL22:
 293              	.LBB9:
  90:bluetooth_le.c **** 				state |= 1 << 23;
 294              		.loc 1 90 7 view .LVU90
 295 0026 4FEA5505 		lsr	r5, r5, #1
 296              	.LVL23:
  91:bluetooth_le.c **** 				state ^= lfsr_mask;
 297              		.loc 1 91 5 is_stmt 1 view .LVU91
  92:bluetooth_le.c **** 			}
 298              		.loc 1 92 5 view .LVU92
  92:bluetooth_le.c **** 			}
 299              		.loc 1 92 5 is_stmt 0 view .LVU93
 300              	.LBE9:
  86:bluetooth_le.c **** 			int next_bit = (state ^ cur) & 1;
 301              		.loc 1 86 22 is_stmt 1 view .LVU94
  86:bluetooth_le.c **** 			int next_bit = (state ^ cur) & 1;
 302              		.loc 1 86 15 view .LVU95
  86:bluetooth_le.c **** 			int next_bit = (state ^ cur) & 1;
 303              		.loc 1 86 3 is_stmt 0 view .LVU96
 304 002a F3D1     		bne	.L19
 305              	.LBE10:
  84:bluetooth_le.c **** 		u8 cur = data[i];
 306              		.loc 1 84 23 is_stmt 1 discriminator 2 view .LVU97
 307 002c 0133     		adds	r3, r3, #1
 308              	.LVL24:
  84:bluetooth_le.c **** 		u8 cur = data[i];
 309              		.loc 1 84 23 is_stmt 0 discriminator 2 view .LVU98
 310 002e ECE7     		b	.L17
 311              	.L26:
 312              		.align	2
ARM GAS  /tmp/cc22nK0G.s 			page 9


 313              	.L25:
 314 0030 0060DA00 		.word	14311424
 315              		.cfi_endproc
 316              	.LFE3:
 318              		.section	.text.btle_reverse_crc,"ax",%progbits
 319              		.align	1
 320              		.global	btle_reverse_crc
 321              		.syntax unified
 322              		.thumb
 323              		.thumb_func
 324              		.fpu softvfp
 326              	btle_reverse_crc:
 327              	.LVL25:
 328              	.LFB4:
  99:bluetooth_le.c **** 
 100:bluetooth_le.c **** // runs the CRC in reverse to generate a CRCInit
 101:bluetooth_le.c **** //
 102:bluetooth_le.c **** //	crc should be big endian
 103:bluetooth_le.c **** //	the return will be big endian
 104:bluetooth_le.c **** //
 105:bluetooth_le.c **** u32 btle_reverse_crc(u32 crc, u8 *data, int len) {
 329              		.loc 1 105 50 is_stmt 1 view -0
 330              		.cfi_startproc
 331              		@ args = 0, pretend = 0, frame = 0
 332              		@ frame_needed = 0, uses_anonymous_args = 0
 333              		.loc 1 105 50 is_stmt 0 view .LVU100
 334 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 335              		.cfi_def_cfa_offset 20
 336              		.cfi_offset 4, -20
 337              		.cfi_offset 5, -16
 338              		.cfi_offset 6, -12
 339              		.cfi_offset 7, -8
 340              		.cfi_offset 14, -4
 106:bluetooth_le.c **** 	u32 state = crc;
 341              		.loc 1 106 2 is_stmt 1 view .LVU101
 105:bluetooth_le.c **** 	u32 state = crc;
 342              		.loc 1 105 50 is_stmt 0 view .LVU102
 343 0002 0346     		mov	r3, r0
 344              	.LVL26:
 107:bluetooth_le.c **** 	u32 lfsr_mask = 0xb4c000; // 101101001100000000000000
 345              		.loc 1 107 2 is_stmt 1 view .LVU103
 108:bluetooth_le.c **** 	u32 ret;
 346              		.loc 1 108 2 view .LVU104
 109:bluetooth_le.c **** 	int i, j;
 347              		.loc 1 109 2 view .LVU105
 110:bluetooth_le.c **** 
 111:bluetooth_le.c **** 	for (i = len - 1; i >= 0; --i) {
 348              		.loc 1 111 2 view .LVU106
 349              	.LBB11:
 350              	.LBB12:
 112:bluetooth_le.c **** 		u8 cur = data[i];
 113:bluetooth_le.c **** 		for (j = 0; j < 8; ++j) {
 114:bluetooth_le.c **** 			int top_bit = state >> 23;
 115:bluetooth_le.c **** 			state = (state << 1) & 0xffffff;
 116:bluetooth_le.c **** 			state |= top_bit ^ ((cur >> (7 - j)) & 1);
 117:bluetooth_le.c **** 			if (top_bit)
 118:bluetooth_le.c **** 				state ^= lfsr_mask;
ARM GAS  /tmp/cc22nK0G.s 			page 10


 351              		.loc 1 118 11 is_stmt 0 view .LVU107
 352 0004 144E     		ldr	r6, .L38
 353              	.LBE12:
 354              	.LBE11:
 111:bluetooth_le.c **** 		u8 cur = data[i];
 355              		.loc 1 111 9 view .LVU108
 356 0006 013A     		subs	r2, r2, #1
 357              	.LVL27:
 358              	.L28:
 111:bluetooth_le.c **** 		u8 cur = data[i];
 359              		.loc 1 111 20 is_stmt 1 discriminator 1 view .LVU109
 111:bluetooth_le.c **** 		u8 cur = data[i];
 360              		.loc 1 111 2 is_stmt 0 discriminator 1 view .LVU110
 361 0008 002A     		cmp	r2, #0
 362 000a 0EDA     		bge	.L31
 119:bluetooth_le.c **** 		}
 120:bluetooth_le.c **** 	}
 121:bluetooth_le.c **** 
 122:bluetooth_le.c **** 	ret = 0;
 123:bluetooth_le.c **** 	for (i = 0; i < 24; ++i)
 363              		.loc 1 123 9 view .LVU111
 364 000c 0022     		movs	r2, #0
 365              	.LVL28:
 122:bluetooth_le.c **** 	for (i = 0; i < 24; ++i)
 366              		.loc 1 122 6 view .LVU112
 367 000e 1046     		mov	r0, r2
 368              	.LVL29:
 369              	.L32:
 124:bluetooth_le.c **** 		ret |= ((state >> i) & 1) << (23 - i);
 370              		.loc 1 124 3 is_stmt 1 discriminator 3 view .LVU113
 371              		.loc 1 124 18 is_stmt 0 discriminator 3 view .LVU114
 372 0010 23FA02F1 		lsr	r1, r3, r2
 373              		.loc 1 124 29 discriminator 3 view .LVU115
 374 0014 C2F11704 		rsb	r4, r2, #23
 375              		.loc 1 124 24 discriminator 3 view .LVU116
 376 0018 01F00101 		and	r1, r1, #1
 123:bluetooth_le.c **** 		ret |= ((state >> i) & 1) << (23 - i);
 377              		.loc 1 123 22 discriminator 3 view .LVU117
 378 001c 0132     		adds	r2, r2, #1
 379              	.LVL30:
 380              		.loc 1 124 29 discriminator 3 view .LVU118
 381 001e A140     		lsls	r1, r1, r4
 123:bluetooth_le.c **** 		ret |= ((state >> i) & 1) << (23 - i);
 382              		.loc 1 123 2 discriminator 3 view .LVU119
 383 0020 182A     		cmp	r2, #24
 384              		.loc 1 124 7 discriminator 3 view .LVU120
 385 0022 40EA0100 		orr	r0, r0, r1
 386              	.LVL31:
 123:bluetooth_le.c **** 		ret |= ((state >> i) & 1) << (23 - i);
 387              		.loc 1 123 22 is_stmt 1 discriminator 3 view .LVU121
 123:bluetooth_le.c **** 		ret |= ((state >> i) & 1) << (23 - i);
 388              		.loc 1 123 14 discriminator 3 view .LVU122
 123:bluetooth_le.c **** 		ret |= ((state >> i) & 1) << (23 - i);
 389              		.loc 1 123 2 is_stmt 0 discriminator 3 view .LVU123
 390 0026 F3D1     		bne	.L32
 125:bluetooth_le.c **** 
 126:bluetooth_le.c **** 	return ret;
ARM GAS  /tmp/cc22nK0G.s 			page 11


 127:bluetooth_le.c **** }
 391              		.loc 1 127 1 view .LVU124
 392 0028 F0BD     		pop	{r4, r5, r6, r7, pc}
 393              	.LVL32:
 394              	.L31:
 395              	.LBB14:
 112:bluetooth_le.c **** 		for (j = 0; j < 8; ++j) {
 396              		.loc 1 112 3 is_stmt 1 view .LVU125
 112:bluetooth_le.c **** 		for (j = 0; j < 8; ++j) {
 397              		.loc 1 112 6 is_stmt 0 view .LVU126
 398 002a 0724     		movs	r4, #7
 399 002c 8F5C     		ldrb	r7, [r1, r2]	@ zero_extendqisi2
 400              	.LVL33:
 113:bluetooth_le.c **** 			int top_bit = state >> 23;
 401              		.loc 1 113 3 is_stmt 1 view .LVU127
 113:bluetooth_le.c **** 			int top_bit = state >> 23;
 402              		.loc 1 113 15 view .LVU128
 403              	.L30:
 404              	.LBB13:
 114:bluetooth_le.c **** 			state = (state << 1) & 0xffffff;
 405              		.loc 1 114 4 view .LVU129
 116:bluetooth_le.c **** 			if (top_bit)
 406              		.loc 1 116 29 is_stmt 0 view .LVU130
 407 002e 47FA04F0 		asr	r0, r7, r4
 115:bluetooth_le.c **** 			state |= top_bit ^ ((cur >> (7 - j)) & 1);
 408              		.loc 1 115 19 view .LVU131
 409 0032 5D00     		lsls	r5, r3, #1
 116:bluetooth_le.c **** 			if (top_bit)
 410              		.loc 1 116 41 view .LVU132
 411 0034 00F00100 		and	r0, r0, #1
 114:bluetooth_le.c **** 			state = (state << 1) & 0xffffff;
 412              		.loc 1 114 24 view .LVU133
 413 0038 4FEAD35C 		lsr	ip, r3, #23
 414              	.LVL34:
 115:bluetooth_le.c **** 			state |= top_bit ^ ((cur >> (7 - j)) & 1);
 415              		.loc 1 115 4 is_stmt 1 view .LVU134
 115:bluetooth_le.c **** 			state |= top_bit ^ ((cur >> (7 - j)) & 1);
 416              		.loc 1 115 10 is_stmt 0 view .LVU135
 417 003c 25F07F45 		bic	r5, r5, #-16777216
 418              	.LVL35:
 116:bluetooth_le.c **** 			if (top_bit)
 419              		.loc 1 116 4 is_stmt 1 view .LVU136
 116:bluetooth_le.c **** 			if (top_bit)
 420              		.loc 1 116 21 is_stmt 0 view .LVU137
 421 0040 80EAD353 		eor	r3, r0, r3, lsr #23
 116:bluetooth_le.c **** 			if (top_bit)
 422              		.loc 1 116 10 view .LVU138
 423 0044 2B43     		orrs	r3, r3, r5
 424              	.LVL36:
 117:bluetooth_le.c **** 				state ^= lfsr_mask;
 425              		.loc 1 117 4 is_stmt 1 view .LVU139
 117:bluetooth_le.c **** 				state ^= lfsr_mask;
 426              		.loc 1 117 7 is_stmt 0 view .LVU140
 427 0046 BCF1000F 		cmp	ip, #0
 428 004a 00D0     		beq	.L29
 118:bluetooth_le.c **** 		}
 429              		.loc 1 118 5 is_stmt 1 view .LVU141
ARM GAS  /tmp/cc22nK0G.s 			page 12


 118:bluetooth_le.c **** 		}
 430              		.loc 1 118 11 is_stmt 0 view .LVU142
 431 004c 7340     		eors	r3, r3, r6
 432              	.LVL37:
 433              	.L29:
 118:bluetooth_le.c **** 		}
 434              		.loc 1 118 11 view .LVU143
 435              	.LBE13:
 113:bluetooth_le.c **** 			int top_bit = state >> 23;
 436              		.loc 1 113 22 is_stmt 1 discriminator 2 view .LVU144
 113:bluetooth_le.c **** 			int top_bit = state >> 23;
 437              		.loc 1 113 15 discriminator 2 view .LVU145
 113:bluetooth_le.c **** 			int top_bit = state >> 23;
 438              		.loc 1 113 3 is_stmt 0 discriminator 2 view .LVU146
 439 004e 013C     		subs	r4, r4, #1
 440              	.LVL38:
 113:bluetooth_le.c **** 			int top_bit = state >> 23;
 441              		.loc 1 113 3 discriminator 2 view .LVU147
 442 0050 EDD2     		bcs	.L30
 113:bluetooth_le.c **** 			int top_bit = state >> 23;
 443              		.loc 1 113 3 discriminator 2 view .LVU148
 444              	.LBE14:
 111:bluetooth_le.c **** 		u8 cur = data[i];
 445              		.loc 1 111 28 is_stmt 1 discriminator 2 view .LVU149
 446 0052 013A     		subs	r2, r2, #1
 447              	.LVL39:
 111:bluetooth_le.c **** 		u8 cur = data[i];
 448              		.loc 1 111 28 is_stmt 0 discriminator 2 view .LVU150
 449 0054 D8E7     		b	.L28
 450              	.L39:
 451 0056 00BF     		.align	2
 452              	.L38:
 453 0058 00C0B400 		.word	11845632
 454              		.cfi_endproc
 455              	.LFE4:
 457              		.section	.text.btle_crcgen_lut,"ax",%progbits
 458              		.align	1
 459              		.global	btle_crcgen_lut
 460              		.syntax unified
 461              		.thumb
 462              		.thumb_func
 463              		.fpu softvfp
 465              	btle_crcgen_lut:
 466              	.LVL40:
 467              	.LFB5:
 128:bluetooth_le.c **** 
 129:bluetooth_le.c **** u32 btle_crc_lut[256] = {
 130:bluetooth_le.c **** 	0x000000, 0x01b4c0, 0x036980, 0x02dd40, 0x06d300, 0x0767c0, 0x05ba80, 0x040e40,
 131:bluetooth_le.c **** 	0x0da600, 0x0c12c0, 0x0ecf80, 0x0f7b40, 0x0b7500, 0x0ac1c0, 0x081c80, 0x09a840,
 132:bluetooth_le.c **** 	0x1b4c00, 0x1af8c0, 0x182580, 0x199140, 0x1d9f00, 0x1c2bc0, 0x1ef680, 0x1f4240,
 133:bluetooth_le.c **** 	0x16ea00, 0x175ec0, 0x158380, 0x143740, 0x103900, 0x118dc0, 0x135080, 0x12e440,
 134:bluetooth_le.c **** 	0x369800, 0x372cc0, 0x35f180, 0x344540, 0x304b00, 0x31ffc0, 0x332280, 0x329640,
 135:bluetooth_le.c **** 	0x3b3e00, 0x3a8ac0, 0x385780, 0x39e340, 0x3ded00, 0x3c59c0, 0x3e8480, 0x3f3040,
 136:bluetooth_le.c **** 	0x2dd400, 0x2c60c0, 0x2ebd80, 0x2f0940, 0x2b0700, 0x2ab3c0, 0x286e80, 0x29da40,
 137:bluetooth_le.c **** 	0x207200, 0x21c6c0, 0x231b80, 0x22af40, 0x26a100, 0x2715c0, 0x25c880, 0x247c40,
 138:bluetooth_le.c **** 	0x6d3000, 0x6c84c0, 0x6e5980, 0x6fed40, 0x6be300, 0x6a57c0, 0x688a80, 0x693e40,
 139:bluetooth_le.c **** 	0x609600, 0x6122c0, 0x63ff80, 0x624b40, 0x664500, 0x67f1c0, 0x652c80, 0x649840,
ARM GAS  /tmp/cc22nK0G.s 			page 13


 140:bluetooth_le.c **** 	0x767c00, 0x77c8c0, 0x751580, 0x74a140, 0x70af00, 0x711bc0, 0x73c680, 0x727240,
 141:bluetooth_le.c **** 	0x7bda00, 0x7a6ec0, 0x78b380, 0x790740, 0x7d0900, 0x7cbdc0, 0x7e6080, 0x7fd440,
 142:bluetooth_le.c **** 	0x5ba800, 0x5a1cc0, 0x58c180, 0x597540, 0x5d7b00, 0x5ccfc0, 0x5e1280, 0x5fa640,
 143:bluetooth_le.c **** 	0x560e00, 0x57bac0, 0x556780, 0x54d340, 0x50dd00, 0x5169c0, 0x53b480, 0x520040,
 144:bluetooth_le.c **** 	0x40e400, 0x4150c0, 0x438d80, 0x423940, 0x463700, 0x4783c0, 0x455e80, 0x44ea40,
 145:bluetooth_le.c **** 	0x4d4200, 0x4cf6c0, 0x4e2b80, 0x4f9f40, 0x4b9100, 0x4a25c0, 0x48f880, 0x494c40,
 146:bluetooth_le.c **** 	0xda6000, 0xdbd4c0, 0xd90980, 0xd8bd40, 0xdcb300, 0xdd07c0, 0xdfda80, 0xde6e40,
 147:bluetooth_le.c **** 	0xd7c600, 0xd672c0, 0xd4af80, 0xd51b40, 0xd11500, 0xd0a1c0, 0xd27c80, 0xd3c840,
 148:bluetooth_le.c **** 	0xc12c00, 0xc098c0, 0xc24580, 0xc3f140, 0xc7ff00, 0xc64bc0, 0xc49680, 0xc52240,
 149:bluetooth_le.c **** 	0xcc8a00, 0xcd3ec0, 0xcfe380, 0xce5740, 0xca5900, 0xcbedc0, 0xc93080, 0xc88440,
 150:bluetooth_le.c **** 	0xecf800, 0xed4cc0, 0xef9180, 0xee2540, 0xea2b00, 0xeb9fc0, 0xe94280, 0xe8f640,
 151:bluetooth_le.c **** 	0xe15e00, 0xe0eac0, 0xe23780, 0xe38340, 0xe78d00, 0xe639c0, 0xe4e480, 0xe55040,
 152:bluetooth_le.c **** 	0xf7b400, 0xf600c0, 0xf4dd80, 0xf56940, 0xf16700, 0xf0d3c0, 0xf20e80, 0xf3ba40,
 153:bluetooth_le.c **** 	0xfa1200, 0xfba6c0, 0xf97b80, 0xf8cf40, 0xfcc100, 0xfd75c0, 0xffa880, 0xfe1c40,
 154:bluetooth_le.c **** 	0xb75000, 0xb6e4c0, 0xb43980, 0xb58d40, 0xb18300, 0xb037c0, 0xb2ea80, 0xb35e40,
 155:bluetooth_le.c **** 	0xbaf600, 0xbb42c0, 0xb99f80, 0xb82b40, 0xbc2500, 0xbd91c0, 0xbf4c80, 0xbef840,
 156:bluetooth_le.c **** 	0xac1c00, 0xada8c0, 0xaf7580, 0xaec140, 0xaacf00, 0xab7bc0, 0xa9a680, 0xa81240,
 157:bluetooth_le.c **** 	0xa1ba00, 0xa00ec0, 0xa2d380, 0xa36740, 0xa76900, 0xa6ddc0, 0xa40080, 0xa5b440,
 158:bluetooth_le.c **** 	0x81c800, 0x807cc0, 0x82a180, 0x831540, 0x871b00, 0x86afc0, 0x847280, 0x85c640,
 159:bluetooth_le.c **** 	0x8c6e00, 0x8ddac0, 0x8f0780, 0x8eb340, 0x8abd00, 0x8b09c0, 0x89d480, 0x886040,
 160:bluetooth_le.c **** 	0x9a8400, 0x9b30c0, 0x99ed80, 0x985940, 0x9c5700, 0x9de3c0, 0x9f3e80, 0x9e8a40,
 161:bluetooth_le.c **** 	0x972200, 0x9696c0, 0x944b80, 0x95ff40, 0x91f100, 0x9045c0, 0x929880, 0x932c40
 162:bluetooth_le.c **** };
 163:bluetooth_le.c **** 
 164:bluetooth_le.c **** /*
 165:bluetooth_le.c ****  * Calculate a BTLE CRC one byte at a time. Thanks to Dominic Spill and
 166:bluetooth_le.c ****  * Michael Ossmann for writing and optimizing this.
 167:bluetooth_le.c ****  *
 168:bluetooth_le.c ****  * Arguments: CRCInit, pointer to start of packet, length of packet in
 169:bluetooth_le.c ****  * bytes
 170:bluetooth_le.c ****  * */
 171:bluetooth_le.c **** u32 btle_crcgen_lut(u32 crc_init, u8 *data, int len) {
 468              		.loc 1 171 54 is_stmt 1 view -0
 469              		.cfi_startproc
 470              		@ args = 0, pretend = 0, frame = 0
 471              		@ frame_needed = 0, uses_anonymous_args = 0
 472              		.loc 1 171 54 is_stmt 0 view .LVU152
 473 0000 30B5     		push	{r4, r5, lr}
 474              		.cfi_def_cfa_offset 12
 475              		.cfi_offset 4, -12
 476              		.cfi_offset 5, -8
 477              		.cfi_offset 14, -4
 172:bluetooth_le.c **** 	u32 state;
 478              		.loc 1 172 2 is_stmt 1 view .LVU153
 173:bluetooth_le.c **** 	int i;
 479              		.loc 1 173 2 view .LVU154
 174:bluetooth_le.c **** 	u8 key;
 480              		.loc 1 174 2 view .LVU155
 175:bluetooth_le.c **** 
 176:bluetooth_le.c **** 	state = crc_init & 0xffffff;
 481              		.loc 1 176 2 view .LVU156
 177:bluetooth_le.c **** 	for (i = 0; i < len; ++i) {
 482              		.loc 1 177 9 is_stmt 0 view .LVU157
 483 0002 0024     		movs	r4, #0
 178:bluetooth_le.c **** 		key = data[i] ^ (state & 0xff);
 179:bluetooth_le.c **** 		state = (state >> 8) ^ btle_crc_lut[key];
 484              		.loc 1 179 38 view .LVU158
ARM GAS  /tmp/cc22nK0G.s 			page 14


 485 0004 074D     		ldr	r5, .L43
 176:bluetooth_le.c **** 	for (i = 0; i < len; ++i) {
 486              		.loc 1 176 8 view .LVU159
 487 0006 20F07F40 		bic	r0, r0, #-16777216
 488              	.LVL41:
 177:bluetooth_le.c **** 	for (i = 0; i < len; ++i) {
 489              		.loc 1 177 2 is_stmt 1 view .LVU160
 490              	.L41:
 177:bluetooth_le.c **** 	for (i = 0; i < len; ++i) {
 491              		.loc 1 177 14 discriminator 1 view .LVU161
 177:bluetooth_le.c **** 	for (i = 0; i < len; ++i) {
 492              		.loc 1 177 2 is_stmt 0 discriminator 1 view .LVU162
 493 000a 9442     		cmp	r4, r2
 494 000c 00DB     		blt	.L42
 180:bluetooth_le.c **** 	}
 181:bluetooth_le.c **** 	return state;
 182:bluetooth_le.c **** }
 495              		.loc 1 182 1 view .LVU163
 496 000e 30BD     		pop	{r4, r5, pc}
 497              	.LVL42:
 498              	.L42:
 178:bluetooth_le.c **** 		state = (state >> 8) ^ btle_crc_lut[key];
 499              		.loc 1 178 3 is_stmt 1 discriminator 3 view .LVU164
 179:bluetooth_le.c **** 	}
 500              		.loc 1 179 3 discriminator 3 view .LVU165
 178:bluetooth_le.c **** 		state = (state >> 8) ^ btle_crc_lut[key];
 501              		.loc 1 178 7 is_stmt 0 discriminator 3 view .LVU166
 502 0010 0B5D     		ldrb	r3, [r1, r4]	@ zero_extendqisi2
 177:bluetooth_le.c **** 		key = data[i] ^ (state & 0xff);
 503              		.loc 1 177 23 discriminator 3 view .LVU167
 504 0012 0134     		adds	r4, r4, #1
 505              	.LVL43:
 178:bluetooth_le.c **** 		state = (state >> 8) ^ btle_crc_lut[key];
 506              		.loc 1 178 7 discriminator 3 view .LVU168
 507 0014 4340     		eors	r3, r3, r0
 179:bluetooth_le.c **** 	}
 508              		.loc 1 179 38 discriminator 3 view .LVU169
 509 0016 DBB2     		uxtb	r3, r3
 510 0018 55F82330 		ldr	r3, [r5, r3, lsl #2]
 179:bluetooth_le.c **** 	}
 511              		.loc 1 179 9 discriminator 3 view .LVU170
 512 001c 83EA1020 		eor	r0, r3, r0, lsr #8
 513              	.LVL44:
 177:bluetooth_le.c **** 		key = data[i] ^ (state & 0xff);
 514              		.loc 1 177 23 is_stmt 1 discriminator 3 view .LVU171
 177:bluetooth_le.c **** 		key = data[i] ^ (state & 0xff);
 515              		.loc 1 177 23 is_stmt 0 discriminator 3 view .LVU172
 516 0020 F3E7     		b	.L41
 517              	.L44:
 518 0022 00BF     		.align	2
 519              	.L43:
 520 0024 00000000 		.word	.LANCHOR0
 521              		.cfi_endproc
 522              	.LFE5:
 524              		.section	.text.le_dewhiten,"ax",%progbits
 525              		.align	1
 526              		.global	le_dewhiten
ARM GAS  /tmp/cc22nK0G.s 			page 15


 527              		.syntax unified
 528              		.thumb
 529              		.thumb_func
 530              		.fpu softvfp
 532              	le_dewhiten:
 533              	.LVL45:
 534              	.LFB6:
 183:bluetooth_le.c **** 
 184:bluetooth_le.c **** /*
 185:bluetooth_le.c ****  * Dewhiten and reverse the bit order of a buffer in place.
 186:bluetooth_le.c ****  * Channel is a physical channel in the range [2402, 2480]
 187:bluetooth_le.c ****  * TODO convert this to use whitening word
 188:bluetooth_le.c ****  */
 189:bluetooth_le.c **** void le_dewhiten(uint8_t *data, unsigned size, unsigned channel) {
 535              		.loc 1 189 66 is_stmt 1 view -0
 536              		.cfi_startproc
 537              		@ args = 0, pretend = 0, frame = 0
 538              		@ frame_needed = 0, uses_anonymous_args = 0
 539              		.loc 1 189 66 is_stmt 0 view .LVU174
 540 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 541              		.cfi_def_cfa_offset 24
 542              		.cfi_offset 3, -24
 543              		.cfi_offset 4, -20
 544              		.cfi_offset 5, -16
 545              		.cfi_offset 6, -12
 546              		.cfi_offset 7, -8
 547              		.cfi_offset 14, -4
 190:bluetooth_le.c **** 	unsigned i, j, bit;
 548              		.loc 1 190 2 is_stmt 1 view .LVU175
 191:bluetooth_le.c **** 	unsigned idx = whitening_index[btle_channel_index(channel)];
 549              		.loc 1 191 2 view .LVU176
 189:bluetooth_le.c **** 	unsigned i, j, bit;
 550              		.loc 1 189 66 is_stmt 0 view .LVU177
 551 0002 0446     		mov	r4, r0
 552              		.loc 1 191 33 view .LVU178
 553 0004 90B2     		uxth	r0, r2
 554              	.LVL46:
 555              		.loc 1 191 33 view .LVU179
 556 0006 FFF7FEFF 		bl	btle_channel_index
 557              	.LVL47:
 558              		.loc 1 191 32 view .LVU180
 559 000a 144E     		ldr	r6, .L50
 560              	.LBB15:
 192:bluetooth_le.c **** 
 193:bluetooth_le.c **** 	for (i = 0; i < size; ++i) {
 194:bluetooth_le.c **** 		uint8_t out = 0;
 195:bluetooth_le.c **** 		for (j = 0; j < 8; ++j) {
 196:bluetooth_le.c **** 			bit = (data[i] >> (7-j)) & 1;
 197:bluetooth_le.c **** 			bit ^= whitening[idx];
 198:bluetooth_le.c **** 			idx = (idx + 1) % sizeof(whitening);
 561              		.loc 1 198 8 view .LVU181
 562 000c 7F27     		movs	r7, #127
 563              	.LBE15:
 191:bluetooth_le.c **** 
 564              		.loc 1 191 11 view .LVU182
 565 000e 325C     		ldrb	r2, [r6, r0]	@ zero_extendqisi2
 566              	.LVL48:
ARM GAS  /tmp/cc22nK0G.s 			page 16


 193:bluetooth_le.c **** 		uint8_t out = 0;
 567              		.loc 1 193 2 is_stmt 1 view .LVU183
 193:bluetooth_le.c **** 		uint8_t out = 0;
 568              		.loc 1 193 2 is_stmt 0 view .LVU184
 569 0010 2046     		mov	r0, r4
 570 0012 2144     		add	r1, r1, r4
 571              	.LVL49:
 572              	.L46:
 193:bluetooth_le.c **** 		uint8_t out = 0;
 573              		.loc 1 193 14 is_stmt 1 discriminator 1 view .LVU185
 193:bluetooth_le.c **** 		uint8_t out = 0;
 574              		.loc 1 193 2 is_stmt 0 discriminator 1 view .LVU186
 575 0014 8142     		cmp	r1, r0
 576 0016 00D1     		bne	.L48
 199:bluetooth_le.c **** 			out |= bit << j;
 200:bluetooth_le.c **** 		}
 201:bluetooth_le.c **** 		data[i] = out;
 202:bluetooth_le.c **** 	}
 203:bluetooth_le.c **** }
 577              		.loc 1 203 1 view .LVU187
 578 0018 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 579              	.L48:
 580              	.LBB16:
 194:bluetooth_le.c **** 		for (j = 0; j < 8; ++j) {
 581              		.loc 1 194 11 view .LVU188
 582 001a 4FF0000E 		mov	lr, #0
 195:bluetooth_le.c **** 			bit = (data[i] >> (7-j)) & 1;
 583              		.loc 1 195 10 view .LVU189
 584 001e 7446     		mov	r4, lr
 196:bluetooth_le.c **** 			bit ^= whitening[idx];
 585              		.loc 1 196 15 view .LVU190
 586 0020 90F800C0 		ldrb	ip, [r0]	@ zero_extendqisi2
 587              	.L47:
 588              	.LVL50:
 196:bluetooth_le.c **** 			bit ^= whitening[idx];
 589              		.loc 1 196 4 is_stmt 1 discriminator 3 view .LVU191
 196:bluetooth_le.c **** 			bit ^= whitening[idx];
 590              		.loc 1 196 24 is_stmt 0 discriminator 3 view .LVU192
 591 0024 C4F10705 		rsb	r5, r4, #7
 196:bluetooth_le.c **** 			bit ^= whitening[idx];
 592              		.loc 1 196 19 discriminator 3 view .LVU193
 593 0028 4CFA05F3 		asr	r3, ip, r5
 196:bluetooth_le.c **** 			bit ^= whitening[idx];
 594              		.loc 1 196 8 discriminator 3 view .LVU194
 595 002c 03F00105 		and	r5, r3, #1
 596              	.LVL51:
 197:bluetooth_le.c **** 			idx = (idx + 1) % sizeof(whitening);
 597              		.loc 1 197 4 is_stmt 1 discriminator 3 view .LVU195
 197:bluetooth_le.c **** 			idx = (idx + 1) % sizeof(whitening);
 598              		.loc 1 197 20 is_stmt 0 discriminator 3 view .LVU196
 599 0030 B318     		adds	r3, r6, r2
 600 0032 93F82830 		ldrb	r3, [r3, #40]	@ zero_extendqisi2
 198:bluetooth_le.c **** 			out |= bit << j;
 601              		.loc 1 198 15 discriminator 3 view .LVU197
 602 0036 0132     		adds	r2, r2, #1
 603              	.LVL52:
 197:bluetooth_le.c **** 			idx = (idx + 1) % sizeof(whitening);
ARM GAS  /tmp/cc22nK0G.s 			page 17


 604              		.loc 1 197 8 discriminator 3 view .LVU198
 605 0038 6B40     		eors	r3, r3, r5
 606              	.LVL53:
 198:bluetooth_le.c **** 			out |= bit << j;
 607              		.loc 1 198 4 is_stmt 1 discriminator 3 view .LVU199
 198:bluetooth_le.c **** 			out |= bit << j;
 608              		.loc 1 198 8 is_stmt 0 discriminator 3 view .LVU200
 609 003a B2FBF7F5 		udiv	r5, r2, r7
 199:bluetooth_le.c **** 		}
 610              		.loc 1 199 15 discriminator 3 view .LVU201
 611 003e A340     		lsls	r3, r3, r4
 612              	.LVL54:
 195:bluetooth_le.c **** 			bit = (data[i] >> (7-j)) & 1;
 613              		.loc 1 195 22 discriminator 3 view .LVU202
 614 0040 0134     		adds	r4, r4, #1
 615              	.LVL55:
 198:bluetooth_le.c **** 			out |= bit << j;
 616              		.loc 1 198 8 discriminator 3 view .LVU203
 617 0042 C5EBC515 		rsb	r5, r5, r5, lsl #7
 199:bluetooth_le.c **** 		}
 618              		.loc 1 199 8 discriminator 3 view .LVU204
 619 0046 4EEA0303 		orr	r3, lr, r3
 195:bluetooth_le.c **** 			bit = (data[i] >> (7-j)) & 1;
 620              		.loc 1 195 3 discriminator 3 view .LVU205
 621 004a 082C     		cmp	r4, #8
 198:bluetooth_le.c **** 			out |= bit << j;
 622              		.loc 1 198 8 discriminator 3 view .LVU206
 623 004c A2EB0502 		sub	r2, r2, r5
 624              	.LVL56:
 199:bluetooth_le.c **** 		}
 625              		.loc 1 199 4 is_stmt 1 discriminator 3 view .LVU207
 199:bluetooth_le.c **** 		}
 626              		.loc 1 199 8 is_stmt 0 discriminator 3 view .LVU208
 627 0050 5FFA83FE 		uxtb	lr, r3
 628              	.LVL57:
 195:bluetooth_le.c **** 			bit = (data[i] >> (7-j)) & 1;
 629              		.loc 1 195 22 is_stmt 1 discriminator 3 view .LVU209
 195:bluetooth_le.c **** 			bit = (data[i] >> (7-j)) & 1;
 630              		.loc 1 195 15 discriminator 3 view .LVU210
 195:bluetooth_le.c **** 			bit = (data[i] >> (7-j)) & 1;
 631              		.loc 1 195 3 is_stmt 0 discriminator 3 view .LVU211
 632 0054 E6D1     		bne	.L47
 201:bluetooth_le.c **** 	}
 633              		.loc 1 201 3 is_stmt 1 discriminator 2 view .LVU212
 201:bluetooth_le.c **** 	}
 634              		.loc 1 201 11 is_stmt 0 discriminator 2 view .LVU213
 635 0056 00F801EB 		strb	lr, [r0], #1
 636              	.LVL58:
 201:bluetooth_le.c **** 	}
 637              		.loc 1 201 11 discriminator 2 view .LVU214
 638              	.LBE16:
 193:bluetooth_le.c **** 		uint8_t out = 0;
 639              		.loc 1 193 24 is_stmt 1 discriminator 2 view .LVU215
 193:bluetooth_le.c **** 		uint8_t out = 0;
 640              		.loc 1 193 24 is_stmt 0 discriminator 2 view .LVU216
 641 005a DBE7     		b	.L46
 642              	.L51:
ARM GAS  /tmp/cc22nK0G.s 			page 18


 643              		.align	2
 644              	.L50:
 645 005c 00000000 		.word	.LANCHOR1
 646              		.cfi_endproc
 647              	.LFE6:
 649              		.section	.text.le_parse_channel_map,"ax",%progbits
 650              		.align	1
 651              		.global	le_parse_channel_map
 652              		.syntax unified
 653              		.thumb
 654              		.thumb_func
 655              		.fpu softvfp
 657              	le_parse_channel_map:
 658              	.LVL59:
 659              	.LFB7:
 204:bluetooth_le.c **** 
 205:bluetooth_le.c **** /*
 206:bluetooth_le.c ****  * Parse a channel map and populate the le_channel_remapping_t struct.
 207:bluetooth_le.c ****  */
 208:bluetooth_le.c **** void le_parse_channel_map(uint8_t *channel_map, le_channel_remapping_t *remapping) {
 660              		.loc 1 208 84 is_stmt 1 view -0
 661              		.cfi_startproc
 662              		@ args = 0, pretend = 0, frame = 0
 663              		@ frame_needed = 0, uses_anonymous_args = 0
 664              		.loc 1 208 84 is_stmt 0 view .LVU218
 665 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 666              		.cfi_def_cfa_offset 24
 667              		.cfi_offset 3, -24
 668              		.cfi_offset 4, -20
 669              		.cfi_offset 5, -16
 670              		.cfi_offset 6, -12
 671              		.cfi_offset 7, -8
 672              		.cfi_offset 14, -4
 209:bluetooth_le.c **** 	unsigned i, j, byte;
 673              		.loc 1 209 2 is_stmt 1 view .LVU219
 210:bluetooth_le.c **** 	unsigned idx = 0;
 674              		.loc 1 210 2 view .LVU220
 675              	.LVL60:
 211:bluetooth_le.c **** 
 212:bluetooth_le.c **** 	memset(remapping, 0, sizeof(*remapping));
 676              		.loc 1 212 2 view .LVU221
 208:bluetooth_le.c **** 	unsigned i, j, byte;
 677              		.loc 1 208 84 is_stmt 0 view .LVU222
 678 0002 0C46     		mov	r4, r1
 679 0004 0546     		mov	r5, r0
 680              		.loc 1 212 2 view .LVU223
 681 0006 C022     		movs	r2, #192
 682 0008 0021     		movs	r1, #0
 683              	.LVL61:
 684              		.loc 1 212 2 view .LVU224
 685 000a 2046     		mov	r0, r4
 686              	.LVL62:
 687              		.loc 1 212 2 view .LVU225
 688 000c FFF7FEFF 		bl	memset
 689              	.LVL63:
 213:bluetooth_le.c **** 
 214:bluetooth_le.c **** 	for (i = 0; i < 5; ++i) {
ARM GAS  /tmp/cc22nK0G.s 			page 19


 690              		.loc 1 214 2 is_stmt 1 view .LVU226
 691              		.loc 1 214 14 view .LVU227
 215:bluetooth_le.c **** 		byte = channel_map[i];
 216:bluetooth_le.c **** 		for (j = 0; j < 8; ++j) {
 217:bluetooth_le.c **** 			if (byte & 1) {
 218:bluetooth_le.c **** 				remapping->channel_in_use[idx] = 1;
 692              		.loc 1 218 36 is_stmt 0 view .LVU228
 693 0010 0126     		movs	r6, #1
 210:bluetooth_le.c **** 
 694              		.loc 1 210 11 view .LVU229
 695 0012 0023     		movs	r3, #0
 696 0014 681E     		subs	r0, r5, #1
 697 0016 0435     		adds	r5, r5, #4
 698              	.LVL64:
 699              	.L57:
 215:bluetooth_le.c **** 		byte = channel_map[i];
 700              		.loc 1 215 3 is_stmt 1 view .LVU230
 215:bluetooth_le.c **** 		byte = channel_map[i];
 701              		.loc 1 215 8 is_stmt 0 view .LVU231
 702 0018 10F8012F 		ldrb	r2, [r0, #1]!	@ zero_extendqisi2
 703              	.LVL65:
 216:bluetooth_le.c **** 			if (byte & 1) {
 704              		.loc 1 216 3 is_stmt 1 view .LVU232
 216:bluetooth_le.c **** 			if (byte & 1) {
 705              		.loc 1 216 15 view .LVU233
 706 001c 03F10807 		add	r7, r3, #8
 707              	.L56:
 217:bluetooth_le.c **** 				remapping->channel_in_use[idx] = 1;
 708              		.loc 1 217 4 view .LVU234
 217:bluetooth_le.c **** 				remapping->channel_in_use[idx] = 1;
 709              		.loc 1 217 7 is_stmt 0 view .LVU235
 710 0020 12F00101 		ands	r1, r2, #1
 711              		.loc 1 218 5 is_stmt 1 view .LVU236
 712              		.loc 1 218 36 is_stmt 0 view .LVU237
 713 0024 1BBF     		ittet	ne
 714 0026 44F82360 		strne	r6, [r4, r3, lsl #2]
 219:bluetooth_le.c **** 				remapping->remapping_index[remapping->total_channels] = idx;
 715              		.loc 1 219 5 is_stmt 1 view .LVU238
 716              		.loc 1 219 41 is_stmt 0 view .LVU239
 717 002a D4F8BC10 		ldrne	r1, [r4, #188]
 220:bluetooth_le.c **** 				++remapping->total_channels;
 221:bluetooth_le.c **** 			} else {
 222:bluetooth_le.c **** 				remapping->channel_in_use[idx] = 0;
 718              		.loc 1 222 36 view .LVU240
 719 002e 44F82310 		streq	r1, [r4, r3, lsl #2]
 219:bluetooth_le.c **** 				remapping->remapping_index[remapping->total_channels] = idx;
 720              		.loc 1 219 59 view .LVU241
 721 0032 04EB010C 		addne	ip, r4, r1
 722 0036 1CBF     		itt	ne
 723 0038 8CF89430 		strbne	r3, [ip, #148]
 220:bluetooth_le.c **** 				++remapping->total_channels;
 724              		.loc 1 220 5 is_stmt 1 view .LVU242
 725 003c 0131     		addne	r1, r1, #1
 223:bluetooth_le.c **** 			}
 224:bluetooth_le.c **** 
 225:bluetooth_le.c **** 			byte >>= 1;
 226:bluetooth_le.c **** 
ARM GAS  /tmp/cc22nK0G.s 			page 20


 227:bluetooth_le.c **** 			++idx;
 726              		.loc 1 227 4 is_stmt 0 view .LVU243
 727 003e 03F10103 		add	r3, r3, #1
 728              	.LVL66:
 220:bluetooth_le.c **** 				++remapping->total_channels;
 729              		.loc 1 220 5 view .LVU244
 730 0042 18BF     		it	ne
 731 0044 C4F8BC10 		strne	r1, [r4, #188]
 222:bluetooth_le.c **** 			}
 732              		.loc 1 222 5 is_stmt 1 view .LVU245
 225:bluetooth_le.c **** 
 733              		.loc 1 225 4 view .LVU246
 228:bluetooth_le.c **** 			if (idx == 37)
 734              		.loc 1 228 7 is_stmt 0 view .LVU247
 735 0048 252B     		cmp	r3, #37
 225:bluetooth_le.c **** 
 736              		.loc 1 225 9 view .LVU248
 737 004a 4FEA5202 		lsr	r2, r2, #1
 738              	.LVL67:
 227:bluetooth_le.c **** 			if (idx == 37)
 739              		.loc 1 227 4 is_stmt 1 view .LVU249
 740              		.loc 1 228 4 view .LVU250
 741              		.loc 1 228 7 is_stmt 0 view .LVU251
 742 004e 01D0     		beq	.L55
 216:bluetooth_le.c **** 			if (byte & 1) {
 743              		.loc 1 216 22 is_stmt 1 discriminator 2 view .LVU252
 216:bluetooth_le.c **** 			if (byte & 1) {
 744              		.loc 1 216 15 discriminator 2 view .LVU253
 216:bluetooth_le.c **** 			if (byte & 1) {
 745              		.loc 1 216 3 is_stmt 0 discriminator 2 view .LVU254
 746 0050 9F42     		cmp	r7, r3
 747 0052 E5D1     		bne	.L56
 748              	.L55:
 214:bluetooth_le.c **** 		byte = channel_map[i];
 749              		.loc 1 214 21 is_stmt 1 discriminator 2 view .LVU255
 750              	.LVL68:
 214:bluetooth_le.c **** 		byte = channel_map[i];
 751              		.loc 1 214 14 discriminator 2 view .LVU256
 214:bluetooth_le.c **** 		byte = channel_map[i];
 752              		.loc 1 214 2 is_stmt 0 discriminator 2 view .LVU257
 753 0054 A842     		cmp	r0, r5
 754 0056 DFD1     		bne	.L57
 229:bluetooth_le.c **** 				break;
 230:bluetooth_le.c **** 		}
 231:bluetooth_le.c **** 	}
 232:bluetooth_le.c **** }
 755              		.loc 1 232 1 view .LVU258
 756 0058 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 757              		.loc 1 232 1 view .LVU259
 758              		.cfi_endproc
 759              	.LFE7:
 761              		.section	.text.le_map_channel,"ax",%progbits
 762              		.align	1
 763              		.global	le_map_channel
 764              		.syntax unified
 765              		.thumb
 766              		.thumb_func
ARM GAS  /tmp/cc22nK0G.s 			page 21


 767              		.fpu softvfp
 769              	le_map_channel:
 770              	.LVL69:
 771              	.LFB8:
 233:bluetooth_le.c **** 
 234:bluetooth_le.c **** /*
 235:bluetooth_le.c ****  * Map a channel index to a used index given a remapping struct.
 236:bluetooth_le.c ****  */
 237:bluetooth_le.c **** uint8_t le_map_channel(uint8_t channel_idx, le_channel_remapping_t *remapping) {
 772              		.loc 1 237 80 is_stmt 1 view -0
 773              		.cfi_startproc
 774              		@ args = 0, pretend = 0, frame = 0
 775              		@ frame_needed = 0, uses_anonymous_args = 0
 776              		@ link register save eliminated.
 777              		.loc 1 237 80 is_stmt 0 view .LVU261
 238:bluetooth_le.c **** 	if (remapping->channel_in_use[channel_idx])
 778              		.loc 1 238 2 is_stmt 1 view .LVU262
 779              		.loc 1 238 5 is_stmt 0 view .LVU263
 780 0000 51F82030 		ldr	r3, [r1, r0, lsl #2]
 781 0004 43B9     		cbnz	r3, .L64
 239:bluetooth_le.c **** 		return channel_idx;
 240:bluetooth_le.c **** 	else
 241:bluetooth_le.c **** 		return remapping->remapping_index[channel_idx % remapping->total_channels];
 782              		.loc 1 241 3 is_stmt 1 view .LVU264
 783              		.loc 1 241 49 is_stmt 0 view .LVU265
 784 0006 D1F8BC20 		ldr	r2, [r1, #188]
 785 000a B0FBF2F3 		udiv	r3, r0, r2
 786 000e 02FB1300 		mls	r0, r2, r3, r0
 787              	.LVL70:
 788              		.loc 1 241 36 view .LVU266
 789 0012 0144     		add	r1, r1, r0
 790              	.LVL71:
 791              		.loc 1 241 36 view .LVU267
 792 0014 91F89400 		ldrb	r0, [r1, #148]	@ zero_extendqisi2
 793              	.L64:
 242:bluetooth_le.c **** }
 794              		.loc 1 242 1 view .LVU268
 795 0018 7047     		bx	lr
 796              		.cfi_endproc
 797              	.LFE8:
 799              		.global	btle_crc_lut
 800              		.section	.rodata
 801              		.set	.LANCHOR1,. + 0
 804              	whitening_index:
 805 0000 463E786F 		.ascii	"F>xoM.\017eB'\037\032PS}Y\012#\0106z\021!\000:s\006"
 805      4D2E0F65 
 805      42271F1A 
 805      50537D59 
 805      0A230836 
 806 001b 5E563134 		.ascii	"^V14\024(\033TZ?p/f"
 806      14281B54 
 806      5A3F702F 
 806      66
 809              	whitening:
 810 0028 01010101 		.ascii	"\001\001\001\001\000\001\000\001\000\001\000\000\000"
 810      00010001 
 810      00010000 
ARM GAS  /tmp/cc22nK0G.s 			page 22


 810      00
 811 0035 00010001 		.ascii	"\000\001\000\001\001\000\001\001\001\001\000\000\001"
 811      01000101 
 811      01010000 
 811      01
 812 0042 01010000 		.ascii	"\001\001\000\000\001\000\001\000\001\001\000\000\001"
 812      01000100 
 812      01010000 
 812      01
 813 004f 01000000 		.ascii	"\001\000\000\000\000\000\001\001\000\001\001\000\001"
 813      00000101 
 813      00010100 
 813      01
 814 005c 00010101 		.ascii	"\000\001\001\001\000\001\000\000\000\001\001\000\000"
 814      00010000 
 814      00010100 
 814      00
 815 0069 01000000 		.ascii	"\001\000\000\000\001\000\000\000\000\000\000\001\000"
 815      01000000 
 815      00000001 
 815      00
 816 0076 00010000 		.ascii	"\000\001\000\000\001\001\000\001\000\000\001\001\001"
 816      01010001 
 816      00000101 
 816      01
 817 0083 01000101 		.ascii	"\001\000\001\001\001\000\000\000\000\001\001\001\001"
 817      01000000 
 817      00010101 
 817      01
 818 0090 01010100 		.ascii	"\001\001\001\000\000\000\001\001\001\000\001\001\000"
 818      00000101 
 818      01000101 
 818      00
 819 009d 00000100 		.ascii	"\000\000\001\000\001\000\000\001\000\001"
 819      01000001 
 819      0001
 820              		.data
 821              		.align	2
 822              		.set	.LANCHOR0,. + 0
 825              	btle_crc_lut:
 826 0000 00000000 		.word	0
 827 0004 C0B40100 		.word	111808
 828 0008 80690300 		.word	223616
 829 000c 40DD0200 		.word	187712
 830 0010 00D30600 		.word	447232
 831 0014 C0670700 		.word	485312
 832 0018 80BA0500 		.word	375424
 833 001c 400E0400 		.word	265792
 834 0020 00A60D00 		.word	894464
 835 0024 C0120C00 		.word	791232
 836 0028 80CF0E00 		.word	970624
 837 002c 407B0F00 		.word	1014592
 838 0030 00750B00 		.word	750848
 839 0034 C0C10A00 		.word	704960
 840 0038 801C0800 		.word	531584
 841 003c 40A80900 		.word	632896
 842 0040 004C1B00 		.word	1788928
ARM GAS  /tmp/cc22nK0G.s 			page 23


 843 0044 C0F81A00 		.word	1767616
 844 0048 80251800 		.word	1582464
 845 004c 40911900 		.word	1675584
 846 0050 009F1D00 		.word	1941248
 847 0054 C02B1C00 		.word	1846208
 848 0058 80F61E00 		.word	2029184
 849 005c 40421F00 		.word	2048576
 850 0060 00EA1600 		.word	1501696
 851 0064 C05E1700 		.word	1531584
 852 0068 80831500 		.word	1409920
 853 006c 40371400 		.word	1324864
 854 0070 00391000 		.word	1063168
 855 0074 C08D1100 		.word	1150400
 856 0078 80501300 		.word	1265792
 857 007c 40E41200 		.word	1238080
 858 0080 00983600 		.word	3577856
 859 0084 C02C3700 		.word	3615936
 860 0088 80F13500 		.word	3535232
 861 008c 40453400 		.word	3425600
 862 0090 004B3000 		.word	3164928
 863 0094 C0FF3100 		.word	3276736
 864 0098 80223300 		.word	3351168
 865 009c 40963200 		.word	3315264
 866 00a0 003E3B00 		.word	3882496
 867 00a4 C08A3A00 		.word	3836608
 868 00a8 80573800 		.word	3692416
 869 00ac 40E33900 		.word	3793728
 870 00b0 00ED3D00 		.word	4058368
 871 00b4 C0593C00 		.word	3955136
 872 00b8 80843E00 		.word	4097152
 873 00bc 40303F00 		.word	4141120
 874 00c0 00D42D00 		.word	3003392
 875 00c4 C0602C00 		.word	2908352
 876 00c8 80BD2E00 		.word	3063168
 877 00cc 40092F00 		.word	3082560
 878 00d0 00072B00 		.word	2819840
 879 00d4 C0B32A00 		.word	2798528
 880 00d8 806E2800 		.word	2649728
 881 00dc 40DA2900 		.word	2742848
 882 00e0 00722000 		.word	2126336
 883 00e4 C0C62100 		.word	2213568
 884 00e8 801B2300 		.word	2300800
 885 00ec 40AF2200 		.word	2273088
 886 00f0 00A12600 		.word	2531584
 887 00f4 C0152700 		.word	2561472
 888 00f8 80C82500 		.word	2476160
 889 00fc 407C2400 		.word	2391104
 890 0100 00306D00 		.word	7155712
 891 0104 C0846C00 		.word	7111872
 892 0108 80596E00 		.word	7231872
 893 010c 40ED6F00 		.word	7335232
 894 0110 00E36B00 		.word	7070464
 895 0114 C0576A00 		.word	6969280
 896 0118 808A6800 		.word	6851200
 897 011c 403E6900 		.word	6897216
 898 0120 00966000 		.word	6329856
 899 0124 C0226100 		.word	6365888
ARM GAS  /tmp/cc22nK0G.s 			page 24


 900 0128 80FF6300 		.word	6553472
 901 012c 404B6200 		.word	6441792
 902 0130 00456600 		.word	6702336
 903 0134 C0F16700 		.word	6812096
 904 0138 802C6500 		.word	6630528
 905 013c 40986400 		.word	6592576
 906 0140 007C7600 		.word	7764992
 907 0144 C0C87700 		.word	7850176
 908 0148 80157500 		.word	7673216
 909 014c 40A17400 		.word	7643456
 910 0150 00AF7000 		.word	7384832
 911 0154 C01B7100 		.word	7412672
 912 0158 80C67300 		.word	7587456
 913 015c 40727200 		.word	7500352
 914 0160 00DA7B00 		.word	8116736
 915 0164 C06E7A00 		.word	8023744
 916 0168 80B37800 		.word	7910272
 917 016c 40077900 		.word	7931712
 918 0170 00097D00 		.word	8194304
 919 0174 C0BD7C00 		.word	8175040
 920 0178 80607E00 		.word	8282240
 921 017c 40D47F00 		.word	8377408
 922 0180 00A85B00 		.word	6006784
 923 0184 C01C5A00 		.word	5905600
 924 0188 80C15800 		.word	5816704
 925 018c 40755900 		.word	5862720
 926 0190 007B5D00 		.word	6126336
 927 0194 C0CF5C00 		.word	6082496
 928 0198 80125E00 		.word	6165120
 929 019c 40A65F00 		.word	6268480
 930 01a0 000E5600 		.word	5639680
 931 01a4 C0BA5700 		.word	5749440
 932 01a8 80675500 		.word	5597056
 933 01ac 40D35400 		.word	5559104
 934 01b0 00DD5000 		.word	5299456
 935 01b4 C0695100 		.word	5335488
 936 01b8 80B45300 		.word	5485696
 937 01bc 40005200 		.word	5374016
 938 01c0 00E44000 		.word	4252672
 939 01c4 C0504100 		.word	4280512
 940 01c8 808D4300 		.word	4427136
 941 01cc 40394200 		.word	4340032
 942 01d0 00374600 		.word	4601600
 943 01d4 C0834700 		.word	4686784
 944 01d8 805E4500 		.word	4546176
 945 01dc 40EA4400 		.word	4516416
 946 01e0 00424D00 		.word	5063168
 947 01e4 C0F64C00 		.word	5043904
 948 01e8 802B4E00 		.word	5122944
 949 01ec 409F4F00 		.word	5218112
 950 01f0 00914B00 		.word	4952320
 951 01f4 C0254A00 		.word	4859328
 952 01f8 80F84800 		.word	4782208
 953 01fc 404C4900 		.word	4803648
 954 0200 0060DA00 		.word	14311424
 955 0204 C0D4DB00 		.word	14406848
 956 0208 8009D900 		.word	14223744
ARM GAS  /tmp/cc22nK0G.s 			page 25


 957 020c 40BDD800 		.word	14204224
 958 0210 00B3DC00 		.word	14463744
 959 0214 C007DD00 		.word	14485440
 960 0218 80DADF00 		.word	14670464
 961 021c 406EDE00 		.word	14577216
 962 0220 00C6D700 		.word	14140928
 963 0224 C072D600 		.word	14054080
 964 0228 80AFD400 		.word	13938560
 965 022c 401BD500 		.word	13966144
 966 0230 0015D100 		.word	13702400
 967 0234 C0A1D000 		.word	13672896
 968 0238 807CD200 		.word	13794432
 969 023c 40C8D300 		.word	13879360
 970 0240 002CC100 		.word	12659712
 971 0244 C098C000 		.word	12622016
 972 0248 8045C200 		.word	12731776
 973 024c 40F1C300 		.word	12841280
 974 0250 00FFC700 		.word	13106944
 975 0254 C04BC600 		.word	12995520
 976 0258 8096C400 		.word	12883584
 977 025c 4022C500 		.word	12919360
 978 0260 008ACC00 		.word	13404672
 979 0264 C03ECD00 		.word	13450944
 980 0268 80E3CF00 		.word	13624192
 981 026c 4057CE00 		.word	13522752
 982 0270 0059CA00 		.word	13261056
 983 0274 C0EDCB00 		.word	13364672
 984 0278 8030C900 		.word	13185152
 985 027c 4084C800 		.word	13141056
 986 0280 00F8EC00 		.word	15529984
 987 0284 C04CED00 		.word	15551680
 988 0288 8091EF00 		.word	15700352
 989 028c 4025EE00 		.word	15607104
 990 0290 002BEA00 		.word	15346432
 991 0294 C09FEB00 		.word	15441856
 992 0298 8042E900 		.word	15286912
 993 029c 40F6E800 		.word	15267392
 994 02a0 005EE100 		.word	14769664
 995 02a4 C0EAE000 		.word	14740160
 996 02a8 8037E200 		.word	14825344
 997 02ac 4083E300 		.word	14910272
 998 02b0 008DE700 		.word	15174912
 999 02b4 C039E600 		.word	15088064
 1000 02b8 80E4E400 		.word	15000704
 1001 02bc 4050E500 		.word	15028288
 1002 02c0 00B4F700 		.word	16233472
 1003 02c4 C000F600 		.word	16122048
 1004 02c8 80DDF400 		.word	16047488
 1005 02cc 4069F500 		.word	16083264
 1006 02d0 0067F100 		.word	15820544
 1007 02d4 C0D3F000 		.word	15782848
 1008 02d8 800EF200 		.word	15863424
 1009 02dc 40BAF300 		.word	15972928
 1010 02e0 0012FA00 		.word	16388608
 1011 02e4 C0A6FB00 		.word	16492224
 1012 02e8 807BF900 		.word	16350080
 1013 02ec 40CFF800 		.word	16305984
ARM GAS  /tmp/cc22nK0G.s 			page 26


 1014 02f0 00C1FC00 		.word	16564480
 1015 02f4 C075FD00 		.word	16610752
 1016 02f8 80A8FF00 		.word	16754816
 1017 02fc 401CFE00 		.word	16653376
 1018 0300 0050B700 		.word	12013568
 1019 0304 C0E4B600 		.word	11986112
 1020 0308 8039B400 		.word	11811200
 1021 030c 408DB500 		.word	11898176
 1022 0310 0083B100 		.word	11633408
 1023 0314 C037B000 		.word	11548608
 1024 0318 80EAB200 		.word	11725440
 1025 031c 405EB300 		.word	11755072
 1026 0320 00F6BA00 		.word	12252672
 1027 0324 C042BB00 		.word	12272320
 1028 0328 809FB900 		.word	12164992
 1029 032c 402BB800 		.word	12069696
 1030 0330 0025BC00 		.word	12330240
 1031 0334 C091BD00 		.word	12423616
 1032 0338 804CBF00 		.word	12536960
 1033 033c 40F8BE00 		.word	12515392
 1034 0340 001CAC00 		.word	11279360
 1035 0344 C0A8AD00 		.word	11380928
 1036 0348 8075AF00 		.word	11498880
 1037 034c 40C1AE00 		.word	11452736
 1038 0350 00CFAA00 		.word	11194112
 1039 0354 C07BAB00 		.word	11238336
 1040 0358 80A6A900 		.word	11118208
 1041 035c 4012A800 		.word	11014720
 1042 0360 00BAA100 		.word	10598912
 1043 0364 C00EA000 		.word	10489536
 1044 0368 80D3A200 		.word	10670976
 1045 036c 4067A300 		.word	10708800
 1046 0370 0069A700 		.word	10971392
 1047 0374 C0DDA600 		.word	10935744
 1048 0378 8000A400 		.word	10748032
 1049 037c 40B4A500 		.word	10859584
 1050 0380 00C88100 		.word	8505344
 1051 0384 C07C8000 		.word	8420544
 1052 0388 80A18200 		.word	8561024
 1053 038c 40158300 		.word	8590656
 1054 0390 001B8700 		.word	8854272
 1055 0394 C0AF8600 		.word	8826816
 1056 0398 80728400 		.word	8680064
 1057 039c 40C68500 		.word	8767040
 1058 03a0 006E8C00 		.word	9203200
 1059 03a4 C0DA8D00 		.word	9296576
 1060 03a8 80078F00 		.word	9373568
 1061 03ac 40B38E00 		.word	9352000
 1062 03b0 00BD8A00 		.word	9092352
 1063 03b4 C0098B00 		.word	9112000
 1064 03b8 80D48900 		.word	9032832
 1065 03bc 40608800 		.word	8937536
 1066 03c0 00849A00 		.word	10126336
 1067 03c4 C0309B00 		.word	10170560
 1068 03c8 80ED9900 		.word	10087808
 1069 03cc 40599800 		.word	9984320
 1070 03d0 00579C00 		.word	10245888
ARM GAS  /tmp/cc22nK0G.s 			page 27


 1071 03d4 C0E39D00 		.word	10347456
 1072 03d8 803E9F00 		.word	10436224
 1073 03dc 408A9E00 		.word	10390080
 1074 03e0 00229700 		.word	9904640
 1075 03e4 C0969600 		.word	9868992
 1076 03e8 804B9400 		.word	9718656
 1077 03ec 40FF9500 		.word	9830208
 1078 03f0 00F19100 		.word	9564416
 1079 03f4 C0459000 		.word	9455040
 1080 03f8 80989200 		.word	9607296
 1081 03fc 402C9300 		.word	9645120
 1082              		.text
 1083              	.Letext0:
 1084              		.file 2 "/usr/lib/gcc/arm-none-eabi/9.2.1/include/stdint.h"
 1085              		.file 3 "../common/ubertooth.h"
 1086              		.file 4 "bluetooth_le.h"
 1087              		.file 5 "/usr/lib/gcc/arm-none-eabi/9.2.1/include/stddef.h"
 1088              		.file 6 "/usr/include/newlib/sys/_types.h"
 1089              		.file 7 "/usr/include/newlib/sys/reent.h"
 1090              		.file 8 "/usr/include/newlib/sys/lock.h"
 1091              		.file 9 "/usr/include/newlib/string.h"
ARM GAS  /tmp/cc22nK0G.s 			page 28


DEFINED SYMBOLS
                            *ABS*:0000000000000000 bluetooth_le.c
     /tmp/cc22nK0G.s:16     .text.btle_channel_index:0000000000000000 $t
     /tmp/cc22nK0G.s:24     .text.btle_channel_index:0000000000000000 btle_channel_index
     /tmp/cc22nK0G.s:94     .text.btle_channel_index_to_phys:0000000000000000 $t
     /tmp/cc22nK0G.s:101    .text.btle_channel_index_to_phys:0000000000000000 btle_channel_index_to_phys
     /tmp/cc22nK0G.s:172    .text.btle_next_hop:0000000000000000 $t
     /tmp/cc22nK0G.s:179    .text.btle_next_hop:0000000000000000 btle_next_hop
     /tmp/cc22nK0G.s:221    .text.btle_calc_crc:0000000000000000 $t
     /tmp/cc22nK0G.s:228    .text.btle_calc_crc:0000000000000000 btle_calc_crc
     /tmp/cc22nK0G.s:314    .text.btle_calc_crc:0000000000000030 $d
     /tmp/cc22nK0G.s:319    .text.btle_reverse_crc:0000000000000000 $t
     /tmp/cc22nK0G.s:326    .text.btle_reverse_crc:0000000000000000 btle_reverse_crc
     /tmp/cc22nK0G.s:453    .text.btle_reverse_crc:0000000000000058 $d
     /tmp/cc22nK0G.s:458    .text.btle_crcgen_lut:0000000000000000 $t
     /tmp/cc22nK0G.s:465    .text.btle_crcgen_lut:0000000000000000 btle_crcgen_lut
     /tmp/cc22nK0G.s:520    .text.btle_crcgen_lut:0000000000000024 $d
     /tmp/cc22nK0G.s:525    .text.le_dewhiten:0000000000000000 $t
     /tmp/cc22nK0G.s:532    .text.le_dewhiten:0000000000000000 le_dewhiten
     /tmp/cc22nK0G.s:645    .text.le_dewhiten:000000000000005c $d
     /tmp/cc22nK0G.s:650    .text.le_parse_channel_map:0000000000000000 $t
     /tmp/cc22nK0G.s:657    .text.le_parse_channel_map:0000000000000000 le_parse_channel_map
     /tmp/cc22nK0G.s:762    .text.le_map_channel:0000000000000000 $t
     /tmp/cc22nK0G.s:769    .text.le_map_channel:0000000000000000 le_map_channel
     /tmp/cc22nK0G.s:825    .data:0000000000000000 btle_crc_lut
     /tmp/cc22nK0G.s:804    .rodata:0000000000000000 whitening_index
     /tmp/cc22nK0G.s:809    .rodata:0000000000000028 whitening
     /tmp/cc22nK0G.s:821    .data:0000000000000000 $d

UNDEFINED SYMBOLS
memset
